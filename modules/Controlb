<h2 id='controlb'>CONTROLB()</h2>
<ul>
<li>Calculates Auger and Fluorescence cascade for vacancy in <code>ICSHELL</code></li>
<li>Calculates Cascade events</li>
</ul>
<h3 id='arguments'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>IDBG</td>
<td></td>
</tr>
<tr>
<td>NVAC</td>
<td></td>
</tr>
</tbody></table>
<h3 id='pseudo-code'>Pseudo-Code</h3><pre class="highlight python tab-python"><code><span class="k">def</span> <span class="nf">CONTROLB</span><span class="p">(</span><span class="n">IDBG</span><span class="p">,</span><span class="n">NVAC</span><span class="p">):</span>
    <span class="c"># IMPLICIT #real*8(A-H,O-Z)</span>
    <span class="c"># IMPLICIT #integer*8(I-N)</span>
    <span class="c"># CHARACTER*6 SCR(17),SCR1(17)</span>
    <span class="c">#     COMMON/INPT2/KGAS,LGAS,DETEFF,EXCWGHT</span>
    <span class="c"># COMMON/COMP/LCMP,LCFLG,LRAY,LRFLG,LPAP,LPFLG,LBRM,LBFLG,LPEFLG</span>
    <span class="c"># COMMON/GENCAS/ELEV[17,79],NSDEG(17),AA[17],BB[17],SCR,SCR1</span>
    <span class="c"># COMMON/MIXC/PRSH(6,3,17,17),ESH(6,3,17),AUG(6,3,17,17,17),RAD[6,3,17,17],PRSHBT(6,3,17),IZ[6,3],INIOCC(6,3,17),ISHLMX(6,3),AMZ[6,3]</span>
    <span class="c"># COMMON/UPD/NOCC(6,3,17),AUGR(6,3,17,17,17),RADR(6,3,17,17)</span>
    <span class="c"># COMMON/CALCASB/IONSUM(10),IFLSUM(10),ESTORE(10,28),EPHOTON(10,28),DRXE(10,28),DRYE(10,28),DRZE(10,28),DRX(10,28),DRY(10,28),DRZ[10,28]</span>
    <span class="c"># COMMON/CALCAS1B/IONSUM1(10),IFLSUM1(10),ESTOR1(10,28),EPHOTG1(10,28),DRXE1(10,28),DRYE1(10,28),DRZE1(10,28),DRX1(10,28),DRY1(10,28),DRZ1(10,28)</span>
    <span class="c"># COMMON/CALCAS2B/IONSUM2(10),IFLSUM2(10),ESTOR2(10,28),EPHOTG2(10,28),DRXE2(10,28),DRYE2(10,28),DRZE2(10,28),DRX2(10,28),DRY2(10,28),DRZ2(10,28)</span>
    <span class="c"># COMMON/CALCAS3B/IONSUM3(10),IFLSUM3(10),ESTOR3(10,28),EPHOTG3(10,28),DRXE3(10,28),DRYE3(10,28),DRZE3(10,28),DRX3(10,28),DRY3(10,28),DRZ3(10,28)</span>
    <span class="c"># COMMON/CALCAS4B/IONSUM4(10),IFLSUM4(10),ESTOR4(10,28),EPHOTG4(10,28),DRXE4(10,28),DRYE4(10,28),DRZE4(10,28),DRX4(10,28),DRY4(10,28),DRZ4(10,28)</span>
    <span class="c"># COMMON/CALCAS5B/IONSUM5(10),IFLSUM5(10),ESTOR5(10,28),EPHOTG5(10,28),DRXE5(10,28),DRYE5(10,28),DRZE5(10,28),DRX5(10,28),DRY5(10,28),DRZ5(10,28)</span>
    <span class="c"># COMMON/COUTE/ECMP(10),ECDRX(10),ECDRY(10),ECDRZ[10],XCPOS(10),YCPOS(10),ZCPOS(10),KCGAS(10),LCGAS(10),ICSHELL(10)</span>
    <span class="c">#</span>
    <span class="c">#COMMON/COMP/</span>
    <span class="k">global</span> <span class="n">LCMP</span><span class="p">,</span><span class="n">LCFLG</span><span class="p">,</span><span class="n">LRAY</span><span class="p">,</span><span class="n">LRFLG</span><span class="p">,</span><span class="n">LPAP</span><span class="p">,</span><span class="n">LPFLG</span><span class="p">,</span><span class="n">LBRM</span><span class="p">,</span><span class="n">LBFLG</span><span class="p">,</span><span class="n">LPEFLG</span>
    <span class="c">#COMMON/GENCAS/</span>
    <span class="k">global</span> <span class="n">ELEV</span><span class="c">#(17,79)</span>
    <span class="k">global</span> <span class="n">NSDEG</span><span class="c">#(17)</span>
    <span class="k">global</span> <span class="n">AA</span><span class="c">#(17)</span>
    <span class="k">global</span> <span class="n">BB</span><span class="c">#(17)</span>
    <span class="k">global</span> <span class="n">SCR</span><span class="p">,</span><span class="n">SCR1</span>
    <span class="c">#COMMON/MIXC/</span>
    <span class="k">global</span> <span class="n">PRSH</span><span class="c">#(6,3,17,17)</span>
    <span class="k">global</span> <span class="n">ESH</span><span class="c">#(6,3,17)</span>
    <span class="k">global</span> <span class="n">AUG</span><span class="c">#(6,3,17,17,17)</span>
    <span class="k">global</span> <span class="n">RAD</span><span class="c">#(6,3,17,17)</span>
    <span class="k">global</span> <span class="n">PRSHBT</span><span class="c">#(6,3,17)</span>
    <span class="k">global</span> <span class="n">IZ</span><span class="c">#(6,3)</span>
    <span class="k">global</span> <span class="n">INIOCC</span><span class="c">#(6,3,17)</span>
    <span class="k">global</span> <span class="n">ISHLMX</span><span class="c">#(6,3)</span>
    <span class="k">global</span> <span class="n">AMZ</span><span class="c">#(6,3)</span>
    <span class="c">#COMMON/UPD/</span>
    <span class="k">global</span> <span class="n">NOCC</span><span class="c">#(6,3,17)</span>
    <span class="k">global</span> <span class="n">AUGR</span><span class="c">#(6,3,17,17,17)</span>
    <span class="k">global</span> <span class="n">RADR</span><span class="c">#(6,3,17,17)</span>
    <span class="c">#COMMON/CALCASB/</span>
    <span class="k">global</span> <span class="n">IONSUM</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">IFLSUM</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">ESTORE</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">EPHOTON</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRXE</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRYE</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZE</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRX</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRY</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZ</span><span class="c">#(10,28)</span>
    <span class="c">#COMMON/CALCAS1B/</span>
    <span class="k">global</span> <span class="n">IONSUM1</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">IFLSUM1</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">ESTOR1</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">EPHOTG1</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRXE1</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRYE1</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZE1</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRX1</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRY1</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZ1</span><span class="c">#(10,28)</span>
    <span class="c">#COMMON/CALCAS2B/</span>
    <span class="k">global</span> <span class="n">IONSUM2</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">IFLSUM2</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">ESTOR2</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">EPHOTG2</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRXE2</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRYE2</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZE2</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRX2</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRY2</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZ2</span><span class="c">#(10,28)</span>
    <span class="c">#COMMON/CALCAS3B/</span>
    <span class="k">global</span> <span class="n">IONSUM3</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">IFLSUM3</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">ESTOR3</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">EPHOTG3</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRXE3</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRYE3</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZE3</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRX3</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRY3</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZ3</span><span class="c">#(10,28)</span>
    <span class="c">#COMMON/CALCAS4B/</span>
    <span class="k">global</span> <span class="n">IONSUM4</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">IFLSUM4</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">ESTOR4</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">EPHOTG4</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRXE4</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRYE4</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZE4</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRX4</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRY4</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZ4</span><span class="c">#(10,28)</span>
    <span class="c">#COMMON/CALCAS5B/</span>
    <span class="k">global</span> <span class="n">IONSUM5</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">IFLSUM5</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">ESTOR5</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">EPHOTG5</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRXE5</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRYE5</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZE5</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRX5</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRY5</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZ5</span><span class="c">#(10,28)</span>
    <span class="c">#COMMON/COUTE/</span>
    <span class="k">global</span> <span class="n">ECMP</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">ECDRX</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">ECDRY</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">ECDRZ</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">XCPOS</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">YCPOS</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">ZCPOS</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">KCGAS</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">LCGAS</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">ICSHELL</span><span class="c">#(10)</span>

    <span class="c">#  CALCULATES AUGER AND FLUORESCENCE CASCADE FOR VACANCY IN ICSHELL</span>
    <span class="c">#</span>
    <span class="n">IFIRST</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">ISECOND</span><span class="o">=</span><span class="mi">2</span>
    <span class="n">ICONPH</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">X0</span><span class="o">=</span><span class="n">XCPOS</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span>
    <span class="n">Y0</span><span class="o">=</span><span class="n">YCPOS</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span>
    <span class="n">Z0</span><span class="o">=</span><span class="n">ZCPOS</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span>
    <span class="n">DRXE</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">ECDRX</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span>
    <span class="n">DRYE</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">ECDRY</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span>
    <span class="n">DRZE</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">ECDRZ</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span>
    <span class="n">KDUM</span><span class="o">=</span><span class="n">KCGAS</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span>
    <span class="n">LDUM</span><span class="o">=</span><span class="n">LCGAS</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span>
    <span class="n">EDUM</span><span class="o">=</span><span class="n">ECMP</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span>
    <span class="n">IDUM</span><span class="o">=</span><span class="n">ICSHELL</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span>
    <span class="c"># </span>
    <span class="c"># CALCULATE CASCADE EVENT</span>
    <span class="n">CALCB</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">KDUM</span><span class="p">,</span><span class="n">LDUM</span><span class="p">,</span><span class="n">EDUM</span><span class="p">,</span><span class="n">IDUM</span><span class="p">)</span>
    <span class="c">#     IF(IDBG == 1) :</span>
    <span class="c">#     DO 67 M1=1,NVAC</span>
    <span class="c">#     WRITE(6,66) EDUM,M1,(ESTORE(M1,KK),KK=1,28)</span>
    <span class="c">#  66 print(' IN CONTROLB EDUM=','%.4f' % ,' M1=',I3,/,' ESTORE(M1,K)=',</span>
    <span class="c">#    /4(7'%.4f' % ,/))</span>
    <span class="c">#  67 CONTINUE</span>
    <span class="c">#     WRITE(6,68) (IFLSUM(KK),KK=1,10)</span>
    <span class="c">#  68 print(' IFLSUM=',10I4)</span>
    <span class="c">#     DO 70 M1=1,NVAC</span>
    <span class="c">#     WRITE(6,69) (EPHOTON(M1,KK),KK=1,28)</span>
    <span class="c">#  69 print(' EPHOTON=',4(7'%.4f' % ,/))</span>
    <span class="c">#  70 CONTINUE   </span>
    <span class="c">#C    # endIF</span>
    <span class="c"># STORE EVENT </span>
    <span class="c">#     Z0=DIST</span>
    <span class="n">CASSTOREB</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">X0</span><span class="p">,</span><span class="n">Y0</span><span class="p">,</span><span class="n">Z0</span><span class="p">)</span>
    <span class="c"># IF INCLUDE PHOTOABSORPTION OF FLUORESENCE : </span>
    <span class="k">if</span><span class="p">(</span><span class="n">ICONPH</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span><span class="p">(</span><span class="n">IFLSUM</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span><span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="c"># ZERO COUNTER</span>
            <span class="n">L1</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">CSSTFB1</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">,</span><span class="n">DIST1</span><span class="p">)</span>
            <span class="k">pass</span>
            <span class="c"># endif</span>
            <span class="c"># LOOP AROUND FIRST GEN FLUORESCENCE</span>
        <span class="k">else</span><span class="p">:</span>           
            <span class="n">IFLLOW</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">IFL1</span><span class="o">=</span><span class="n">IFLSUM</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">L1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IFL1</span><span class="p">):</span>
                <span class="n">EPH</span><span class="o">=</span><span class="n">EPHOTON</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span>
                <span class="c">#</span>
                <span class="c"># CALC ABSORPTION POSITION X1,Y1,Z1 FOR FLUORESENCE PHOTON OF ENERGY EPH</span>
                <span class="c"># WITH ABSORPTION IN SHELL ISHELL1 IN GAS KGAS1 COMPONENT LGAS1 </span>
                <span class="n">ABSO</span><span class="p">(</span><span class="n">ISECOND</span><span class="p">,</span><span class="n">EPH</span><span class="p">,</span><span class="n">ISHELL1</span><span class="p">,</span><span class="n">KGAS1</span><span class="p">,</span><span class="n">LGAS1</span><span class="p">,</span><span class="n">DIST1</span><span class="p">)</span>
                <span class="c">#      IF(IDBG == 1) :</span>
                <span class="c">#      WRITE(6,72) EPH,ISHELL1</span>
                <span class="c">#  72  print('IN CONTROLB EPH=','%.4f' % ,' ISHELL1=',I4)</span>
                <span class="c">#      # endIF</span>
                <span class="c"># LOW ENERGY PHOTON</span>
                <span class="k">if</span><span class="p">(</span><span class="n">ISHELL1</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">IFLSUM</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span><span class="o">=</span><span class="n">IFLSUM</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span>
                    <span class="k">pass</span>
                    <span class="c"># endif</span>
                    <span class="c">#</span>
                    <span class="c"># CALCULATE CASCADE IN GAS </span>
                    <span class="c">#      IF(IDBG == 1) :</span>
                    <span class="c">#      WRITE(6,445) L1,ISHELL1,EPH</span>
                    <span class="c"># 445  print(' CALLING CALCB1 L1=',I3,' ISHELL1=',I3,' EPH=','%.4f' % )</span>
                    <span class="c">#      # endIF</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">CALCB1</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">KGAS1</span><span class="p">,</span><span class="n">LGAS1</span><span class="p">,</span><span class="n">EPH</span><span class="p">,</span><span class="n">ISHELL1</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span>
                    <span class="c"># STORE EVENT</span>
                    <span class="n">CSSTFB1</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">,</span><span class="n">DIST1</span><span class="p">)</span> 
        <span class="c"># </span>
        <span class="c"># SECOND GENERATION FLUORESCENCE</span>
        <span class="k">if</span><span class="p">(</span><span class="n">IFLSUM1</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span><span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">:</span>    
            <span class="c"># ZERO COUNTER</span>
            <span class="n">L2</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">CSSTFB2</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L2</span><span class="p">,</span><span class="n">DIST</span><span class="p">)</span>
            <span class="k">pass</span>
            <span class="c"># endif </span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># LOOP AROUND SECOND GEN FLUORESCENCE</span>
            <span class="n">IFL2</span><span class="o">=</span><span class="n">IFLSUM1</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">L2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IFL2</span><span class="p">):</span>
                <span class="n">EPH</span><span class="o">=</span><span class="n">EPHOTG1</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L2</span><span class="p">)</span>
                <span class="c">#</span>
                <span class="c"># CALC ABSORPTION POSITION X2,Y2,Z2 FOR FLUORESENCE PHOTON OF ENERGY EPH</span>
                <span class="c"># WITH ABSORPTION IN SHELL ISHELL2 IN GAS KGAS2 COMPONENT LGAS2</span>
                <span class="n">ABSO</span><span class="p">(</span><span class="n">ISECOND</span><span class="p">,</span><span class="n">EPH</span><span class="p">,</span><span class="n">ISHELL2</span><span class="p">,</span><span class="n">KGAS2</span><span class="p">,</span><span class="n">LGAS2</span><span class="p">,</span><span class="n">DIST2</span><span class="p">)</span>
                <span class="c"># LOW ENERGY PHOTON</span>
                <span class="k">if</span><span class="p">(</span><span class="n">ISHELL2</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="k">pass</span>
                    <span class="c">#</span>
                    <span class="c"># CALCULATE CASCADE IN GAS </span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">CALCB2</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">KGAS2</span><span class="p">,</span><span class="n">LGAS2</span><span class="p">,</span><span class="n">EPH</span><span class="p">,</span><span class="n">ISHELL2</span><span class="p">,</span><span class="n">L2</span><span class="p">)</span>
                    <span class="c"># STORE EVENT</span>
                    <span class="n">CSSTFB2</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L2</span><span class="p">,</span><span class="n">DIST2</span><span class="p">)</span>               
        <span class="c"># </span>
        <span class="c"># THIRD GENERATION FLUORESCENCE</span>
        <span class="k">if</span><span class="p">(</span><span class="n">IFLSUM2</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span><span class="o">==</span> <span class="mi">0</span><span class="p">):</span>     
            <span class="c"># ZERO COUNTER</span>
            <span class="n">L3</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">CSSTFB3</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L3</span><span class="p">,</span><span class="n">DIST</span><span class="p">)</span> 
            <span class="k">pass</span>
            <span class="c"># endif</span>
            <span class="c"># LOOP AROUND THIRD GEN FLUORESCENCE</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">IFL3</span><span class="o">=</span><span class="n">IFLSUM2</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">L3</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IFL3</span><span class="p">):</span>
                <span class="n">EPH</span><span class="o">=</span><span class="n">EPHOTG2</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L3</span><span class="p">]</span>
                <span class="c">#</span>
                <span class="c"># CALC ABSORPTION POSITION X3,Y3,Z3 FOR FLUORESENCE PHOTON OF ENERGY EPH</span>
                <span class="c"># WITH ABSORPTION IN SHELL ISHELL3 IN GAS KGAS3 COMPONENT LGAS3</span>
                <span class="n">ABSO</span><span class="p">(</span><span class="n">ISECOND</span><span class="p">,</span><span class="n">EPH</span><span class="p">,</span><span class="n">ISHELL3</span><span class="p">,</span><span class="n">KGAS3</span><span class="p">,</span><span class="n">LGAS3</span><span class="p">,</span><span class="n">DIST3</span><span class="p">)</span>
                <span class="c"># LOW ENERGY PHOTON</span>
                <span class="k">if</span><span class="p">(</span><span class="n">ISHELL3</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="k">pass</span>
                    <span class="c">#</span>
                    <span class="c"># CALCULATE CASCADE IN GAS </span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">CALCB3</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">KGAS3</span><span class="p">,</span><span class="n">LGAS3</span><span class="p">,</span><span class="n">EPH</span><span class="p">,</span><span class="n">ISHELL3</span><span class="p">,</span><span class="n">L3</span><span class="p">)</span>
                    <span class="c"># STORE EVENT</span>
                    <span class="n">CSSTFB3</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L3</span><span class="p">,</span><span class="n">DIST3</span><span class="p">)</span>               
        <span class="c"># </span>
        <span class="c"># FOURTH GENERATION FLUORESCENCE</span>
        <span class="k">if</span><span class="p">(</span><span class="n">IFLSUM3</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span><span class="o">==</span> <span class="mi">0</span><span class="p">):</span>    
            <span class="c"># ZERO COUNTER</span>
            <span class="n">L4</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">CSSTFB4</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L4</span><span class="p">,</span><span class="n">DIST</span><span class="p">)</span>
            <span class="k">pass</span>
            <span class="c"># endif</span>
            <span class="c"># LOOP AROUND FOURTH GEN FLUORESCENCE</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">IFL4</span><span class="o">=</span><span class="n">IFLSUM3</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">L4</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IFL4</span><span class="p">):</span>
                <span class="n">EPH</span><span class="o">=</span><span class="n">EPHOTG3</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L4</span><span class="p">]</span>
                <span class="c">#</span>
                <span class="c"># CALC ABSORPTION POSITION X4,Y4,Z4 FOR FLUORESENCE PHOTON OF ENERGY EPH</span>
                <span class="c"># WITH ABSORPTION IN SHELL ISHELL4 IN GAS KGAS4 COMPONENT LGAS4</span>
                <span class="n">ABSO</span><span class="p">(</span><span class="n">ISECOND</span><span class="p">,</span><span class="n">EPH</span><span class="p">,</span><span class="n">ISHELL4</span><span class="p">,</span><span class="n">KGAS4</span><span class="p">,</span><span class="n">LGAS4</span><span class="p">,</span><span class="n">DIST4</span><span class="p">)</span>
                <span class="c"># LOW ENERGY PHOTON</span>
                <span class="k">if</span><span class="p">(</span><span class="n">ISHELL4</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c">#</span>
                    <span class="c"># CALCULATE CASCADE IN GAS </span>
                    <span class="n">CALCB4</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">KGAS4</span><span class="p">,</span><span class="n">LGAS4</span><span class="p">,</span><span class="n">EPH</span><span class="p">,</span><span class="n">ISHELL4</span><span class="p">,</span><span class="n">L4</span><span class="p">)</span>
                    <span class="c"># STORE EVENT</span>
                    <span class="n">CSSTFB4</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L4</span><span class="p">,</span><span class="n">DIST4</span><span class="p">)</span>                    
        <span class="c"># </span>
        <span class="c"># FIFTH GENERATION FLUORESCENCE</span>
        <span class="k">if</span><span class="p">(</span><span class="n">IFLSUM4</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span><span class="o">==</span> <span class="mi">0</span><span class="p">):</span>     
            <span class="c"># ZERO COUNTER</span>
            <span class="n">L5</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">CSSTFB5</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L5</span><span class="p">,</span><span class="n">DIST</span><span class="p">)</span>
            <span class="k">pass</span>
            <span class="c"># endif</span>
            <span class="c"># LOOP AROUND FIFTH GEN FLUORESCENCE</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">IFL5</span><span class="o">=</span><span class="n">IFLSUM5</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">L5</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IFL5</span><span class="p">):</span>
                <span class="n">EPH</span><span class="o">=</span><span class="n">EPHOTG4</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L5</span><span class="p">]</span>
                <span class="c">#</span>
                <span class="c"># CALC ABSORPTION POSITION X5,Y5,Z5 FOR FLUORESENCE PHOTON OF ENERGY EPH</span>
                <span class="c"># WITH ABSORPTION IN SHELL ISHELL5 IN GAS KGAS5 COMPONENT LGAS5</span>
                <span class="n">ABSO</span><span class="p">(</span><span class="n">ISECOND</span><span class="p">,</span><span class="n">EPH</span><span class="p">,</span><span class="n">ISHELL5</span><span class="p">,</span><span class="n">KGAS5</span><span class="p">,</span><span class="n">LGAS5</span><span class="p">,</span><span class="n">DIST5</span><span class="p">)</span>
                <span class="c"># LOW ENERGY PHOTON</span>
                <span class="k">if</span><span class="p">(</span><span class="n">ISHELL5</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c">#</span>
                    <span class="c"># CALCULATE CASCADE IN GAS </span>
                    <span class="n">CALCB5</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">KGAS5</span><span class="p">,</span><span class="n">LGAS5</span><span class="p">,</span><span class="n">EPH</span><span class="p">,</span><span class="n">ISHELL5</span><span class="p">,</span><span class="n">L5</span><span class="p">)</span>
                    <span class="c"># STORE EVENT</span>
                    <span class="n">CSSTFB5</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L5</span><span class="p">,</span><span class="n">DIST5</span><span class="p">)</span>               
                    <span class="k">if</span><span class="p">(</span><span class="n">IFLSUM5</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span><span class="o">&gt;=</span> <span class="mi">1</span><span class="p">):</span>
                        <span class="k">print</span><span class="p">(</span><span class="s">' WARNING SIXTH GENERATION EXISTS IFLSUM5='</span><span class="p">,</span><span class="n">IFLSUM5</span><span class="p">)</span>
    <span class="c"># endif</span>
    <span class="c"># 10 CONTINUE</span>
    <span class="c">#     IF(IDBG == 1) :</span>
    <span class="c">#     DO 666 KKK=1,NVAC</span>
    <span class="c">#     WRITE(6,777) (ESTORE(KKK,K),K=1,28)</span>
    <span class="c"># 777 print(' ESTORE=',4(7'%.4f' % ,/))</span>
    <span class="c">#     WRITE(6,778) (ESTOR1(KKK,K),K=1,28)</span>
    <span class="c"># 778 print(' ESTOR1=',4(7'%.4f' % ,/))</span>
    <span class="c">#     WRITE(6,779) IONSUM(KKK),IONSUM1(KKK),IONSUM2(KKK),IONSUM3(KKK),</span>
    <span class="c">#    /IONSUM4(KKK),IONSUM5(KKK)</span>
    <span class="c"># 779 print(' IONSUM 0-5=',6I4)</span>
    <span class="c">#     WRITE(6,780) IFLSUM(KKK),IFLSUM1(KKK),IFLSUM2(KKK),IFLSUM3(KKK),</span>
    <span class="c">#    /IFLSUM4(KKK),IFLSUM5(KKK)</span>
    <span class="c"># 780 print(' IFLSUM 0-5=',6I4)</span>
    <span class="c"># 666 CONTINUE</span>
    <span class="c">#     # endIF</span>
    <span class="k">return</span> 
    <span class="c"># end</span>
</code></pre><pre class="highlight fortran tab-fortran"><code><span class="w">      </span><span class="k">SUBROUTINE</span><span class="w"> </span><span class="n">CONTROLB</span><span class="p">(</span><span class="n">IDBG</span><span class="p">,</span><span class="n">NVAC</span><span class="p">)</span><span class="w">
      </span><span class="k">IMPLICIT</span><span class="w"> </span><span class="kt">REAL</span><span class="o">*</span><span class="mi">8</span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="n">H</span><span class="p">,</span><span class="n">O</span><span class="o">-</span><span class="n">Z</span><span class="p">)</span><span class="w">
      </span><span class="k">IMPLICIT</span><span class="w"> </span><span class="kt">INTEGER</span><span class="o">*</span><span class="mi">8</span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="n">N</span><span class="p">)</span><span class="w">
      </span><span class="kt">CHARACTER</span><span class="o">*</span><span class="mi">6</span><span class="w"> </span><span class="n">SCR</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span><span class="n">SCR1</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="k">COMMON</span><span class="p">/</span><span class="n">INPT2</span><span class="p">/</span><span class="n">KGAS</span><span class="p">,</span><span class="n">LGAS</span><span class="p">,</span><span class="n">DETEFF</span><span class="p">,</span><span class="n">EXCWGHT</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">COMP</span><span class="p">/</span><span class="n">LCMP</span><span class="p">,</span><span class="n">LCFLG</span><span class="p">,</span><span class="n">LRAY</span><span class="p">,</span><span class="n">LRFLG</span><span class="p">,</span><span class="n">LPAP</span><span class="p">,</span><span class="n">LPFLG</span><span class="p">,</span><span class="n">LBRM</span><span class="p">,</span><span class="n">LBFLG</span><span class="p">,</span><span class="n">LPEFLG</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">GENCAS</span><span class="p">/</span><span class="n">ELEV</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">79</span><span class="p">),</span><span class="n">NSDEG</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span><span class="n">AA</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span><span class="n">BB</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span><span class="n">SCR</span><span class="p">,</span><span class="n">SCR1</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">MIXC</span><span class="p">/</span><span class="n">PRSH</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">17</span><span class="p">),</span><span class="n">ESH</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">17</span><span class="p">),</span><span class="n">AUG</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">17</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">RAD</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">17</span><span class="p">),</span><span class="n">PRSHBT</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">17</span><span class="p">),</span><span class="n">IZ</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">INIOCC</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">17</span><span class="p">),</span><span class="n">ISHLMX</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">AMZ</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">UPD</span><span class="p">/</span><span class="n">NOCC</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">17</span><span class="p">),</span><span class="n">AUGR</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">17</span><span class="p">),</span><span class="n">RADR</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">17</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">CALCASB</span><span class="p">/</span><span class="n">IONSUM</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">IFLSUM</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ESTORE</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">EPHOTON</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRXE</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRYE</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZE</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRX</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRY</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRZ</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">CALCAS1B</span><span class="p">/</span><span class="n">IONSUM1</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">IFLSUM1</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ESTOR1</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">EPHOTG1</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRXE1</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRYE1</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZE1</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRX1</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRY1</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZ1</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">CALCAS2B</span><span class="p">/</span><span class="n">IONSUM2</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">IFLSUM2</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ESTOR2</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">EPHOTG2</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRXE2</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRYE2</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZE2</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRX2</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRY2</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZ2</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">CALCAS3B</span><span class="p">/</span><span class="n">IONSUM3</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">IFLSUM3</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ESTOR3</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">EPHOTG3</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRXE3</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRYE3</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZE3</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRX3</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRY3</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZ3</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">CALCAS4B</span><span class="p">/</span><span class="n">IONSUM4</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">IFLSUM4</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ESTOR4</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">EPHOTG4</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRXE4</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRYE4</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZE4</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRX4</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRY4</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZ4</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">CALCAS5B</span><span class="p">/</span><span class="n">IONSUM5</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">IFLSUM5</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ESTOR5</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">EPHOTG5</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRXE5</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRYE5</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZE5</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRX5</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRY5</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZ5</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">COUTE</span><span class="p">/</span><span class="n">ECMP</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ECDRX</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ECDRY</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ECDRZ</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">XCPOS</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">YCPOS</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ZCPOS</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">KCGAS</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">LCGAS</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ICSHELL</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">
</span><span class="n">C</span><span class="w">  </span><span class="n">CALCULATES</span><span class="w"> </span><span class="n">AUGER</span><span class="w"> </span><span class="n">AND</span><span class="w"> </span><span class="n">FLUORESCENCE</span><span class="w"> </span><span class="n">CASCADE</span><span class="w"> </span><span class="n">FOR</span><span class="w"> </span><span class="n">VACANCY</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">ICSHELL</span><span class="w">
</span><span class="n">C</span><span class="w">
      </span><span class="n">IFIRST</span><span class="o">=</span><span class="mi">1</span><span class="w">
      </span><span class="n">ISECOND</span><span class="o">=</span><span class="mi">2</span><span class="w">
      </span><span class="n">ICONPH</span><span class="o">=</span><span class="mi">1</span><span class="w">
      </span><span class="n">X0</span><span class="o">=</span><span class="n">XCPOS</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="w">
      </span><span class="n">Y0</span><span class="o">=</span><span class="n">YCPOS</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="w">
      </span><span class="n">Z0</span><span class="o">=</span><span class="n">ZCPOS</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="w">
      </span><span class="n">DRXE</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">ECDRX</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="w">
      </span><span class="n">DRYE</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">ECDRY</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="w">
      </span><span class="n">DRZE</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">ECDRZ</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="w">
      </span><span class="n">KDUM</span><span class="o">=</span><span class="n">KCGAS</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="w">
      </span><span class="n">LDUM</span><span class="o">=</span><span class="n">LCGAS</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="w">
      </span><span class="n">EDUM</span><span class="o">=</span><span class="n">ECMP</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="w">
      </span><span class="n">IDUM</span><span class="o">=</span><span class="n">ICSHELL</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w"> 
</span><span class="n">C</span><span class="w"> </span><span class="n">CALCULATE</span><span class="w"> </span><span class="n">CASCADE</span><span class="w"> </span><span class="n">EVENT</span><span class="w">
      </span><span class="k">CALL</span><span class="w"> </span><span class="n">CALCB</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">KDUM</span><span class="p">,</span><span class="n">LDUM</span><span class="p">,</span><span class="n">EDUM</span><span class="p">,</span><span class="n">IDUM</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="k">IF</span><span class="p">(</span><span class="n">IDBG</span><span class="ow">.EQ.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="k">DO</span><span class="w"> </span><span class="mi">67</span><span class="w"> </span><span class="n">M1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NVAC</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">66</span><span class="p">)</span><span class="w"> </span><span class="n">EDUM</span><span class="p">,</span><span class="n">M1</span><span class="p">,(</span><span class="n">ESTORE</span><span class="p">(</span><span class="n">M1</span><span class="p">,</span><span class="n">KK</span><span class="p">),</span><span class="n">KK</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">  </span><span class="mi">66</span><span class="w"> </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">' IN CONTROLB EDUM='</span><span class="p">,</span><span class="l">D12.4</span><span class="p">,</span><span class="s1">' M1='</span><span class="p">,</span><span class="l">I3</span><span class="p">,</span><span class="l">/</span><span class="p">,</span><span class="s1">' ESTORE(M1,K)='</span><span class="p">,</span><span class="w">
</span><span class="l">C</span><span class="w">    </span><span class="l">/4</span><span class="p">(</span><span class="l">7D12.4</span><span class="p">,</span><span class="l">/</span><span class="p">))</span><span class="w">
</span><span class="n">C</span><span class="w">  </span><span class="mi">67</span><span class="w"> </span><span class="k">CONTINUE</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">68</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">IFLSUM</span><span class="p">(</span><span class="n">KK</span><span class="p">),</span><span class="n">KK</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">  </span><span class="mi">68</span><span class="w"> </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">' IFLSUM='</span><span class="p">,</span><span class="l">10I4</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="k">DO</span><span class="w"> </span><span class="mi">70</span><span class="w"> </span><span class="n">M1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NVAC</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">69</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">EPHOTON</span><span class="p">(</span><span class="n">M1</span><span class="p">,</span><span class="n">KK</span><span class="p">),</span><span class="n">KK</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">  </span><span class="mi">69</span><span class="w"> </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">' EPHOTON='</span><span class="p">,</span><span class="l">4</span><span class="p">(</span><span class="l">7D12.4</span><span class="p">,</span><span class="l">/</span><span class="p">))</span><span class="w">
</span><span class="n">C</span><span class="w">  </span><span class="mi">70</span><span class="w"> </span><span class="k">CONTINUE</span><span class="w">   
</span><span class="n">CC</span><span class="w">    </span><span class="k">ENDIF</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">STORE</span><span class="w"> </span><span class="n">EVENT</span><span class="w"> 
</span><span class="n">C</span><span class="w">     </span><span class="n">Z0</span><span class="o">=</span><span class="n">DIST</span><span class="w">
      </span><span class="k">CALL</span><span class="w"> </span><span class="n">CASSTOREB</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">X0</span><span class="p">,</span><span class="n">Y0</span><span class="p">,</span><span class="n">Z0</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">INCLUDE</span><span class="w"> </span><span class="n">PHOTOABSORPTION</span><span class="w"> </span><span class="n">OF</span><span class="w"> </span><span class="n">FLUORESENCE</span><span class="w"> </span><span class="k">THEN</span><span class="w"> 
      </span><span class="k">IF</span><span class="p">(</span><span class="n">ICONPH</span><span class="ow">.EQ.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
       </span><span class="k">IF</span><span class="p">(</span><span class="n">IFLSUM</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="ow">.EQ.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">ZERO</span><span class="w"> </span><span class="n">COUNTER</span><span class="w">
         </span><span class="n">L1</span><span class="o">=</span><span class="mi">0</span><span class="w">
         </span><span class="k">CALL</span><span class="w"> </span><span class="n">CSSTFB1</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">,</span><span class="n">DIST1</span><span class="p">)</span><span class="w">
         </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">91</span><span class="w">
        </span><span class="k">ENDIF</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">LOOP</span><span class="w"> </span><span class="n">AROUND</span><span class="w"> </span><span class="n">FIRST</span><span class="w"> </span><span class="n">GEN</span><span class="w"> </span><span class="n">FLUORESCENCE</span><span class="w">
       </span><span class="n">IFLLOW</span><span class="o">=</span><span class="mi">0</span><span class="w">
       </span><span class="n">IFL1</span><span class="o">=</span><span class="n">IFLSUM</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="w">
       </span><span class="k">DO</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="n">L1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">IFL1</span><span class="w">
       </span><span class="n">EPH</span><span class="o">=</span><span class="n">EPHOTON</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">CALC</span><span class="w"> </span><span class="n">ABSORPTION</span><span class="w"> </span><span class="n">POSITION</span><span class="w"> </span><span class="n">X1</span><span class="p">,</span><span class="n">Y1</span><span class="p">,</span><span class="n">Z1</span><span class="w"> </span><span class="n">FOR</span><span class="w"> </span><span class="n">FLUORESENCE</span><span class="w"> </span><span class="n">PHOTON</span><span class="w"> </span><span class="n">OF</span><span class="w"> </span><span class="n">ENERGY</span><span class="w"> </span><span class="n">EPH</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">WITH</span><span class="w"> </span><span class="n">ABSORPTION</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">SHELL</span><span class="w"> </span><span class="n">ISHELL1</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">GAS</span><span class="w"> </span><span class="n">KGAS1</span><span class="w"> </span><span class="n">COMPONENT</span><span class="w"> </span><span class="n">LGAS1</span><span class="w"> 
       </span><span class="k">CALL</span><span class="w"> </span><span class="n">ABSO</span><span class="p">(</span><span class="n">ISECOND</span><span class="p">,</span><span class="n">EPH</span><span class="p">,</span><span class="n">ISHELL1</span><span class="p">,</span><span class="n">KGAS1</span><span class="p">,</span><span class="n">LGAS1</span><span class="p">,</span><span class="n">DIST1</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">      </span><span class="k">IF</span><span class="p">(</span><span class="n">IDBG</span><span class="ow">.EQ.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
</span><span class="n">C</span><span class="w">      </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">72</span><span class="p">)</span><span class="w"> </span><span class="n">EPH</span><span class="p">,</span><span class="n">ISHELL1</span><span class="w">
</span><span class="n">C</span><span class="w">  </span><span class="mi">72</span><span class="w">  </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">'IN CONTROLB EPH='</span><span class="p">,</span><span class="l">D12.4</span><span class="p">,</span><span class="s1">' ISHELL1='</span><span class="p">,</span><span class="l">I4</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">      </span><span class="k">ENDIF</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">LOW</span><span class="w"> </span><span class="n">ENERGY</span><span class="w"> </span><span class="n">PHOTON</span><span class="w">
       </span><span class="k">IF</span><span class="p">(</span><span class="n">ISHELL1</span><span class="ow">.EQ.</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
        </span><span class="n">IFLSUM</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="o">=</span><span class="n">IFLSUM</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="mi">-1</span><span class="w">
        </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">9</span><span class="w">
       </span><span class="k">ENDIF</span><span class="w">
</span><span class="n">C</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">CALCULATE</span><span class="w"> </span><span class="n">CASCADE</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">GAS</span><span class="w"> 
</span><span class="n">C</span><span class="w">      </span><span class="k">IF</span><span class="p">(</span><span class="n">IDBG</span><span class="ow">.EQ.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
</span><span class="n">C</span><span class="w">      </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">445</span><span class="p">)</span><span class="w"> </span><span class="n">L1</span><span class="p">,</span><span class="n">ISHELL1</span><span class="p">,</span><span class="n">EPH</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="mi">445</span><span class="w">  </span><span class="k">format</span><span class="p">(</span><span class="s1">' CALLING CALCB1 L1='</span><span class="p">,</span><span class="l">I3</span><span class="p">,</span><span class="s1">' ISHELL1='</span><span class="p">,</span><span class="l">I3</span><span class="p">,</span><span class="s1">' EPH='</span><span class="p">,</span><span class="l">D12.4</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">      </span><span class="k">ENDIF</span><span class="w">
       </span><span class="k">CALL</span><span class="w"> </span><span class="n">CALCB1</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">KGAS1</span><span class="p">,</span><span class="n">LGAS1</span><span class="p">,</span><span class="n">EPH</span><span class="p">,</span><span class="n">ISHELL1</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">STORE</span><span class="w"> </span><span class="n">EVENT</span><span class="w">
       </span><span class="k">CALL</span><span class="w"> </span><span class="n">CSSTFB1</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">,</span><span class="n">DIST1</span><span class="p">)</span><span class="w"> 
    </span><span class="mi">9</span><span class="w">  </span><span class="k">CONTINUE</span><span class="w"> 
   </span><span class="mi">91</span><span class="w">  </span><span class="k">CONTINUE</span><span class="w">
</span><span class="n">C</span><span class="w"> 
</span><span class="n">C</span><span class="w"> </span><span class="n">SECOND</span><span class="w"> </span><span class="n">GENERATION</span><span class="w"> </span><span class="n">FLUORESCENCE</span><span class="w">
        </span><span class="k">IF</span><span class="p">(</span><span class="n">IFLSUM1</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="ow">.EQ.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">    
</span><span class="n">C</span><span class="w"> </span><span class="n">ZERO</span><span class="w"> </span><span class="n">COUNTER</span><span class="w">
         </span><span class="n">L2</span><span class="o">=</span><span class="mi">0</span><span class="w">
         </span><span class="k">CALL</span><span class="w"> </span><span class="n">CSSTFB2</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L2</span><span class="p">,</span><span class="n">DIST</span><span class="p">)</span><span class="w">
         </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">81</span><span class="w">        
        </span><span class="k">ENDIF</span><span class="w"> 
</span><span class="n">C</span><span class="w"> </span><span class="n">LOOP</span><span class="w"> </span><span class="n">AROUND</span><span class="w"> </span><span class="n">SECOND</span><span class="w"> </span><span class="n">GEN</span><span class="w"> </span><span class="n">FLUORESCENCE</span><span class="w">
       </span><span class="n">IFL2</span><span class="o">=</span><span class="n">IFLSUM1</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="w">
       </span><span class="k">DO</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="n">L2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">IFL2</span><span class="w">
       </span><span class="n">EPH</span><span class="o">=</span><span class="n">EPHOTG1</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L2</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">CALC</span><span class="w"> </span><span class="n">ABSORPTION</span><span class="w"> </span><span class="n">POSITION</span><span class="w"> </span><span class="n">X2</span><span class="p">,</span><span class="n">Y2</span><span class="p">,</span><span class="n">Z2</span><span class="w"> </span><span class="n">FOR</span><span class="w"> </span><span class="n">FLUORESENCE</span><span class="w"> </span><span class="n">PHOTON</span><span class="w"> </span><span class="n">OF</span><span class="w"> </span><span class="n">ENERGY</span><span class="w"> </span><span class="n">EPH</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">WITH</span><span class="w"> </span><span class="n">ABSORPTION</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">SHELL</span><span class="w"> </span><span class="n">ISHELL2</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">GAS</span><span class="w"> </span><span class="n">KGAS2</span><span class="w"> </span><span class="n">COMPONENT</span><span class="w"> </span><span class="n">LGAS2</span><span class="w">
       </span><span class="k">CALL</span><span class="w"> </span><span class="n">ABSO</span><span class="p">(</span><span class="n">ISECOND</span><span class="p">,</span><span class="n">EPH</span><span class="p">,</span><span class="n">ISHELL2</span><span class="p">,</span><span class="n">KGAS2</span><span class="p">,</span><span class="n">LGAS2</span><span class="p">,</span><span class="n">DIST2</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">LOW</span><span class="w"> </span><span class="n">ENERGY</span><span class="w"> </span><span class="n">PHOTON</span><span class="w">
       </span><span class="k">IF</span><span class="p">(</span><span class="n">ISHELL2</span><span class="ow">.EQ.</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">8</span><span class="w">
</span><span class="n">C</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">CALCULATE</span><span class="w"> </span><span class="n">CASCADE</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">GAS</span><span class="w"> 
       </span><span class="k">CALL</span><span class="w"> </span><span class="n">CALCB2</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">KGAS2</span><span class="p">,</span><span class="n">LGAS2</span><span class="p">,</span><span class="n">EPH</span><span class="p">,</span><span class="n">ISHELL2</span><span class="p">,</span><span class="n">L2</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">STORE</span><span class="w"> </span><span class="n">EVENT</span><span class="w">
       </span><span class="k">CALL</span><span class="w"> </span><span class="n">CSSTFB2</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L2</span><span class="p">,</span><span class="n">DIST2</span><span class="p">)</span><span class="w">               
    </span><span class="mi">8</span><span class="w">  </span><span class="k">CONTINUE</span><span class="w"> 
   </span><span class="mi">81</span><span class="w">  </span><span class="k">CONTINUE</span><span class="w">   
</span><span class="n">C</span><span class="w"> 
</span><span class="n">C</span><span class="w"> </span><span class="n">THIRD</span><span class="w"> </span><span class="n">GENERATION</span><span class="w"> </span><span class="n">FLUORESCENCE</span><span class="w">
       </span><span class="k">IF</span><span class="p">(</span><span class="n">IFLSUM2</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="ow">.EQ.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">     
</span><span class="n">C</span><span class="w"> </span><span class="n">ZERO</span><span class="w"> </span><span class="n">COUNTER</span><span class="w">
         </span><span class="n">L3</span><span class="o">=</span><span class="mi">0</span><span class="w">
         </span><span class="k">CALL</span><span class="w"> </span><span class="n">CSSTFB3</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L3</span><span class="p">,</span><span class="n">DIST</span><span class="p">)</span><span class="w"> 
         </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">71</span><span class="w">
        </span><span class="k">ENDIF</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">LOOP</span><span class="w"> </span><span class="n">AROUND</span><span class="w"> </span><span class="n">THIRD</span><span class="w"> </span><span class="n">GEN</span><span class="w"> </span><span class="n">FLUORESCENCE</span><span class="w">
       </span><span class="n">IFL3</span><span class="o">=</span><span class="n">IFLSUM2</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="w">
       </span><span class="k">DO</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="n">L3</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">IFL3</span><span class="w">
       </span><span class="n">EPH</span><span class="o">=</span><span class="n">EPHOTG2</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L3</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">CALC</span><span class="w"> </span><span class="n">ABSORPTION</span><span class="w"> </span><span class="n">POSITION</span><span class="w"> </span><span class="n">X3</span><span class="p">,</span><span class="n">Y3</span><span class="p">,</span><span class="n">Z3</span><span class="w"> </span><span class="n">FOR</span><span class="w"> </span><span class="n">FLUORESENCE</span><span class="w"> </span><span class="n">PHOTON</span><span class="w"> </span><span class="n">OF</span><span class="w"> </span><span class="n">ENERGY</span><span class="w"> </span><span class="n">EPH</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">WITH</span><span class="w"> </span><span class="n">ABSORPTION</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">SHELL</span><span class="w"> </span><span class="n">ISHELL3</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">GAS</span><span class="w"> </span><span class="n">KGAS3</span><span class="w"> </span><span class="n">COMPONENT</span><span class="w"> </span><span class="n">LGAS3</span><span class="w">
       </span><span class="k">CALL</span><span class="w"> </span><span class="n">ABSO</span><span class="p">(</span><span class="n">ISECOND</span><span class="p">,</span><span class="n">EPH</span><span class="p">,</span><span class="n">ISHELL3</span><span class="p">,</span><span class="n">KGAS3</span><span class="p">,</span><span class="n">LGAS3</span><span class="p">,</span><span class="n">DIST3</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">LOW</span><span class="w"> </span><span class="n">ENERGY</span><span class="w"> </span><span class="n">PHOTON</span><span class="w">
       </span><span class="k">IF</span><span class="p">(</span><span class="n">ISHELL3</span><span class="ow">.EQ.</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">7</span><span class="w">
</span><span class="n">C</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">CALCULATE</span><span class="w"> </span><span class="n">CASCADE</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">GAS</span><span class="w"> 
       </span><span class="k">CALL</span><span class="w"> </span><span class="n">CALCB3</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">KGAS3</span><span class="p">,</span><span class="n">LGAS3</span><span class="p">,</span><span class="n">EPH</span><span class="p">,</span><span class="n">ISHELL3</span><span class="p">,</span><span class="n">L3</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">STORE</span><span class="w"> </span><span class="n">EVENT</span><span class="w">
       </span><span class="k">CALL</span><span class="w"> </span><span class="n">CSSTFB3</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L3</span><span class="p">,</span><span class="n">DIST3</span><span class="p">)</span><span class="w">               
    </span><span class="mi">7</span><span class="w">  </span><span class="k">CONTINUE</span><span class="w"> 
   </span><span class="mi">71</span><span class="w">  </span><span class="k">CONTINUE</span><span class="w">     
</span><span class="n">C</span><span class="w"> 
</span><span class="n">C</span><span class="w"> </span><span class="n">FOURTH</span><span class="w"> </span><span class="n">GENERATION</span><span class="w"> </span><span class="n">FLUORESCENCE</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">IFLSUM3</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="ow">.EQ.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">    
</span><span class="n">C</span><span class="w"> </span><span class="n">ZERO</span><span class="w"> </span><span class="n">COUNTER</span><span class="w">
         </span><span class="n">L4</span><span class="o">=</span><span class="mi">0</span><span class="w">
         </span><span class="k">CALL</span><span class="w"> </span><span class="n">CSSTFB4</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L4</span><span class="p">,</span><span class="n">DIST</span><span class="p">)</span><span class="w">
         </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">61</span><span class="w">
        </span><span class="k">ENDIF</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">LOOP</span><span class="w"> </span><span class="n">AROUND</span><span class="w"> </span><span class="n">FOURTH</span><span class="w"> </span><span class="n">GEN</span><span class="w"> </span><span class="n">FLUORESCENCE</span><span class="w">
       </span><span class="n">IFL4</span><span class="o">=</span><span class="n">IFLSUM3</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="w">
       </span><span class="k">DO</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="n">L4</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">IFL4</span><span class="w">
       </span><span class="n">EPH</span><span class="o">=</span><span class="n">EPHOTG3</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L4</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">CALC</span><span class="w"> </span><span class="n">ABSORPTION</span><span class="w"> </span><span class="n">POSITION</span><span class="w"> </span><span class="n">X4</span><span class="p">,</span><span class="n">Y4</span><span class="p">,</span><span class="n">Z4</span><span class="w"> </span><span class="n">FOR</span><span class="w"> </span><span class="n">FLUORESENCE</span><span class="w"> </span><span class="n">PHOTON</span><span class="w"> </span><span class="n">OF</span><span class="w"> </span><span class="n">ENERGY</span><span class="w"> </span><span class="n">EPH</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">WITH</span><span class="w"> </span><span class="n">ABSORPTION</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">SHELL</span><span class="w"> </span><span class="n">ISHELL4</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">GAS</span><span class="w"> </span><span class="n">KGAS4</span><span class="w"> </span><span class="n">COMPONENT</span><span class="w"> </span><span class="n">LGAS4</span><span class="w">
       </span><span class="k">CALL</span><span class="w"> </span><span class="n">ABSO</span><span class="p">(</span><span class="n">ISECOND</span><span class="p">,</span><span class="n">EPH</span><span class="p">,</span><span class="n">ISHELL4</span><span class="p">,</span><span class="n">KGAS4</span><span class="p">,</span><span class="n">LGAS4</span><span class="p">,</span><span class="n">DIST4</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">LOW</span><span class="w"> </span><span class="n">ENERGY</span><span class="w"> </span><span class="n">PHOTON</span><span class="w">
       </span><span class="k">IF</span><span class="p">(</span><span class="n">ISHELL4</span><span class="ow">.EQ.</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">6</span><span class="w">
</span><span class="n">C</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">CALCULATE</span><span class="w"> </span><span class="n">CASCADE</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">GAS</span><span class="w"> 
       </span><span class="k">CALL</span><span class="w"> </span><span class="n">CALCB4</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">KGAS4</span><span class="p">,</span><span class="n">LGAS4</span><span class="p">,</span><span class="n">EPH</span><span class="p">,</span><span class="n">ISHELL4</span><span class="p">,</span><span class="n">L4</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">STORE</span><span class="w"> </span><span class="n">EVENT</span><span class="w">
       </span><span class="k">CALL</span><span class="w"> </span><span class="n">CSSTFB4</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L4</span><span class="p">,</span><span class="n">DIST4</span><span class="p">)</span><span class="w">                    
    </span><span class="mi">6</span><span class="w">  </span><span class="k">CONTINUE</span><span class="w"> 
   </span><span class="mi">61</span><span class="w">  </span><span class="k">CONTINUE</span><span class="w">      
</span><span class="n">C</span><span class="w"> 
</span><span class="n">C</span><span class="w"> </span><span class="n">FIFTH</span><span class="w"> </span><span class="n">GENERATION</span><span class="w"> </span><span class="n">FLUORESCENCE</span><span class="w">
       </span><span class="k">IF</span><span class="p">(</span><span class="n">IFLSUM4</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="ow">.EQ.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">     
</span><span class="n">C</span><span class="w"> </span><span class="n">ZERO</span><span class="w"> </span><span class="n">COUNTER</span><span class="w">
         </span><span class="n">L5</span><span class="o">=</span><span class="mi">0</span><span class="w">
         </span><span class="k">CALL</span><span class="w"> </span><span class="n">CSSTFB5</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L5</span><span class="p">,</span><span class="n">DIST</span><span class="p">)</span><span class="w">
         </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">51</span><span class="w">
        </span><span class="k">ENDIF</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">LOOP</span><span class="w"> </span><span class="n">AROUND</span><span class="w"> </span><span class="n">FIFTH</span><span class="w"> </span><span class="n">GEN</span><span class="w"> </span><span class="n">FLUORESCENCE</span><span class="w">
       </span><span class="n">IFL5</span><span class="o">=</span><span class="n">IFLSUM5</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="w">
       </span><span class="k">DO</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="n">L5</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">IFL5</span><span class="w">
       </span><span class="n">EPH</span><span class="o">=</span><span class="n">EPHOTG4</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L5</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">CALC</span><span class="w"> </span><span class="n">ABSORPTION</span><span class="w"> </span><span class="n">POSITION</span><span class="w"> </span><span class="n">X5</span><span class="p">,</span><span class="n">Y5</span><span class="p">,</span><span class="n">Z5</span><span class="w"> </span><span class="n">FOR</span><span class="w"> </span><span class="n">FLUORESENCE</span><span class="w"> </span><span class="n">PHOTON</span><span class="w"> </span><span class="n">OF</span><span class="w"> </span><span class="n">ENERGY</span><span class="w"> </span><span class="n">EPH</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">WITH</span><span class="w"> </span><span class="n">ABSORPTION</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">SHELL</span><span class="w"> </span><span class="n">ISHELL5</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">GAS</span><span class="w"> </span><span class="n">KGAS5</span><span class="w"> </span><span class="n">COMPONENT</span><span class="w"> </span><span class="n">LGAS5</span><span class="w">
       </span><span class="k">CALL</span><span class="w"> </span><span class="n">ABSO</span><span class="p">(</span><span class="n">ISECOND</span><span class="p">,</span><span class="n">EPH</span><span class="p">,</span><span class="n">ISHELL5</span><span class="p">,</span><span class="n">KGAS5</span><span class="p">,</span><span class="n">LGAS5</span><span class="p">,</span><span class="n">DIST5</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">LOW</span><span class="w"> </span><span class="n">ENERGY</span><span class="w"> </span><span class="n">PHOTON</span><span class="w">
       </span><span class="k">IF</span><span class="p">(</span><span class="n">ISHELL5</span><span class="ow">.EQ.</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">5</span><span class="w">
</span><span class="n">C</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">CALCULATE</span><span class="w"> </span><span class="n">CASCADE</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">GAS</span><span class="w"> 
       </span><span class="k">CALL</span><span class="w"> </span><span class="n">CALCB5</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">KGAS5</span><span class="p">,</span><span class="n">LGAS5</span><span class="p">,</span><span class="n">EPH</span><span class="p">,</span><span class="n">ISHELL5</span><span class="p">,</span><span class="n">L5</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">STORE</span><span class="w"> </span><span class="n">EVENT</span><span class="w">
       </span><span class="k">CALL</span><span class="w"> </span><span class="n">CSSTFB5</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L5</span><span class="p">,</span><span class="n">DIST5</span><span class="p">)</span><span class="w">               
       </span><span class="k">IF</span><span class="p">(</span><span class="n">IFLSUM5</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="ow">.GE.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">89</span><span class="p">)</span><span class="w"> </span><span class="n">IFLSUM5</span><span class="w">
   </span><span class="mi">89</span><span class="w">  </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">' WARNING SIXTH GENERATION EXISTS IFLSUM5='</span><span class="p">,</span><span class="l">I3</span><span class="p">)</span><span class="w">
    </span><span class="mi">5</span><span class="w">  </span><span class="k">CONTINUE</span><span class="w">
   </span><span class="mi">51</span><span class="w">  </span><span class="k">CONTINUE</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w">
   </span><span class="mi">10</span><span class="w"> </span><span class="k">CONTINUE</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="k">IF</span><span class="p">(</span><span class="n">IDBG</span><span class="ow">.EQ.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="k">DO</span><span class="w"> </span><span class="mi">666</span><span class="w"> </span><span class="n">KKK</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NVAC</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">777</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">ESTORE</span><span class="p">(</span><span class="n">KKK</span><span class="p">,</span><span class="n">K</span><span class="p">),</span><span class="n">K</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="mi">777</span><span class="w"> </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">' ESTORE='</span><span class="p">,</span><span class="l">4</span><span class="p">(</span><span class="l">7D12.4</span><span class="p">,</span><span class="l">/</span><span class="p">))</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">778</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">ESTOR1</span><span class="p">(</span><span class="n">KKK</span><span class="p">,</span><span class="n">K</span><span class="p">),</span><span class="n">K</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="mi">778</span><span class="w"> </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">' ESTOR1='</span><span class="p">,</span><span class="l">4</span><span class="p">(</span><span class="l">7D12.4</span><span class="p">,</span><span class="l">/</span><span class="p">))</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">779</span><span class="p">)</span><span class="w"> </span><span class="n">IONSUM</span><span class="p">(</span><span class="n">KKK</span><span class="p">),</span><span class="n">IONSUM1</span><span class="p">(</span><span class="n">KKK</span><span class="p">),</span><span class="n">IONSUM2</span><span class="p">(</span><span class="n">KKK</span><span class="p">),</span><span class="n">IONSUM3</span><span class="p">(</span><span class="n">KKK</span><span class="p">),</span><span class="w">
</span><span class="n">C</span><span class="w">    </span><span class="p">/</span><span class="n">IONSUM4</span><span class="p">(</span><span class="n">KKK</span><span class="p">),</span><span class="n">IONSUM5</span><span class="p">(</span><span class="n">KKK</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="mi">779</span><span class="w"> </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">' IONSUM 0-5='</span><span class="p">,</span><span class="l">6I4</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">780</span><span class="p">)</span><span class="w"> </span><span class="n">IFLSUM</span><span class="p">(</span><span class="n">KKK</span><span class="p">),</span><span class="n">IFLSUM1</span><span class="p">(</span><span class="n">KKK</span><span class="p">),</span><span class="n">IFLSUM2</span><span class="p">(</span><span class="n">KKK</span><span class="p">),</span><span class="n">IFLSUM3</span><span class="p">(</span><span class="n">KKK</span><span class="p">),</span><span class="w">
</span><span class="n">C</span><span class="w">    </span><span class="p">/</span><span class="n">IFLSUM4</span><span class="p">(</span><span class="n">KKK</span><span class="p">),</span><span class="n">IFLSUM5</span><span class="p">(</span><span class="n">KKK</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="mi">780</span><span class="w"> </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">' IFLSUM 0-5='</span><span class="p">,</span><span class="l">6I4</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="mi">666</span><span class="w"> </span><span class="k">CONTINUE</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="k">ENDIF</span><span class="w">
      </span><span class="k">RETURN</span><span class="w"> 
      </span><span class="k">END</span><span class="w">

</span></code></pre>