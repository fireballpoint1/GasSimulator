<h2 id='montefe'>MONTEFE()</h2>
<ul>
<li>Tracks <code>DELTA</code> electrons and updates arrays containing position and time of thermalised electrons.</li>
<li>Calculates number of produced electrons per primary and other higher FANO factors.</li>
<li>Range accurate for anisotropic X-Sections</li>
</ul>
<h3 id='arguments'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>NONE</td>
<td>-</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id='pseudo-code'>Pseudo-Code</h3><pre class="highlight fortran tab-fortran"><code><span class="w">      </span><span class="k">SUBROUTINE</span><span class="w"> </span><span class="n">MONTEFE</span><span class="w">                                                
      </span><span class="k">IMPLICIT</span><span class="w"> </span><span class="kt">REAL</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="n">H</span><span class="p">,</span><span class="n">O</span><span class="o">-</span><span class="n">Z</span><span class="p">)</span><span class="w">
      </span><span class="k">IMPLICIT</span><span class="w"> </span><span class="kt">INTEGER</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="n">N</span><span class="p">)</span><span class="w">                                         
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">INPT</span><span class="p">/</span><span class="n">NGAS</span><span class="p">,</span><span class="n">NSTEP</span><span class="p">,</span><span class="n">NANISO</span><span class="p">,</span><span class="n">EFINAL</span><span class="p">,</span><span class="n">ESTEP</span><span class="p">,</span><span class="n">AKT</span><span class="p">,</span><span class="n">ARY</span><span class="p">,</span><span class="n">TEMPC</span><span class="p">,</span><span class="n">TORR</span><span class="p">,</span><span class="n">IPEN</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">INPT1</span><span class="p">/</span><span class="n">NDVEC</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">CNSTS1</span><span class="p">/</span><span class="n">CONST1</span><span class="p">,</span><span class="n">CONST2</span><span class="p">,</span><span class="n">CONST3</span><span class="p">,</span><span class="n">CONST4</span><span class="p">,</span><span class="n">CONST5</span><span class="w">                  
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">SETP</span><span class="p">/</span><span class="n">TMAX</span><span class="p">,</span><span class="n">SMALL</span><span class="p">,</span><span class="n">API</span><span class="p">,</span><span class="n">ESTART</span><span class="p">,</span><span class="n">THETA</span><span class="p">,</span><span class="n">PHI</span><span class="p">,</span><span class="n">TCFMAX</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">TCFMAX1</span><span class="p">,</span><span class="w">
     </span><span class="p">/</span><span class="n">RSTART</span><span class="p">,</span><span class="n">EFIELD</span><span class="p">,</span><span class="n">ETHRM</span><span class="p">,</span><span class="n">ECUT</span><span class="p">,</span><span class="n">NDELTA</span><span class="p">,</span><span class="n">IMIP</span><span class="p">,</span><span class="n">IWRITE</span><span class="w">                    
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">LARGE</span><span class="p">/</span><span class="n">CF</span><span class="p">(</span><span class="mi">20000</span><span class="p">,</span><span class="mi">512</span><span class="p">),</span><span class="n">EIN</span><span class="p">(</span><span class="mi">512</span><span class="p">),</span><span class="n">TCF</span><span class="p">(</span><span class="mi">20000</span><span class="p">),</span><span class="n">IARRY</span><span class="p">(</span><span class="mi">512</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">RGAS</span><span class="p">(</span><span class="mi">512</span><span class="p">),</span><span class="n">IPN</span><span class="p">(</span><span class="mi">512</span><span class="p">),</span><span class="n">WPL</span><span class="p">(</span><span class="mi">512</span><span class="p">),</span><span class="n">IZBR</span><span class="p">(</span><span class="mi">512</span><span class="p">),</span><span class="n">IPLAST</span><span class="p">,</span><span class="n">PENFRA</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">512</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">LARGEN</span><span class="p">/</span><span class="n">CFN</span><span class="p">(</span><span class="mi">20000</span><span class="p">,</span><span class="mi">60</span><span class="p">),</span><span class="n">TCFN</span><span class="p">(</span><span class="mi">20000</span><span class="p">),</span><span class="n">SCLENUL</span><span class="p">(</span><span class="mi">60</span><span class="p">),</span><span class="n">NPLAST</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">OUTPT</span><span class="p">/</span><span class="n">ICOLL</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span><span class="n">NETOT</span><span class="p">,</span><span class="n">NPRIME</span><span class="p">,</span><span class="n">TMAX1</span><span class="p">,</span><span class="n">TIME</span><span class="p">(</span><span class="mi">300</span><span class="p">),</span><span class="n">NNULL</span><span class="p">,</span><span class="w">
     </span><span class="p">/</span><span class="n">NITOT</span><span class="p">,</span><span class="n">ICOLN</span><span class="p">(</span><span class="mi">512</span><span class="p">),</span><span class="n">ICOLNN</span><span class="p">(</span><span class="mi">60</span><span class="p">),</span><span class="n">NREAL</span><span class="p">,</span><span class="n">NEXCTOT</span><span class="w"> 
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">RLTVY</span><span class="p">/</span><span class="n">BET</span><span class="p">(</span><span class="mi">20000</span><span class="p">),</span><span class="n">GAM</span><span class="p">(</span><span class="mi">20000</span><span class="p">),</span><span class="n">VC</span><span class="p">,</span><span class="n">EMS</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">STTS</span><span class="p">/</span><span class="n">XST</span><span class="p">(</span><span class="mi">150000</span><span class="p">),</span><span class="n">YST</span><span class="p">(</span><span class="mi">150000</span><span class="p">),</span><span class="n">ZST</span><span class="p">(</span><span class="mi">150000</span><span class="p">),</span><span class="n">TST</span><span class="p">(</span><span class="mi">150000</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">TTIME</span><span class="p">(</span><span class="mi">150000</span><span class="p">),</span><span class="n">NFGF</span><span class="p">(</span><span class="mi">150000</span><span class="p">),</span><span class="n">NFGPP</span><span class="p">(</span><span class="mi">150000</span><span class="p">),</span><span class="n">NFGBR</span><span class="p">(</span><span class="mi">150000</span><span class="p">),</span><span class="n">NELEC</span><span class="p">,</span><span class="w">
     </span><span class="p">/</span><span class="n">NEGION</span><span class="p">,</span><span class="n">EST1</span><span class="p">,</span><span class="n">EST2</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">STEXC</span><span class="p">/</span><span class="n">XSTEXC</span><span class="p">(</span><span class="mi">150000</span><span class="p">),</span><span class="n">YSTEXC</span><span class="p">(</span><span class="mi">150000</span><span class="p">),</span><span class="n">ZSTEXC</span><span class="p">(</span><span class="mi">150000</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">TSTEXC</span><span class="p">(</span><span class="mi">150000</span><span class="p">),</span><span class="n">NSTEXC</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">STEXCNUL</span><span class="p">/</span><span class="n">XSTN</span><span class="p">(</span><span class="mi">150000</span><span class="p">),</span><span class="n">YSTN</span><span class="p">(</span><span class="mi">150000</span><span class="p">),</span><span class="n">ZSTN</span><span class="p">(</span><span class="mi">150000</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">TSTN</span><span class="p">(</span><span class="mi">150000</span><span class="p">),</span><span class="n">IDNUL</span><span class="p">(</span><span class="mi">150000</span><span class="p">),</span><span class="n">NEXCNUL</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">IONC</span><span class="p">/</span><span class="kt">DOUBLE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">20000</span><span class="p">),</span><span class="n">CMINIXSC</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">CMINEXSC</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">ECLOSS</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">WPLN</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">ICOUNT</span><span class="p">,</span><span class="n">AVPFRAC</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="w"> 
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">IONFL</span><span class="p">/</span><span class="n">NC0</span><span class="p">(</span><span class="mi">512</span><span class="p">),</span><span class="n">EC0</span><span class="p">(</span><span class="mi">512</span><span class="p">),</span><span class="n">NG1</span><span class="p">(</span><span class="mi">512</span><span class="p">),</span><span class="n">EG1</span><span class="p">(</span><span class="mi">512</span><span class="p">),</span><span class="n">NG2</span><span class="p">(</span><span class="mi">512</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">EG2</span><span class="p">(</span><span class="mi">512</span><span class="p">),</span><span class="n">WKLM</span><span class="p">(</span><span class="mi">512</span><span class="p">),</span><span class="n">DSTFL</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">IONMOD</span><span class="p">/</span><span class="n">ESPLIT</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span><span class="n">IONMODEL</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">ANIS</span><span class="p">/</span><span class="n">PSCT</span><span class="p">(</span><span class="mi">20000</span><span class="p">,</span><span class="mi">512</span><span class="p">),</span><span class="n">ANGCT</span><span class="p">(</span><span class="mi">20000</span><span class="p">,</span><span class="mi">512</span><span class="p">),</span><span class="nb">INDEX</span><span class="p">(</span><span class="mi">512</span><span class="p">),</span><span class="n">NISO</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">CASRS</span><span class="p">/</span><span class="n">ECAS</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span><span class="n">XCAS</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span><span class="n">YCAS</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span><span class="n">ZCAS</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span><span class="n">DRXS</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRYS</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span><span class="n">DRZS</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span><span class="n">TT1</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span><span class="n">NFLGF</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span><span class="n">NFLGPP</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span><span class="n">IEVNTL</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">COMP</span><span class="p">/</span><span class="n">LCMP</span><span class="p">,</span><span class="n">LCFLG</span><span class="p">,</span><span class="n">LRAY</span><span class="p">,</span><span class="n">LRFLG</span><span class="p">,</span><span class="n">LPAP</span><span class="p">,</span><span class="n">LPFLG</span><span class="p">,</span><span class="n">LBRM</span><span class="p">,</span><span class="n">LBFLG</span><span class="p">,</span><span class="n">LPEFLG</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">BREMG</span><span class="p">/</span><span class="n">EBRGAM</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">BRDCOSX</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">BRDCOSY</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">BRDCOSZ</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">BRX</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">BRY</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">BRZ</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">BRT</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">EBRTOT</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">NBREM</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">CASRSB</span><span class="p">/</span><span class="n">ECASB</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span><span class="n">XCASB</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span><span class="n">YCASB</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span><span class="n">ZCASB</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRXB</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span><span class="n">DRYB</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span><span class="n">DRZB</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span><span class="n">TTB1</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span><span class="n">NFLGFB</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span><span class="n">NFLGPPB</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">IEVNTLB</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">CASRSE</span><span class="p">/</span><span class="n">ECASE</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span><span class="n">XCASE</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span><span class="n">YCASE</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span><span class="n">ZCASE</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRXCE</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span><span class="n">DRYCE</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span><span class="n">DRZCE</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span><span class="n">TCASE</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">NFLGFE</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span><span class="n">NFLGPPE</span><span class="p">(</span><span class="mi">400</span><span class="p">),</span><span class="n">IEVENTE</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">ECASC</span><span class="p">/</span><span class="n">NEGAS</span><span class="p">(</span><span class="mi">512</span><span class="p">),</span><span class="n">LEGAS</span><span class="p">(</span><span class="mi">512</span><span class="p">),</span><span class="n">IESHELL</span><span class="p">(</span><span class="mi">512</span><span class="p">),</span><span class="n">IECASC</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">IDEXC</span><span class="p">/</span><span class="n">NGEXC1</span><span class="p">,</span><span class="n">NGEXC2</span><span class="p">,</span><span class="n">NGEXC3</span><span class="p">,</span><span class="n">NGEXC4</span><span class="p">,</span><span class="n">NGEXC5</span><span class="p">,</span><span class="n">NGEXC6</span><span class="p">,</span><span class="w">
     </span><span class="p">/</span><span class="n">IDG1</span><span class="p">,</span><span class="n">IDG2</span><span class="p">,</span><span class="n">IDG3</span><span class="p">,</span><span class="n">IDG4</span><span class="p">,</span><span class="n">IDG5</span><span class="p">,</span><span class="n">IDG6</span><span class="w">
      </span><span class="k">DIMENSION</span><span class="w"> </span><span class="n">XS</span><span class="p">(</span><span class="mi">150000</span><span class="p">),</span><span class="n">YS</span><span class="p">(</span><span class="mi">150000</span><span class="p">),</span><span class="n">ZS</span><span class="p">(</span><span class="mi">150000</span><span class="p">),</span><span class="n">TS</span><span class="p">(</span><span class="mi">150000</span><span class="p">),</span><span class="n">ES</span><span class="p">(</span><span class="mi">150000</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DCX</span><span class="p">(</span><span class="mi">150000</span><span class="p">),</span><span class="n">DCY</span><span class="p">(</span><span class="mi">150000</span><span class="p">),</span><span class="n">DCZ</span><span class="p">(</span><span class="mi">150000</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">NFLGFC</span><span class="p">(</span><span class="mi">150000</span><span class="p">),</span><span class="n">NFLGPPC</span><span class="p">(</span><span class="mi">150000</span><span class="p">),</span><span class="n">NFLGBRMC</span><span class="p">(</span><span class="mi">150000</span><span class="p">)</span><span class="w">
      </span><span class="k">DIMENSION</span><span class="w"> </span><span class="n">TEMP</span><span class="p">(</span><span class="mi">20000</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="k">DIMENSION</span><span class="w"> </span><span class="n">ETEMP</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="o">----------------------------------------------------------------------</span><span class="w">
</span><span class="n">C</span><span class="w">      </span><span class="n">RELATIVISTIC</span><span class="w"> </span><span class="n">VERSION</span><span class="w"> </span><span class="n">SEPTEMBER</span><span class="w"> </span><span class="mi">2013</span><span class="w">
</span><span class="n">C</span><span class="w">      </span><span class="n">ELECTRIC</span><span class="w"> </span><span class="n">FIELD</span><span class="w"> </span><span class="n">ALONG</span><span class="w"> </span><span class="n">Z</span><span class="w"> </span><span class="n">AXIS</span><span class="err">.</span><span class="w"> </span><span class="n">NO</span><span class="w"> </span><span class="n">MAGNETIC</span><span class="w"> </span><span class="n">FIELD</span><span class="err">.</span><span class="w"> 
</span><span class="n">C</span><span class="w">      </span><span class="n">TRACKS</span><span class="w"> </span><span class="n">DELTA</span><span class="w"> </span><span class="n">ELECTRONS</span><span class="w"> </span><span class="n">AND</span><span class="w"> </span><span class="n">UPDATES</span><span class="w"> </span><span class="n">ARRAYS</span><span class="w"> </span><span class="n">CONTAINING</span><span class="w"> </span><span class="n">POSITION</span><span class="w"> </span><span class="n">AND</span><span class="w">
</span><span class="n">C</span><span class="w">      </span><span class="n">TIME</span><span class="w"> </span><span class="n">OF</span><span class="w"> </span><span class="n">THERMALISED</span><span class="w"> </span><span class="n">ELECTRONS</span><span class="err">.</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="n">CALCULATES</span><span class="w"> </span><span class="n">NUMBER</span><span class="w"> </span><span class="n">OF</span><span class="w"> </span><span class="n">PRODUCED</span><span class="w"> </span><span class="n">ELECTRONS</span><span class="w"> </span><span class="n">PER</span><span class="w"> </span><span class="n">PRIMARY</span><span class="w"> </span><span class="n">AND</span><span class="w"> </span><span class="n">OTHER</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="n">HIGHER</span><span class="w"> </span><span class="n">FANO</span><span class="w"> </span><span class="n">FACTORS</span><span class="err">.</span><span class="w"> 
</span><span class="n">C</span><span class="w">     </span><span class="nb">RANGE</span><span class="w"> </span><span class="n">IS</span><span class="w"> </span><span class="n">ACCURATE</span><span class="w"> </span><span class="k">ONLY</span><span class="w"> </span><span class="n">FOR</span><span class="w"> </span><span class="n">ANISOTROPIC</span><span class="w"> </span><span class="n">X</span><span class="o">-</span><span class="n">SECTIONS</span><span class="w">              
</span><span class="n">C</span><span class="w"> </span><span class="o">----------------------------------------------------------------------</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">VARYING</span><span class="w"> </span><span class="n">ENERGY</span><span class="w"> </span><span class="n">STEPS</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">EFINAL</span><span class="ow">.LE.</span><span class="mf">140000.</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
        </span><span class="n">ESTEP1</span><span class="o">=</span><span class="p">(</span><span class="n">EFINAL</span><span class="mf">-16000.0</span><span class="p">)/</span><span class="n">DFLOAT</span><span class="p">(</span><span class="mi">4000</span><span class="p">)</span><span class="w">
      </span><span class="k">ELSE</span><span class="w">
        </span><span class="n">ESTEP1</span><span class="o">=</span><span class="mf">20.0</span><span class="w">
        </span><span class="n">ESTEP2</span><span class="o">=</span><span class="p">(</span><span class="n">EFINAL</span><span class="mf">-92000.0</span><span class="p">)/</span><span class="n">DFLOAT</span><span class="p">(</span><span class="mi">4000</span><span class="p">)</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w">
      </span><span class="n">NPRINT</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">J20000</span><span class="o">=</span><span class="mi">20000</span><span class="w"> 
      </span><span class="n">J300</span><span class="o">=</span><span class="mi">300</span><span class="w">
      </span><span class="n">API</span><span class="o">=</span><span class="n">DACOS</span><span class="p">(</span><span class="mf">-1.0D0</span><span class="p">)</span><span class="w">
      </span><span class="n">SMALL</span><span class="o">=</span><span class="mf">1.0D-20</span><span class="w">                                                     
      </span><span class="n">TMAX1</span><span class="o">=</span><span class="mf">0.0D0</span><span class="w"> 
      </span><span class="n">EMAX</span><span class="o">=</span><span class="mf">0.0D0</span><span class="w">                                                      
      </span><span class="n">RDUM</span><span class="o">=</span><span class="n">RSTART</span><span class="w">                                                       
      </span><span class="n">CONST9</span><span class="o">=</span><span class="n">CONST3</span><span class="o">*</span><span class="mf">0.01D0</span><span class="w">
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">300</span><span class="w">
   </span><span class="mi">25</span><span class="w"> </span><span class="n">TIME</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0D0</span><span class="w">
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">26</span><span class="w"> </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">30</span><span class="w">
   </span><span class="mi">26</span><span class="w"> </span><span class="n">ICOLL</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">27</span><span class="w"> </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">512</span><span class="w">
   </span><span class="mi">27</span><span class="w"> </span><span class="n">ICOLN</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NREAL</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NNULL</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NETOT</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NEXCTOT</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NITOT</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NMXADD</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NTMPFLG</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">BP</span><span class="o">=</span><span class="n">EFIELD</span><span class="o">*</span><span class="n">EFIELD</span><span class="o">*</span><span class="n">CONST1</span><span class="w">                                           
      </span><span class="n">F1</span><span class="o">=</span><span class="n">EFIELD</span><span class="o">*</span><span class="n">CONST2</span><span class="w">                                                  
      </span><span class="n">F2</span><span class="o">=</span><span class="n">EFIELD</span><span class="o">*</span><span class="n">CONST3</span><span class="w">                                                  
      </span><span class="n">F4</span><span class="o">=</span><span class="mf">2.0D0</span><span class="o">*</span><span class="n">API</span><span class="w">
      </span><span class="n">THETA1</span><span class="o">=</span><span class="n">THETA</span><span class="w">
      </span><span class="n">PHI1</span><span class="o">=</span><span class="n">PHI</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">CALCULATE</span><span class="w"> </span><span class="n">MAXIMUM</span><span class="w"> </span><span class="n">COLLISION</span><span class="w"> </span><span class="n">FREQUENCY</span><span class="w">    
      </span><span class="n">TLIM</span><span class="o">=</span><span class="mf">0.0</span><span class="w"> 
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">111</span><span class="w"> </span><span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">20000</span><span class="w"> 
      </span><span class="n">TEMP</span><span class="p">(</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">TCFN</span><span class="p">(</span><span class="n">J</span><span class="p">)</span><span class="o">+</span><span class="n">TCF</span><span class="p">(</span><span class="n">J</span><span class="p">)</span><span class="w"> 
      </span><span class="k">IF</span><span class="p">(</span><span class="n">TLIM</span><span class="ow">.LT.</span><span class="n">TEMP</span><span class="p">(</span><span class="n">J</span><span class="p">))</span><span class="w"> </span><span class="n">TLIM</span><span class="o">=</span><span class="n">TEMP</span><span class="p">(</span><span class="n">J</span><span class="p">)</span><span class="w"> 
  </span><span class="mi">111</span><span class="w"> </span><span class="k">CONTINUE</span><span class="w">
      </span><span class="n">NEOVFL</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">J1</span><span class="o">=</span><span class="mi">0</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">START</span><span class="w"> </span><span class="n">OF</span><span class="w"> </span><span class="n">PRIMARY</span><span class="w"> </span><span class="n">EVENT</span><span class="w"> </span><span class="n">LOOP</span><span class="w"> 
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">210</span><span class="w"> </span><span class="n">J11</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NDELTA</span><span class="w">
      </span><span class="n">J1</span><span class="o">=</span><span class="n">J1</span><span class="mi">+1</span><span class="w">
      </span><span class="n">NPRIME</span><span class="o">=</span><span class="n">J1</span><span class="w">
      </span><span class="n">NGEXC1</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NGEXC2</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NGEXC3</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NGEXC4</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NGEXC5</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NGEXC6</span><span class="o">=</span><span class="mi">0</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="n">INITIAL</span><span class="w"> </span><span class="n">DIRECTION</span><span class="w"> </span><span class="n">COSINES</span><span class="w"> </span><span class="n">FOR</span><span class="w"> </span><span class="n">ELECTRON</span><span class="w"> </span><span class="n">BEAM</span><span class="w">                    
      </span><span class="n">DCZ1</span><span class="o">=</span><span class="n">DCOS</span><span class="p">(</span><span class="n">THETA1</span><span class="p">)</span><span class="w">
      </span><span class="n">DCX1</span><span class="o">=</span><span class="n">DSIN</span><span class="p">(</span><span class="n">THETA1</span><span class="p">)</span><span class="o">*</span><span class="n">DCOS</span><span class="p">(</span><span class="n">PHI1</span><span class="p">)</span><span class="w">                                      
      </span><span class="n">DCY1</span><span class="o">=</span><span class="n">DSIN</span><span class="p">(</span><span class="n">THETA1</span><span class="p">)</span><span class="o">*</span><span class="n">DSIN</span><span class="p">(</span><span class="n">PHI1</span><span class="p">)</span><span class="w">
      </span><span class="n">NFLGFF</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NFLGPPP</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NFLGBRMM</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NFLGHIGH</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">EST1</span><span class="o">=</span><span class="n">ESTART</span><span class="w">
      </span><span class="n">E1</span><span class="o">=</span><span class="n">ESTART</span><span class="w">
      </span><span class="n">X</span><span class="o">=</span><span class="mf">0.0D0</span><span class="w">
      </span><span class="n">Y</span><span class="o">=</span><span class="mf">0.0D0</span><span class="w">
      </span><span class="n">Z</span><span class="o">=</span><span class="mf">0.0D0</span><span class="w">
      </span><span class="n">K1</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">KEXC</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NSTEXC</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NEXCNUL</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NCLUS</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NELEC</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NEGION</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">TLAST</span><span class="o">=</span><span class="mf">0.0D0</span><span class="w">
      </span><span class="n">ST</span><span class="o">=</span><span class="mf">0.0D0</span><span class="w">
      </span><span class="n">TDASH</span><span class="o">=</span><span class="mf">0.0D0</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">IMIP</span><span class="ow">.EQ.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">1</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">IMIP</span><span class="ow">.GT.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">READIN</span><span class="w"> </span><span class="n">FIRST</span><span class="w"> </span><span class="n">ELECTRON</span><span class="w"> </span><span class="n">FROM</span><span class="w"> </span><span class="n">BETA</span><span class="w"> </span><span class="n">DECAY</span><span class="w"> </span><span class="n">OR</span><span class="w"> </span><span class="n">XRAY</span><span class="w"> </span><span class="n">UNTHERMALISED</span><span class="w"> </span><span class="n">CLUSTERS</span><span class="w">
       </span><span class="k">CALL</span><span class="w"> </span><span class="n">CASRES</span><span class="p">(</span><span class="n">J11</span><span class="p">,</span><span class="n">IBADTOT</span><span class="p">,</span><span class="n">IBAD1</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">  </span><span class="n">SKIP</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="n">BAD</span><span class="w"> </span><span class="n">EVENT</span><span class="w">
       </span><span class="k">IF</span><span class="p">(</span><span class="n">IBAD1</span><span class="ow">.EQ.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
        </span><span class="n">J1</span><span class="o">=</span><span class="n">J1</span><span class="mi">-1</span><span class="w">
        </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">210</span><span class="w">
       </span><span class="k">ENDIF</span><span class="w"> 
      </span><span class="k">ELSE</span><span class="w"> </span><span class="k">IF</span><span class="p">(</span><span class="n">IMIP</span><span class="ow">.EQ.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="k">READ</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">FIRST</span><span class="w"> </span><span class="n">ELECTRON</span><span class="w"> </span><span class="n">FROM</span><span class="w"> </span><span class="n">MIP</span><span class="w"> </span><span class="n">INTERACTION</span><span class="w">
        </span><span class="k">CALL</span><span class="w"> </span><span class="n">CASREM</span><span class="p">(</span><span class="n">J11</span><span class="p">)</span><span class="w">
        </span><span class="n">EST1</span><span class="o">=</span><span class="n">ECAS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">
        </span><span class="n">EST2</span><span class="o">=</span><span class="n">EST1</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w">
      </span><span class="n">X</span><span class="o">=</span><span class="n">XCAS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">
      </span><span class="n">Y</span><span class="o">=</span><span class="n">YCAS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">
      </span><span class="n">Z</span><span class="o">=</span><span class="n">ZCAS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">
      </span><span class="n">ST</span><span class="o">=</span><span class="n">TT1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">
      </span><span class="n">TS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">TT1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">
      </span><span class="n">E1</span><span class="o">=</span><span class="n">ECAS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">
      </span><span class="n">DCZ1</span><span class="o">=</span><span class="n">DRZS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">
      </span><span class="n">DCY1</span><span class="o">=</span><span class="n">DRYS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">
      </span><span class="n">DCX1</span><span class="o">=</span><span class="n">DRXS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">
      </span><span class="n">NFLGFF</span><span class="o">=</span><span class="n">NFLGF</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">
      </span><span class="n">NFLGPPP</span><span class="o">=</span><span class="n">NFLGPP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">
      </span><span class="n">NFLGBRMM</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NFLGHIGH</span><span class="o">=</span><span class="n">NFLGFF</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">PUT</span><span class="w"> </span><span class="n">REMAINDER</span><span class="w"> </span><span class="n">OF</span><span class="w"> </span><span class="n">ELECTRONS</span><span class="w"> </span><span class="n">INTO</span><span class="w"> </span><span class="n">CLUSTER</span><span class="w"> </span><span class="n">STORE</span><span class="w">
      </span><span class="n">ISDUM</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">35</span><span class="w"> </span><span class="n">IST</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">IEVNTL</span><span class="w">
      </span><span class="n">ISDUM</span><span class="o">=</span><span class="n">ISDUM</span><span class="mi">+1</span><span class="w">
      </span><span class="n">XS</span><span class="p">(</span><span class="n">ISDUM</span><span class="p">)</span><span class="o">=</span><span class="n">XCAS</span><span class="p">(</span><span class="n">IST</span><span class="p">)</span><span class="w">
      </span><span class="n">YS</span><span class="p">(</span><span class="n">ISDUM</span><span class="p">)</span><span class="o">=</span><span class="n">YCAS</span><span class="p">(</span><span class="n">IST</span><span class="p">)</span><span class="w">
      </span><span class="n">ZS</span><span class="p">(</span><span class="n">ISDUM</span><span class="p">)</span><span class="o">=</span><span class="n">ZCAS</span><span class="p">(</span><span class="n">IST</span><span class="p">)</span><span class="w">
      </span><span class="n">TS</span><span class="p">(</span><span class="n">ISDUM</span><span class="p">)</span><span class="o">=</span><span class="n">TT1</span><span class="p">(</span><span class="n">IST</span><span class="p">)</span><span class="w">
      </span><span class="n">ES</span><span class="p">(</span><span class="n">ISDUM</span><span class="p">)</span><span class="o">=</span><span class="n">ECAS</span><span class="p">(</span><span class="n">IST</span><span class="p">)</span><span class="w">
      </span><span class="n">DCX</span><span class="p">(</span><span class="n">ISDUM</span><span class="p">)</span><span class="o">=</span><span class="n">DRXS</span><span class="p">(</span><span class="n">IST</span><span class="p">)</span><span class="w">
      </span><span class="n">DCY</span><span class="p">(</span><span class="n">ISDUM</span><span class="p">)</span><span class="o">=</span><span class="n">DRYS</span><span class="p">(</span><span class="n">IST</span><span class="p">)</span><span class="w">
      </span><span class="n">DCZ</span><span class="p">(</span><span class="n">ISDUM</span><span class="p">)</span><span class="o">=</span><span class="n">DRZS</span><span class="p">(</span><span class="n">IST</span><span class="p">)</span><span class="w">
      </span><span class="n">NFLGFC</span><span class="p">(</span><span class="n">ISDUM</span><span class="p">)</span><span class="o">=</span><span class="n">NFLGF</span><span class="p">(</span><span class="n">IST</span><span class="p">)</span><span class="w">
      </span><span class="n">NFLGPPC</span><span class="p">(</span><span class="n">ISDUM</span><span class="p">)</span><span class="o">=</span><span class="n">NFLGPP</span><span class="p">(</span><span class="n">IST</span><span class="p">)</span><span class="w">
      </span><span class="n">NFLGBRMC</span><span class="p">(</span><span class="n">ISDUM</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">NCLUS</span><span class="o">=</span><span class="n">ISDUM</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">NFLGF</span><span class="p">(</span><span class="n">IST</span><span class="p">)</span><span class="ow">.GT.</span><span class="n">NFLGHIGH</span><span class="p">)</span><span class="w"> </span><span class="n">NFLGHIGH</span><span class="o">=</span><span class="n">NFLGF</span><span class="p">(</span><span class="n">IST</span><span class="p">)</span><span class="w">
   </span><span class="mi">35</span><span class="w"> </span><span class="k">CONTINUE</span><span class="w">

</span><span class="n">C</span><span class="w"> </span><span class="n">START</span><span class="w"> </span><span class="n">OF</span><span class="w"> </span><span class="n">LOOP</span><span class="w"> </span><span class="n">FOR</span><span class="w"> </span><span class="n">NEWLY</span><span class="w"> </span><span class="n">CREATED</span><span class="w"> </span><span class="n">ELECTRONS</span><span class="w">
    </span><span class="mi">1</span><span class="w"> </span><span class="k">CONTINUE</span><span class="w">                                                          
      </span><span class="n">R1</span><span class="o">=</span><span class="n">drand48</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span><span class="w">
      </span><span class="n">T</span><span class="o">=-</span><span class="n">DLOG</span><span class="p">(</span><span class="n">R1</span><span class="p">)/</span><span class="n">TLIM</span><span class="o">+</span><span class="n">TDASH</span><span class="w">
      </span><span class="n">TDASH</span><span class="o">=</span><span class="n">T</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="n">AP</span><span class="o">=</span><span class="n">DCZ1</span><span class="o">*</span><span class="n">F2</span><span class="o">*</span><span class="n">DSQRT</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span><span class="w">
      </span><span class="n">GAM1</span><span class="o">=</span><span class="p">(</span><span class="n">EMS</span><span class="o">+</span><span class="n">E1</span><span class="p">)/</span><span class="n">EMS</span><span class="w">
      </span><span class="n">BET1</span><span class="o">=</span><span class="n">DSQRT</span><span class="p">(</span><span class="mf">1.0D0-1.0D0</span><span class="p">/(</span><span class="n">GAM1</span><span class="o">*</span><span class="n">GAM1</span><span class="p">))</span><span class="w">
      </span><span class="n">AP</span><span class="o">=</span><span class="n">DCZ1</span><span class="o">*</span><span class="n">EFIELD</span><span class="o">*</span><span class="n">BET1</span><span class="o">*</span><span class="n">VC</span><span class="o">*</span><span class="mf">1.0D-10</span><span class="w">
      </span><span class="n">BP1</span><span class="o">=</span><span class="n">BP</span><span class="p">/</span><span class="n">GAM1</span><span class="w">              
      </span><span class="n">E</span><span class="o">=</span><span class="n">E1</span><span class="o">+</span><span class="p">(</span><span class="n">AP</span><span class="o">+</span><span class="n">BP1</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="n">T</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">E</span><span class="ow">.LT.</span><span class="mf">0.0D0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
       </span><span class="n">E</span><span class="o">=</span><span class="mf">0.001D0</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w">    
</span><span class="n">C</span><span class="w"> </span><span class="n">INSERT</span><span class="w"> </span><span class="n">NEW</span><span class="w"> </span><span class="n">ALGORITHM</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">FIND</span><span class="w"> </span><span class="n">IE</span><span class="w"> </span><span class="n">FOR</span><span class="w"> </span><span class="n">VARYING</span><span class="w"> </span><span class="n">ENERGY</span><span class="w"> </span><span class="n">STEP</span><span class="w">          
      </span><span class="k">IF</span><span class="p">(</span><span class="n">IMIP</span><span class="ow">.EQ.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">                                     
       </span><span class="n">IE</span><span class="o">=</span><span class="n">DINT</span><span class="p">(</span><span class="n">E</span><span class="p">/</span><span class="n">ESTEP</span><span class="p">)</span><span class="mi">+1</span><span class="w">                                               
      </span><span class="k">ELSE</span><span class="w">
       </span><span class="k">IF</span><span class="p">(</span><span class="n">EFINAL</span><span class="ow">.LE.</span><span class="mf">20000.</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
        </span><span class="n">IE</span><span class="o">=</span><span class="n">DINT</span><span class="p">(</span><span class="n">E</span><span class="p">/</span><span class="n">ESTEP</span><span class="p">)</span><span class="mi">+1</span><span class="w">
       </span><span class="k">ELSE</span><span class="w"> </span><span class="k">IF</span><span class="p">(</span><span class="n">EFINAL</span><span class="ow">.LE.</span><span class="mf">140000.</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
        </span><span class="k">IF</span><span class="p">(</span><span class="n">E</span><span class="ow">.LE.</span><span class="mf">16000.</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
         </span><span class="n">IE</span><span class="o">=</span><span class="n">DINT</span><span class="p">(</span><span class="n">E</span><span class="p">)</span><span class="mi">+1</span><span class="w">
        </span><span class="k">ELSE</span><span class="w">
         </span><span class="n">IE</span><span class="o">=</span><span class="mi">16000</span><span class="o">+</span><span class="n">DINT</span><span class="p">((</span><span class="n">E</span><span class="mf">-16000.</span><span class="p">)/</span><span class="n">ESTEP1</span><span class="p">)</span><span class="w">
        </span><span class="k">ENDIF</span><span class="w">
       </span><span class="k">ELSE</span><span class="w">
        </span><span class="k">IF</span><span class="p">(</span><span class="n">E</span><span class="ow">.LE.</span><span class="mf">12000.</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
         </span><span class="n">IE</span><span class="o">=</span><span class="n">DINT</span><span class="p">(</span><span class="n">E</span><span class="p">)</span><span class="mi">+1</span><span class="w">
        </span><span class="k">ELSE</span><span class="w"> </span><span class="k">IF</span><span class="p">(</span><span class="n">E</span><span class="ow">.LE.</span><span class="mf">92000.</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
         </span><span class="n">IE</span><span class="o">=</span><span class="mi">12000</span><span class="o">+</span><span class="n">DINT</span><span class="p">((</span><span class="n">E</span><span class="mf">-12000.</span><span class="p">)/</span><span class="n">ESTEP1</span><span class="p">)</span><span class="w">
        </span><span class="k">ELSE</span><span class="w">
         </span><span class="n">IE</span><span class="o">=</span><span class="mi">16000</span><span class="o">+</span><span class="n">DINT</span><span class="p">((</span><span class="n">E</span><span class="mf">-92000.</span><span class="p">)/</span><span class="n">ESTEP2</span><span class="p">)</span><span class="w">
        </span><span class="k">ENDIF</span><span class="w">
       </span><span class="k">ENDIF</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w"> 
      </span><span class="n">IE</span><span class="o">=</span><span class="n">DMIN0</span><span class="p">(</span><span class="n">IE</span><span class="p">,</span><span class="n">J20000</span><span class="p">)</span><span class="w">                                            
</span><span class="n">C</span><span class="w">                                                                       
</span><span class="n">C</span><span class="w">     </span><span class="n">TEST</span><span class="w"> </span><span class="n">FOR</span><span class="w"> </span><span class="kt">REAL</span><span class="w"> </span><span class="n">OR</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="n">COLLISION</span><span class="w">                                   
</span><span class="n">C</span><span class="w">                                                                       
      </span><span class="n">R5</span><span class="o">=</span><span class="n">drand48</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span><span class="w">
      </span><span class="n">TEST1</span><span class="o">=</span><span class="n">TCF</span><span class="p">(</span><span class="n">IE</span><span class="p">)/</span><span class="n">TLIM</span><span class="w">                                               
      </span><span class="k">IF</span><span class="p">(</span><span class="n">R5</span><span class="ow">.LE.</span><span class="n">TEST1</span><span class="p">)</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">137</span><span class="w">                                        
      </span><span class="n">NNULL</span><span class="o">=</span><span class="n">NNULL</span><span class="mi">+1</span><span class="w">                          
      </span><span class="n">TEST2</span><span class="o">=</span><span class="n">TEMP</span><span class="p">(</span><span class="n">IE</span><span class="p">)/</span><span class="n">TLIM</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">R5</span><span class="ow">.LT.</span><span class="n">TEST2</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">TEST</span><span class="w"> </span><span class="n">FOR</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="n">LEVELS</span><span class="w">
       </span><span class="k">IF</span><span class="p">(</span><span class="n">NPLAST</span><span class="ow">.EQ.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">1</span><span class="w">
       </span><span class="n">R2</span><span class="o">=</span><span class="n">drand48</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span><span class="w"> 
       </span><span class="n">I</span><span class="o">=</span><span class="mi">0</span><span class="w">
  </span><span class="mi">888</span><span class="w">  </span><span class="n">I</span><span class="o">=</span><span class="n">I</span><span class="mi">+1</span><span class="w">
       </span><span class="k">IF</span><span class="p">(</span><span class="n">CFN</span><span class="p">(</span><span class="n">IE</span><span class="p">,</span><span class="n">I</span><span class="p">)</span><span class="ow">.LT.</span><span class="n">R2</span><span class="p">)</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">888</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">INCREMENT</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="n">LEVEL</span><span class="w"> </span><span class="nb">SUM</span><span class="w">
       </span><span class="n">NEXCNUL</span><span class="o">=</span><span class="n">NEXCNUL</span><span class="mi">+1</span><span class="w">
       </span><span class="n">ICOLNN</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="n">ICOLNN</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="mi">+1</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">STORE</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="n">Z</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="n">FOR</span><span class="w"> </span><span class="n">MOLECULAR</span><span class="w"> </span><span class="n">LIGHT</span><span class="w"> </span><span class="n">EMISSION</span><span class="w"> </span><span class="n">FROM</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="n">EXCITATION</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">NOTE</span><span class="p">:</span><span class="w">  </span><span class="n">SMALL</span><span class="w"> </span><span class="n">APPROX</span><span class="w"> </span><span class="n">USED</span><span class="w"> </span><span class="n">POSITION</span><span class="w"> </span><span class="n">OF</span><span class="w"> </span><span class="n">PREVIOUS</span><span class="w"> </span><span class="kt">REAL</span><span class="w"> </span><span class="n">COLLISION</span><span class="w">
       </span><span class="n">XSTN</span><span class="p">(</span><span class="n">NEXCNUL</span><span class="p">)</span><span class="o">=</span><span class="n">X</span><span class="w">
       </span><span class="n">YSTN</span><span class="p">(</span><span class="n">NEXCNUL</span><span class="p">)</span><span class="o">=</span><span class="n">Y</span><span class="w">
       </span><span class="n">ZSTN</span><span class="p">(</span><span class="n">NEXCNUL</span><span class="p">)</span><span class="o">=</span><span class="n">Z</span><span class="w">
       </span><span class="n">TSTN</span><span class="p">(</span><span class="n">NEXCNUL</span><span class="p">)</span><span class="o">=</span><span class="n">ST</span><span class="w">
       </span><span class="n">IDNUL</span><span class="p">(</span><span class="n">NEXCNUL</span><span class="p">)</span><span class="o">=</span><span class="n">I</span><span class="w">      
       </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">1</span><span class="w">                          
      </span><span class="k">ELSE</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> 
       </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">1</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w">    
</span><span class="n">C</span><span class="w">                                                                       
</span><span class="n">C</span><span class="w">  </span><span class="n">CALCULATE</span><span class="w"> </span><span class="n">DIRECTION</span><span class="w"> </span><span class="n">COSINES</span><span class="w"> </span><span class="n">AND</span><span class="w"> </span><span class="n">POSITIONS</span><span class="w"> </span><span class="n">AT</span><span class="w"> </span><span class="n">INSTANT</span><span class="w"> </span><span class="n">BEFORE</span><span class="w"> </span><span class="n">COLLISION</span><span class="w">
  </span><span class="mi">137</span><span class="w"> </span><span class="n">T2</span><span class="o">=</span><span class="n">T</span><span class="o">*</span><span class="n">T</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">E</span><span class="ow">.GT.</span><span class="n">EMAX</span><span class="p">)</span><span class="w"> </span><span class="n">EMAX</span><span class="o">=</span><span class="n">E</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">T</span><span class="ow">.GT.</span><span class="n">TMAX1</span><span class="p">)</span><span class="w"> </span><span class="n">TMAX1</span><span class="o">=</span><span class="n">T</span><span class="w">
      </span><span class="n">TDASH</span><span class="o">=</span><span class="mf">0.0D0</span><span class="w">
      </span><span class="n">NREAL</span><span class="o">=</span><span class="n">NREAL</span><span class="mi">+1</span><span class="w">                                                     
</span><span class="n">C</span><span class="w">     </span><span class="n">CONST6</span><span class="o">=</span><span class="n">DSQRT</span><span class="p">(</span><span class="n">E1</span><span class="p">/</span><span class="n">E</span><span class="p">)</span><span class="w">
      </span><span class="n">GAM2</span><span class="o">=</span><span class="p">(</span><span class="n">EMS</span><span class="o">+</span><span class="n">E</span><span class="p">)/</span><span class="n">EMS</span><span class="w">
      </span><span class="n">GAM12</span><span class="o">=</span><span class="p">(</span><span class="n">GAM1</span><span class="o">+</span><span class="n">GAM2</span><span class="p">)/</span><span class="mf">2.0D0</span><span class="w">
      </span><span class="n">BET2</span><span class="o">=</span><span class="n">DSQRT</span><span class="p">(</span><span class="mf">1.0D0-1.0D0</span><span class="p">/(</span><span class="n">GAM2</span><span class="o">*</span><span class="n">GAM2</span><span class="p">))</span><span class="w">   
      </span><span class="n">CONST6</span><span class="o">=</span><span class="n">BET1</span><span class="p">/</span><span class="n">BET2</span><span class="w">                                             
      </span><span class="n">DCX2</span><span class="o">=</span><span class="n">DCX1</span><span class="o">*</span><span class="n">CONST6</span><span class="w">                                                  
      </span><span class="n">DCY2</span><span class="o">=</span><span class="n">DCY1</span><span class="o">*</span><span class="n">CONST6</span><span class="w">                                                  
</span><span class="n">C</span><span class="w">     </span><span class="n">DCZ2</span><span class="o">=</span><span class="n">DCZ1</span><span class="o">*</span><span class="n">CONST6</span><span class="o">+</span><span class="n">EFIELD</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">CONST5</span><span class="p">/</span><span class="n">DSQRT</span><span class="p">(</span><span class="n">E</span><span class="p">)</span><span class="w"> 
      </span><span class="n">DCZ2</span><span class="o">=</span><span class="n">DCZ1</span><span class="o">*</span><span class="n">CONST6</span><span class="o">+</span><span class="n">EFIELD</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="mf">2.0D10</span><span class="o">*</span><span class="n">CONST1</span><span class="p">/(</span><span class="n">VC</span><span class="o">*</span><span class="n">BET2</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="n">CONST7</span><span class="o">=</span><span class="n">CONST9</span><span class="o">*</span><span class="n">DSQRT</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span><span class="w">  
      </span><span class="n">CONST7</span><span class="o">=</span><span class="n">VC</span><span class="o">*</span><span class="n">BET1</span><span class="o">*</span><span class="mf">1.0D-12</span><span class="w">                          
      </span><span class="n">A</span><span class="o">=</span><span class="n">T</span><span class="o">*</span><span class="n">CONST7</span><span class="w">                                                        
      </span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="o">+</span><span class="n">DCX1</span><span class="o">*</span><span class="n">A</span><span class="w">                                                        
      </span><span class="n">Y</span><span class="o">=</span><span class="n">Y</span><span class="o">+</span><span class="n">DCY1</span><span class="o">*</span><span class="n">A</span><span class="w">
      </span><span class="n">Z</span><span class="o">=</span><span class="n">Z</span><span class="o">+</span><span class="n">DCZ1</span><span class="o">*</span><span class="n">A</span><span class="o">+</span><span class="n">T2</span><span class="o">*</span><span class="n">F1</span><span class="p">/</span><span class="n">GAM12</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="n">Z</span><span class="o">=</span><span class="n">Z</span><span class="o">+</span><span class="n">DCZ1</span><span class="o">*</span><span class="n">A</span><span class="o">+</span><span class="n">T2</span><span class="o">*</span><span class="n">F1</span><span class="w">     
      </span><span class="n">ST</span><span class="o">=</span><span class="n">ST</span><span class="o">+</span><span class="n">T</span><span class="w">
      </span><span class="n">IT</span><span class="o">=</span><span class="n">DINT</span><span class="p">(</span><span class="n">T</span><span class="mf">+1.0D0</span><span class="p">)</span><span class="w">                                                  
      </span><span class="n">IT</span><span class="o">=</span><span class="n">DMIN0</span><span class="p">(</span><span class="n">IT</span><span class="p">,</span><span class="n">J300</span><span class="p">)</span><span class="w">                                               
      </span><span class="n">TIME</span><span class="p">(</span><span class="n">IT</span><span class="p">)</span><span class="o">=</span><span class="n">TIME</span><span class="p">(</span><span class="n">IT</span><span class="p">)</span><span class="mf">+1.0D0</span><span class="w">                                           
</span><span class="n">C</span><span class="w"> </span><span class="o">---------------------------------------------------------------------</span><span class="w"> 
</span><span class="n">C</span><span class="w">     </span><span class="n">DETERMINATION</span><span class="w"> </span><span class="n">OF</span><span class="w"> </span><span class="kt">REAL</span><span class="w"> </span><span class="n">COLLISION</span><span class="w"> </span><span class="k">TYPE</span><span class="w">                              
</span><span class="n">C</span><span class="w"> </span><span class="o">---------------------------------------------------------------------</span><span class="w"> 
      </span><span class="n">R2</span><span class="o">=</span><span class="n">drand48</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span><span class="w">
      </span><span class="n">I</span><span class="o">=</span><span class="mi">0</span><span class="w">                                                               
  </span><span class="mi">140</span><span class="w"> </span><span class="n">I</span><span class="o">=</span><span class="n">I</span><span class="mi">+1</span><span class="w">                                                             
      </span><span class="k">IF</span><span class="p">(</span><span class="n">CF</span><span class="p">(</span><span class="n">IE</span><span class="p">,</span><span class="n">I</span><span class="p">)</span><span class="ow">.LT.</span><span class="n">R2</span><span class="p">)</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">140</span><span class="w">    
</span><span class="n">C</span><span class="o">************************************************************</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">CHECK</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="n">BREMSSTRAHLUNG</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">IZBR</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="ow">.NE.</span><span class="mf">0.</span><span class="n">AND</span><span class="ow">.LBRM.</span><span class="n">EQ</span><span class="mf">.1</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
       </span><span class="n">NFLGBRMM</span><span class="o">=</span><span class="mi">1</span><span class="w">
       </span><span class="n">IPT</span><span class="o">=</span><span class="n">IARRY</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="w">
       </span><span class="n">ICOLL</span><span class="p">(</span><span class="n">IPT</span><span class="p">)</span><span class="o">=</span><span class="n">ICOLL</span><span class="p">(</span><span class="n">IPT</span><span class="p">)</span><span class="mi">+1</span><span class="w">
       </span><span class="n">ICOLN</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="n">ICOLN</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="mi">+1</span><span class="w">
       </span><span class="k">DO</span><span class="w"> </span><span class="mi">141</span><span class="w"> </span><span class="n">KNGS</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NGAS</span><span class="w">
       </span><span class="k">IF</span><span class="p">(</span><span class="n">IPT</span><span class="ow">.EQ.</span><span class="p">(</span><span class="n">KNGS</span><span class="o">*</span><span class="mi">5</span><span class="p">)</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">142</span><span class="w">
  </span><span class="mi">141</span><span class="w">  </span><span class="k">CONTINUE</span><span class="w">
  </span><span class="mi">142</span><span class="w">  </span><span class="n">IATOMNO</span><span class="o">=</span><span class="n">IZBR</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="w"> 
       </span><span class="k">CALL</span><span class="w"> </span><span class="n">BREMS</span><span class="p">(</span><span class="n">IATOMNO</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">DCX2</span><span class="p">,</span><span class="n">DCY2</span><span class="p">,</span><span class="n">DCZ2</span><span class="p">,</span><span class="n">EOUT</span><span class="p">,</span><span class="n">EDCX</span><span class="p">,</span><span class="n">EDCY</span><span class="p">,</span><span class="n">EDCZ</span><span class="p">,</span><span class="w">
     </span><span class="p">/</span><span class="n">EGAMMA</span><span class="p">,</span><span class="n">GDCX</span><span class="p">,</span><span class="n">GDCY</span><span class="p">,</span><span class="n">GDCZ</span><span class="p">)</span><span class="w">
       </span><span class="n">NBREM</span><span class="p">(</span><span class="n">KNGS</span><span class="p">)</span><span class="o">=</span><span class="n">NBREM</span><span class="p">(</span><span class="n">KNGS</span><span class="p">)</span><span class="mi">+1</span><span class="w">
       </span><span class="n">EBRTOT</span><span class="p">(</span><span class="n">KNGS</span><span class="p">)</span><span class="o">=</span><span class="n">EBRTOT</span><span class="p">(</span><span class="n">KNGS</span><span class="p">)</span><span class="o">+</span><span class="n">EGAMMA</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">GET</span><span class="w">  </span><span class="n">NEW</span><span class="w"> </span><span class="n">DRCOS</span><span class="w"> </span><span class="n">DRCOSY</span><span class="w"> </span><span class="n">DRCOSX</span><span class="w"> </span><span class="n">AND</span><span class="w"> </span><span class="n">ENERGY</span><span class="w"> </span><span class="n">OF</span><span class="w"> </span><span class="n">ELECTRON</span><span class="w">
       </span><span class="n">E1</span><span class="o">=</span><span class="n">EOUT</span><span class="w">
       </span><span class="n">DCX1</span><span class="o">=</span><span class="n">EDCX</span><span class="w">
       </span><span class="n">DCY1</span><span class="o">=</span><span class="n">EDCY</span><span class="w">
       </span><span class="n">DCZ1</span><span class="o">=</span><span class="n">EDCZ</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">RUN</span><span class="w"> </span><span class="n">BREMSSTRAHLUNG</span><span class="w"> </span><span class="n">GAMMA</span><span class="w"> </span><span class="n">THROUGH</span><span class="w"> </span><span class="n">CASCADE</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="n">STORE</span><span class="w"> </span><span class="n">CONVERTED</span><span class="w"> 
</span><span class="n">C</span><span class="w"> </span><span class="n">ELECTRONS</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="k">COMMON</span><span class="p">/</span><span class="n">CASRSB</span><span class="p">/</span><span class="w">
</span><span class="n">C</span><span class="w">
       </span><span class="k">CALL</span><span class="w"> </span><span class="n">BREMSCASC</span><span class="p">(</span><span class="n">J11</span><span class="p">,</span><span class="n">EGAMMA</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">ST</span><span class="p">,</span><span class="n">GDCX</span><span class="p">,</span><span class="n">GDCY</span><span class="p">,</span><span class="n">GDCZ</span><span class="p">,</span><span class="n">ILOW</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">BREMSSTRAHLUNG</span><span class="w"> </span><span class="n">ENERGY</span><span class="w"> </span><span class="n">TOO</span><span class="w"> </span><span class="n">LOW</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">IONISE</span><span class="w">
       </span><span class="k">IF</span><span class="p">(</span><span class="n">ILOW</span><span class="ow">.EQ.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">190</span><span class="w">
</span><span class="n">C</span><span class="w">    
</span><span class="n">C</span><span class="w">  </span><span class="n">STORE</span><span class="w"> </span><span class="n">BREMSSTRAHLUNG</span><span class="w"> </span><span class="k">DATA</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">CLUSTER</span><span class="w"> </span><span class="n">STORE</span><span class="w">
</span><span class="n">C</span><span class="w"> 
       </span><span class="n">ETSUM</span><span class="o">=</span><span class="mf">0.0</span><span class="w">     
       </span><span class="k">DO</span><span class="w"> </span><span class="mi">890</span><span class="w"> </span><span class="n">KBR</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">IEVNTLB</span><span class="w">
       </span><span class="n">NCLUS</span><span class="o">=</span><span class="n">NCLUS</span><span class="mi">+1</span><span class="w">
       </span><span class="k">IF</span><span class="p">(</span><span class="n">NCLUS</span><span class="ow">.GT.</span><span class="mi">150000</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> 
        </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">546</span><span class="p">)</span><span class="w"> </span><span class="n">NCLUS</span><span class="p">,</span><span class="n">NREAL</span><span class="w">
        </span><span class="k">STOP</span><span class="w">
       </span><span class="k">ENDIF</span><span class="w">    
       </span><span class="n">ES</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">ECASB</span><span class="p">(</span><span class="n">KBR</span><span class="p">)</span><span class="w">
       </span><span class="n">ETSUM</span><span class="o">=</span><span class="n">ETSUM</span><span class="o">+</span><span class="n">ES</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="w">
       </span><span class="n">XS</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">XCASB</span><span class="p">(</span><span class="n">KBR</span><span class="p">)</span><span class="w">
       </span><span class="n">YS</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">YCASB</span><span class="p">(</span><span class="n">KBR</span><span class="p">)</span><span class="w">
       </span><span class="n">ZS</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">ZCASB</span><span class="p">(</span><span class="n">KBR</span><span class="p">)</span><span class="w">
       </span><span class="n">TS</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">TTB1</span><span class="p">(</span><span class="n">KBR</span><span class="p">)</span><span class="w">
       </span><span class="n">DCX</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">DRXB</span><span class="p">(</span><span class="n">KBR</span><span class="p">)</span><span class="w">
       </span><span class="n">DCY</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">DRYB</span><span class="p">(</span><span class="n">KBR</span><span class="p">)</span><span class="w">
       </span><span class="n">DCZ</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">DRZB</span><span class="p">(</span><span class="n">KBR</span><span class="p">)</span><span class="w">
       </span><span class="n">NFLGFC</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">NFLGFB</span><span class="p">(</span><span class="n">KBR</span><span class="p">)</span><span class="o">+</span><span class="n">NFLGHIGH</span><span class="w">
       </span><span class="n">NFLGPPC</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">NFLGPPB</span><span class="p">(</span><span class="n">KBR</span><span class="p">)</span><span class="w">
       </span><span class="n">NFLGBRMC</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="mi">2</span><span class="w">
  </span><span class="mi">890</span><span class="w">  </span><span class="k">CONTINUE</span><span class="w"> 
       </span><span class="k">IF</span><span class="p">(</span><span class="n">NFLGFC</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="ow">.GT.</span><span class="n">NFLGHIGH</span><span class="p">)</span><span class="w"> </span><span class="n">NFLGHIGH</span><span class="o">=</span><span class="n">NFLGFC</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="w">
       </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">190</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w">                
  </span><span class="mi">891</span><span class="w"> </span><span class="k">CONTINUE</span><span class="w">  
</span><span class="n">C</span><span class="o">*****************************************************************</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="n">S1</span><span class="o">=</span><span class="n">RGAS</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="w">   
      </span><span class="n">S1</span><span class="o">=</span><span class="mf">1.0D0</span><span class="o">+</span><span class="n">GAM2</span><span class="o">*</span><span class="p">(</span><span class="n">RGAS</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="mf">-1.0D0</span><span class="p">)</span><span class="w">                                    
      </span><span class="n">EI</span><span class="o">=</span><span class="n">EIN</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">8890</span><span class="p">)</span><span class="w"> </span><span class="n">EIN</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">I</span><span class="w">
</span><span class="n">C8890</span><span class="w"> </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">' EIN='</span><span class="p">,</span><span class="l">D12.4</span><span class="p">,</span><span class="s1">' I='</span><span class="p">,</span><span class="l">I3</span><span class="p">)</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">E</span><span class="ow">.LT.</span><span class="n">EI</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
      </span><span class="n">EI</span><span class="o">=</span><span class="n">E</span><span class="mf">-0.0001D0</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w">                                                          
      </span><span class="k">IF</span><span class="p">(</span><span class="n">IPN</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="ow">.EQ.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">666</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">ATTACHMENT</span><span class="w">       
      </span><span class="k">IF</span><span class="p">(</span><span class="n">IPN</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="ow">.EQ.</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
       </span><span class="n">NETOT</span><span class="o">=</span><span class="n">NETOT</span><span class="mi">+1</span><span class="w">
       </span><span class="n">NITOT</span><span class="o">=</span><span class="n">NITOT</span><span class="mi">+1</span><span class="w">
       </span><span class="n">NELEC</span><span class="o">=</span><span class="n">NELEC</span><span class="mi">+1</span><span class="w">
       </span><span class="n">NEGION</span><span class="o">=</span><span class="n">NEGION</span><span class="mi">+1</span><span class="w">
       </span><span class="n">IPT</span><span class="o">=</span><span class="n">IARRY</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="w">
       </span><span class="n">ICOLL</span><span class="p">(</span><span class="n">IPT</span><span class="p">)</span><span class="o">=</span><span class="n">ICOLL</span><span class="p">(</span><span class="n">IPT</span><span class="p">)</span><span class="mi">+1</span><span class="w">
       </span><span class="n">ICOLN</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="n">ICOLN</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="mi">+1</span><span class="w"> 
       </span><span class="n">IT</span><span class="o">=</span><span class="n">DINT</span><span class="p">(</span><span class="n">T</span><span class="mf">+1.0D0</span><span class="p">)</span><span class="w">
       </span><span class="n">IT</span><span class="o">=</span><span class="n">DMIN0</span><span class="p">(</span><span class="n">IT</span><span class="p">,</span><span class="n">J300</span><span class="p">)</span><span class="w">
       </span><span class="n">TIME</span><span class="p">(</span><span class="n">IT</span><span class="p">)</span><span class="o">=</span><span class="n">TIME</span><span class="p">(</span><span class="n">IT</span><span class="p">)</span><span class="mf">+1.0D0</span><span class="w">
       </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">335</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w">
      </span><span class="n">EISTR</span><span class="o">=</span><span class="n">EI</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">IONMODEL</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="ow">.GT.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> 
</span><span class="n">C</span><span class="w"> </span><span class="n">CALCULATE</span><span class="w"> </span><span class="n">SECONDARY</span><span class="w"> </span><span class="n">ENERGY</span><span class="p">,</span><span class="n">ESEC</span><span class="p">,</span><span class="k">IN</span><span class="w"> </span><span class="n">IONISATION</span><span class="w"> </span><span class="n">COLLISION</span><span class="w"> </span><span class="n">USING</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">FIVE</span><span class="w"> </span><span class="n">DIFFERENT</span><span class="w"> </span><span class="n">MODELS</span><span class="w">
       </span><span class="k">CALL</span><span class="w"> </span><span class="n">IONSPLIT</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">EI</span><span class="p">,</span><span class="n">ESEC</span><span class="p">)</span><span class="w">
       </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">544</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w">
      </span><span class="n">R9</span><span class="o">=</span><span class="n">drand48</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">    </span><span class="k">USE</span><span class="w"> </span><span class="n">OPAL</span><span class="w"> </span><span class="n">PETERSON</span><span class="w"> </span><span class="n">AND</span><span class="w"> </span><span class="n">BEATY</span><span class="w"> </span><span class="n">SPLITTING</span><span class="w"> </span><span class="n">FACTOR</span><span class="err">.</span><span class="w">
      </span><span class="n">ESEC</span><span class="o">=</span><span class="n">WPL</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="nb">TAN</span><span class="p">(</span><span class="n">R9</span><span class="o">*</span><span class="nb">ATAN</span><span class="p">((</span><span class="n">E</span><span class="o">-</span><span class="n">EI</span><span class="p">)/(</span><span class="mf">2.0D0</span><span class="o">*</span><span class="n">WPL</span><span class="p">(</span><span class="n">I</span><span class="p">))))</span><span class="w">
      </span><span class="n">ESEC</span><span class="o">=</span><span class="n">WPL</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ESEC</span><span class="p">/</span><span class="n">WPL</span><span class="p">(</span><span class="n">I</span><span class="p">))</span><span class="o">**</span><span class="mf">0.9524</span><span class="w">
  </span><span class="mi">544</span><span class="w"> </span><span class="k">CONTINUE</span><span class="w">
      </span><span class="n">EI</span><span class="o">=</span><span class="n">ESEC</span><span class="o">+</span><span class="n">EI</span><span class="w"> 
</span><span class="n">C</span><span class="w"> </span><span class="n">STORE</span><span class="w"> </span><span class="n">POSITION</span><span class="w"> </span><span class="p">,</span><span class="n">ENERGY</span><span class="p">,</span><span class="w"> </span><span class="n">DIRECTION</span><span class="w"> </span><span class="n">COSINES</span><span class="w"> </span><span class="n">AND</span><span class="w"> </span><span class="n">TIME</span><span class="w"> </span><span class="n">OF</span><span class="w"> </span><span class="n">GENERATION</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">OF</span><span class="w"> </span><span class="n">SECONDARY</span><span class="w"> </span><span class="n">IONISATION</span><span class="w"> </span><span class="n">ELECTRONS</span><span class="w">
      </span><span class="n">NCLUS</span><span class="o">=</span><span class="n">NCLUS</span><span class="mi">+1</span><span class="w">
      </span><span class="n">NMXADD</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">,</span><span class="n">NMXADD</span><span class="p">)</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">NCLUS</span><span class="ow">.GT.</span><span class="mi">150000</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> 
      </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">546</span><span class="p">)</span><span class="w"> </span><span class="n">NCLUS</span><span class="p">,</span><span class="n">NREAL</span><span class="w">
 </span><span class="mi">546</span><span class="w">  </span><span class="k">FORMAT</span><span class="p">(</span><span class="l">2X</span><span class="p">,</span><span class="s1">' PROGRAM STOPPED . NCLUS='</span><span class="p">,</span><span class="l">I7</span><span class="p">,</span><span class="s1">' NREAL='</span><span class="p">,</span><span class="l">I10</span><span class="p">)</span><span class="w">
      </span><span class="k">STOP</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w">     
      </span><span class="n">XS</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">X</span><span class="w">       
      </span><span class="n">YS</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">Y</span><span class="w">
      </span><span class="n">ZS</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">Z</span><span class="w">
      </span><span class="n">TS</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">ST</span><span class="w">
      </span><span class="n">ES</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">ESEC</span><span class="w">   
      </span><span class="n">NFLGFC</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">NFLGFF</span><span class="w">
      </span><span class="n">NFLGPPC</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">NFLGPPP</span><span class="w">
      </span><span class="n">NFLGBRMC</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">NFLGBRMM</span><span class="w">
      </span><span class="n">NTMPFLG</span><span class="o">=</span><span class="mi">1</span><span class="w">
      </span><span class="n">NCLTMP</span><span class="o">=</span><span class="n">NCLUS</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="n">ES</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">ESEC</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">RANDOMISE</span><span class="w"> </span><span class="n">SECONDARY</span><span class="w"> </span><span class="n">ELECTRON</span><span class="w"> </span><span class="n">DIRECTION</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="n">R3</span><span class="o">=</span><span class="n">drand48</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="n">F3</span><span class="o">=</span><span class="mf">1.0-2.0D0</span><span class="o">*</span><span class="n">R3</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="n">THETA0</span><span class="o">=</span><span class="n">DACOS</span><span class="p">(</span><span class="n">F3</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="n">F6</span><span class="o">=</span><span class="n">DCOS</span><span class="p">(</span><span class="n">THETA0</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="n">F5</span><span class="o">=</span><span class="n">DSIN</span><span class="p">(</span><span class="n">THETA0</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="n">R4</span><span class="o">=</span><span class="n">drand48</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="n">PHI0</span><span class="o">=</span><span class="n">F4</span><span class="o">*</span><span class="n">R4</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="n">F8</span><span class="o">=</span><span class="n">DSIN</span><span class="p">(</span><span class="n">PHI0</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="n">F9</span><span class="o">=</span><span class="n">DCOS</span><span class="p">(</span><span class="n">PHI0</span><span class="p">)</span><span class="w">               
</span><span class="n">C</span><span class="w">     </span><span class="n">DCX</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">F9</span><span class="o">*</span><span class="n">F5</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="n">DCY</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">F8</span><span class="o">*</span><span class="n">F5</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="n">DCZ</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">F6</span><span class="w">   
</span><span class="n">C</span><span class="o">*********************************************************</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">IECASC</span><span class="ow">.EQ.</span><span class="mi">0</span><span class="p">)</span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">333</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">LEGAS</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="ow">.EQ.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">333</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="k">USE</span><span class="w"> </span><span class="n">COMPLETE</span><span class="w"> </span><span class="n">CASCADE</span><span class="w"> </span><span class="n">FOR</span><span class="w"> </span><span class="n">ELECTRON</span><span class="w"> </span><span class="n">IONISATION</span><span class="w">
      </span><span class="n">KG1</span><span class="o">=</span><span class="n">NEGAS</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="w">
      </span><span class="n">LG1</span><span class="o">=</span><span class="n">LEGAS</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="w">
      </span><span class="n">IGSHEL</span><span class="o">=</span><span class="n">IESHELL</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="w">
      </span><span class="k">CALL</span><span class="w"> </span><span class="n">CASCADEE</span><span class="p">(</span><span class="n">J11</span><span class="p">,</span><span class="n">KG1</span><span class="p">,</span><span class="n">LG1</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">ST</span><span class="p">,</span><span class="n">ESEC</span><span class="p">,</span><span class="n">IGSHEL</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">STORE</span><span class="w"> </span><span class="n">CASCADE</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">CLUSTER</span><span class="w"> </span><span class="n">STORE</span><span class="w">
</span><span class="n">C</span><span class="w">
      </span><span class="n">ETSUM</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">844</span><span class="w"> </span><span class="n">KBR</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">IEVENTE</span><span class="w">
      </span><span class="n">NCLUS</span><span class="o">=</span><span class="n">NCLUS</span><span class="mi">+1</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">NCLUS</span><span class="ow">.GT.</span><span class="mi">150000</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
       </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">546</span><span class="p">)</span><span class="w"> </span><span class="n">NCLUS</span><span class="p">,</span><span class="n">NREAL</span><span class="w">
       </span><span class="k">STOP</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w">
      </span><span class="n">ES</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">ECASE</span><span class="p">(</span><span class="n">KBR</span><span class="p">)</span><span class="w">
      </span><span class="n">ETSUM</span><span class="o">=</span><span class="n">ETSUM</span><span class="o">+</span><span class="n">ES</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="w">
      </span><span class="n">XS</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">XCASE</span><span class="p">(</span><span class="n">KBR</span><span class="p">)</span><span class="w">
      </span><span class="n">YS</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">YCASE</span><span class="p">(</span><span class="n">KBR</span><span class="p">)</span><span class="w">
      </span><span class="n">ZS</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">ZCASE</span><span class="p">(</span><span class="n">KBR</span><span class="p">)</span><span class="w">
      </span><span class="n">TS</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">TCASE</span><span class="p">(</span><span class="n">KBR</span><span class="p">)</span><span class="w">
      </span><span class="n">DCX</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">DRXCE</span><span class="p">(</span><span class="n">KBR</span><span class="p">)</span><span class="w">
      </span><span class="n">DCY</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">DRYCE</span><span class="p">(</span><span class="n">KBR</span><span class="p">)</span><span class="w">
      </span><span class="n">DCZ</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">DRZCE</span><span class="p">(</span><span class="n">KBR</span><span class="p">)</span><span class="w">
      </span><span class="n">NFLGFC</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">NFLGFE</span><span class="p">(</span><span class="n">KBR</span><span class="p">)</span><span class="o">+</span><span class="n">NFLGHIGH</span><span class="w">
      </span><span class="n">NFLGPPC</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">NFLGPPE</span><span class="p">(</span><span class="n">KBR</span><span class="p">)</span><span class="w">
      </span><span class="n">NFLGBRMC</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">NFLGBRMM</span><span class="w">
  </span><span class="mi">844</span><span class="w"> </span><span class="k">CONTINUE</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">NFLGFC</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="ow">.GT.</span><span class="n">NFLGHIGH</span><span class="p">)</span><span class="w"> </span><span class="n">NFLGHIGH</span><span class="o">=</span><span class="n">NFLGFC</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="w">
      </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">666</span><span class="w">
</span><span class="n">C</span><span class="o">*********************************************************</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">STORE</span><span class="w"> </span><span class="n">POSSIBLE</span><span class="w"> </span><span class="n">SHELL</span><span class="w"> </span><span class="n">EMISSIONS</span><span class="w"> </span><span class="n">AUGER</span><span class="w"> </span><span class="n">OR</span><span class="w"> </span><span class="n">FLUORESCENCE</span><span class="w"> 
  </span><span class="mi">333</span><span class="w"> </span><span class="k">IF</span><span class="p">(</span><span class="n">EISTR</span><span class="ow">.GT.</span><span class="mf">30.0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
</span><span class="n">C</span><span class="w">      </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">8891</span><span class="p">)</span><span class="w"> </span><span class="n">EISTR</span><span class="w">
</span><span class="n">C8891</span><span class="w">  </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">' EISTR='</span><span class="p">,</span><span class="l">D12.4</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">TEST</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="n">FLUORESCENCE</span><span class="w"> </span><span class="n">EMISSION</span><span class="w">
       </span><span class="n">IFLTST</span><span class="o">=</span><span class="mi">0</span><span class="w">
       </span><span class="k">IF</span><span class="p">(</span><span class="n">WKLM</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="ow">.GT.</span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
        </span><span class="n">R9</span><span class="o">=</span><span class="n">drand48</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span><span class="w">
        </span><span class="k">IF</span><span class="p">(</span><span class="n">R9</span><span class="ow">.LT.</span><span class="n">WKLM</span><span class="p">(</span><span class="n">I</span><span class="p">))</span><span class="w"> </span><span class="n">IFLTST</span><span class="o">=</span><span class="mi">1</span><span class="w">
       </span><span class="k">ENDIF</span><span class="w">
       </span><span class="k">IF</span><span class="p">(</span><span class="n">IFLTST</span><span class="ow">.EQ.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">AUGER</span><span class="w"> </span><span class="n">EMISSION</span><span class="w"> </span><span class="n">WITHOUT</span><span class="w"> </span><span class="n">FLUORESCENCE</span><span class="w">
        </span><span class="n">NAUG</span><span class="o">=</span><span class="n">NC0</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="w">
        </span><span class="n">EAVAUG</span><span class="o">=</span><span class="n">EC0</span><span class="p">(</span><span class="n">I</span><span class="p">)/</span><span class="n">DFLOAT</span><span class="p">(</span><span class="n">NAUG</span><span class="p">)</span><span class="w">
        </span><span class="k">DO</span><span class="w"> </span><span class="mi">700</span><span class="w"> </span><span class="n">JFL</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NC0</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="w">
        </span><span class="n">NCLUS</span><span class="o">=</span><span class="n">NCLUS</span><span class="mi">+1</span><span class="w">
        </span><span class="n">XS</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">X</span><span class="w">
        </span><span class="n">YS</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">Y</span><span class="w">
        </span><span class="n">ZS</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">Z</span><span class="w">
        </span><span class="n">TS</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">ST</span><span class="w">
        </span><span class="n">NFLGFC</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">NFLGFF</span><span class="w">
        </span><span class="n">NFLGPPC</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">NFLGPPP</span><span class="w">
        </span><span class="n">NFLGBRMC</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">NFLGBRMM</span><span class="w">
        </span><span class="n">ES</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">EAVAUG</span><span class="w">
        </span><span class="n">R3</span><span class="o">=</span><span class="n">drand48</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span><span class="w">
        </span><span class="n">F3</span><span class="o">=</span><span class="mf">1.0-2.0D0</span><span class="o">*</span><span class="n">R3</span><span class="w">
        </span><span class="n">THETA0</span><span class="o">=</span><span class="n">DACOS</span><span class="p">(</span><span class="n">F3</span><span class="p">)</span><span class="w">
        </span><span class="n">F6</span><span class="o">=</span><span class="n">DCOS</span><span class="p">(</span><span class="n">THETA0</span><span class="p">)</span><span class="w">
        </span><span class="n">F5</span><span class="o">=</span><span class="n">DSIN</span><span class="p">(</span><span class="n">THETA0</span><span class="p">)</span><span class="w">
        </span><span class="n">R4</span><span class="o">=</span><span class="n">drand48</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span><span class="w">
        </span><span class="n">PHI0</span><span class="o">=</span><span class="n">F4</span><span class="o">*</span><span class="n">R4</span><span class="w">
        </span><span class="n">F8</span><span class="o">=</span><span class="n">DSIN</span><span class="p">(</span><span class="n">PHI0</span><span class="p">)</span><span class="w">
        </span><span class="n">F9</span><span class="o">=</span><span class="n">DCOS</span><span class="p">(</span><span class="n">PHI0</span><span class="p">)</span><span class="w">               
        </span><span class="n">DCX</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">F9</span><span class="o">*</span><span class="n">F5</span><span class="w">
        </span><span class="n">DCY</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">F8</span><span class="o">*</span><span class="n">F5</span><span class="w">
        </span><span class="n">DCZ</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">F6</span><span class="w">
  </span><span class="mi">700</span><span class="w">   </span><span class="k">CONTINUE</span><span class="w"> 
       </span><span class="k">ELSE</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">AUGER</span><span class="w"> </span><span class="n">EMISSION</span><span class="w"> </span><span class="n">AND</span><span class="w"> </span><span class="n">FLUORESENCE</span><span class="w"> 
        </span><span class="k">IF</span><span class="p">(</span><span class="n">NG2</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="ow">.EQ.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">702</span><span class="w">
        </span><span class="n">NAUG</span><span class="o">=</span><span class="n">NG2</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="w">
        </span><span class="n">EAVAUG</span><span class="o">=</span><span class="n">EG2</span><span class="p">(</span><span class="n">I</span><span class="p">)/</span><span class="n">DFLOAT</span><span class="p">(</span><span class="n">NAUG</span><span class="p">)</span><span class="w">
        </span><span class="k">DO</span><span class="w"> </span><span class="mi">701</span><span class="w"> </span><span class="n">JFL</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NG2</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="w">
        </span><span class="n">NCLUS</span><span class="o">=</span><span class="n">NCLUS</span><span class="mi">+1</span><span class="w">
        </span><span class="n">XS</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">X</span><span class="w">
        </span><span class="n">YS</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">Y</span><span class="w">
        </span><span class="n">ZS</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">Z</span><span class="w">
        </span><span class="n">NFLGFC</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">NFLGFF</span><span class="w">
        </span><span class="n">NFLGPPC</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">NFLGPPP</span><span class="w">
        </span><span class="n">NFLGBRMC</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">NFLGBRMM</span><span class="w">
        </span><span class="n">TS</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">ST</span><span class="w">
        </span><span class="n">ES</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">EAVAUG</span><span class="w">
        </span><span class="n">R3</span><span class="o">=</span><span class="n">drand48</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span><span class="w">
        </span><span class="n">F3</span><span class="o">=</span><span class="mf">1.0-2.0D0</span><span class="o">*</span><span class="n">R3</span><span class="w">
        </span><span class="n">THETA0</span><span class="o">=</span><span class="n">DACOS</span><span class="p">(</span><span class="n">F3</span><span class="p">)</span><span class="w">
        </span><span class="n">F6</span><span class="o">=</span><span class="n">DCOS</span><span class="p">(</span><span class="n">THETA0</span><span class="p">)</span><span class="w">
        </span><span class="n">F5</span><span class="o">=</span><span class="n">DSIN</span><span class="p">(</span><span class="n">THETA0</span><span class="p">)</span><span class="w">
        </span><span class="n">R4</span><span class="o">=</span><span class="n">drand48</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span><span class="w">
        </span><span class="n">PHI0</span><span class="o">=</span><span class="n">F4</span><span class="o">*</span><span class="n">R4</span><span class="w">
        </span><span class="n">F8</span><span class="o">=</span><span class="n">DSIN</span><span class="p">(</span><span class="n">PHI0</span><span class="p">)</span><span class="w">
        </span><span class="n">F9</span><span class="o">=</span><span class="n">DCOS</span><span class="p">(</span><span class="n">PHI0</span><span class="p">)</span><span class="w">               
        </span><span class="n">DCX</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">F9</span><span class="o">*</span><span class="n">F5</span><span class="w">
        </span><span class="n">DCY</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">F8</span><span class="o">*</span><span class="n">F5</span><span class="w">
        </span><span class="n">DCZ</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">F6</span><span class="w">
  </span><span class="mi">701</span><span class="w">   </span><span class="k">CONTINUE</span><span class="w">
  </span><span class="mi">702</span><span class="w">   </span><span class="k">IF</span><span class="p">(</span><span class="n">NG1</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="ow">.EQ.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">704</span><span class="w">
        </span><span class="n">NAUG</span><span class="o">=</span><span class="n">NG1</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="w">
        </span><span class="n">EAVAUG</span><span class="o">=</span><span class="n">EG1</span><span class="p">(</span><span class="n">I</span><span class="p">)/</span><span class="n">DFLOAT</span><span class="p">(</span><span class="n">NAUG</span><span class="p">)</span><span class="w">
        </span><span class="n">R9</span><span class="o">=</span><span class="n">drand48</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span><span class="w">
        </span><span class="n">DFL</span><span class="o">=-</span><span class="n">DLOG</span><span class="p">(</span><span class="n">R9</span><span class="p">)</span><span class="o">*</span><span class="n">DSTFL</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="w">
        </span><span class="k">DO</span><span class="w"> </span><span class="mi">703</span><span class="w"> </span><span class="n">JFL</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NG1</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="w">
        </span><span class="n">NCLUS</span><span class="o">=</span><span class="n">NCLUS</span><span class="mi">+1</span><span class="w">
        </span><span class="n">R3</span><span class="o">=</span><span class="n">drand48</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span><span class="w">
        </span><span class="n">THEFL</span><span class="o">=</span><span class="n">DACOS</span><span class="p">(</span><span class="mf">1.0-2.0D0</span><span class="o">*</span><span class="n">R3</span><span class="p">)</span><span class="w">
        </span><span class="n">R4</span><span class="o">=</span><span class="n">drand48</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span><span class="w">
        </span><span class="n">PHIFL</span><span class="o">=</span><span class="n">F4</span><span class="o">*</span><span class="n">R4</span><span class="w">
        </span><span class="n">XS</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">X</span><span class="o">+</span><span class="n">DFL</span><span class="o">*</span><span class="n">DSIN</span><span class="p">(</span><span class="n">THEFL</span><span class="p">)</span><span class="o">*</span><span class="n">DCOS</span><span class="p">(</span><span class="n">PHIFL</span><span class="p">)</span><span class="w">
        </span><span class="n">YS</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">Y</span><span class="o">+</span><span class="n">DFL</span><span class="o">*</span><span class="n">DSIN</span><span class="p">(</span><span class="n">THEFL</span><span class="p">)</span><span class="o">*</span><span class="n">DSIN</span><span class="p">(</span><span class="n">PHIFL</span><span class="p">)</span><span class="w">
        </span><span class="n">ZS</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">Z</span><span class="o">+</span><span class="n">DFL</span><span class="o">*</span><span class="n">DCOS</span><span class="p">(</span><span class="n">THEFL</span><span class="p">)</span><span class="w">
        </span><span class="n">NFLGFC</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">NFLGHIGH</span><span class="mi">+1</span><span class="w">
        </span><span class="n">NFLGPPC</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">NFLGPPP</span><span class="w">
        </span><span class="n">NFLGBRMC</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">NFLGBRMM</span><span class="w">
        </span><span class="n">TS</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">ST</span><span class="w">
        </span><span class="n">ES</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">EAVAUG</span><span class="w">
        </span><span class="n">R3</span><span class="o">=</span><span class="n">drand48</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span><span class="w">
        </span><span class="n">F3</span><span class="o">=</span><span class="mf">1.0-2.0D0</span><span class="o">*</span><span class="n">R3</span><span class="w">
        </span><span class="n">THETA0</span><span class="o">=</span><span class="n">DACOS</span><span class="p">(</span><span class="n">F3</span><span class="p">)</span><span class="w">
        </span><span class="n">F6</span><span class="o">=</span><span class="n">DCOS</span><span class="p">(</span><span class="n">THETA0</span><span class="p">)</span><span class="w">
        </span><span class="n">F5</span><span class="o">=</span><span class="n">DSIN</span><span class="p">(</span><span class="n">THETA0</span><span class="p">)</span><span class="w">
        </span><span class="n">R4</span><span class="o">=</span><span class="n">drand48</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span><span class="w">
        </span><span class="n">PHI0</span><span class="o">=</span><span class="n">F4</span><span class="o">*</span><span class="n">R4</span><span class="w">
        </span><span class="n">F8</span><span class="o">=</span><span class="n">DSIN</span><span class="p">(</span><span class="n">PHI0</span><span class="p">)</span><span class="w">
        </span><span class="n">F9</span><span class="o">=</span><span class="n">DCOS</span><span class="p">(</span><span class="n">PHI0</span><span class="p">)</span><span class="w">               
        </span><span class="n">DCX</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">F9</span><span class="o">*</span><span class="n">F5</span><span class="w">
        </span><span class="n">DCY</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">F8</span><span class="o">*</span><span class="n">F5</span><span class="w">
        </span><span class="n">DCZ</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">F6</span><span class="w">
        </span><span class="n">NFLGHIGH</span><span class="o">=</span><span class="n">NFLGFC</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="w">
  </span><span class="mi">703</span><span class="w">   </span><span class="k">CONTINUE</span><span class="w">
  </span><span class="mi">704</span><span class="w">   </span><span class="k">CONTINUE</span><span class="w">
       </span><span class="k">ENDIF</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w">
</span><span class="n">C</span><span class="w">                                                                       
</span><span class="n">C</span><span class="w">  </span><span class="n">GENERATE</span><span class="w"> </span><span class="n">SCATTERING</span><span class="w"> </span><span class="n">ANGLES</span><span class="w"> </span><span class="n">AND</span><span class="w"> </span><span class="n">UPDATE</span><span class="w">  </span><span class="n">LABORATORY</span><span class="w"> </span><span class="n">COSINES</span><span class="w"> </span><span class="n">AFTER</span><span class="w">      
</span><span class="n">C</span><span class="w">   </span><span class="n">COLLISION</span><span class="w"> </span><span class="n">ALSO</span><span class="w"> </span><span class="n">UPDATE</span><span class="w"> </span><span class="n">ENERGY</span><span class="w"> </span><span class="n">OF</span><span class="w"> </span><span class="n">ELECTRON</span><span class="err">.</span><span class="w">                           
</span><span class="n">C</span><span class="w">
  </span><span class="mi">666</span><span class="w"> </span><span class="n">IPT</span><span class="o">=</span><span class="n">IARRY</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="w">
      </span><span class="n">ICOLL</span><span class="p">(</span><span class="n">IPT</span><span class="p">)</span><span class="o">=</span><span class="n">ICOLL</span><span class="p">(</span><span class="n">IPT</span><span class="p">)</span><span class="mi">+1</span><span class="w"> 
      </span><span class="n">ICOLN</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="n">ICOLN</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="mi">+1</span><span class="w"> 
</span><span class="n">C</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="n">EXCITATION</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="n">ADD</span><span class="w"> </span><span class="n">PROBABILITY</span><span class="w"> </span><span class="p">,</span><span class="n">PENFRA</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">I</span><span class="p">),</span><span class="n">OF</span><span class="w"> </span><span class="nb">TRANSFER</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">GIVE</span><span class="w">   
</span><span class="n">C</span><span class="w"> </span><span class="n">IONISATION</span><span class="w"> </span><span class="n">OF</span><span class="w"> </span><span class="n">THE</span><span class="w"> </span><span class="n">OTHER</span><span class="w"> </span><span class="n">GASES</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">MIXTURE</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">IPEN</span><span class="ow">.EQ.</span><span class="mf">0.</span><span class="n">OR</span><span class="ow">.NGAS.</span><span class="n">EQ</span><span class="mf">.1</span><span class="p">)</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">5</span><span class="w"> 
      </span><span class="k">IF</span><span class="p">(</span><span class="n">PENFRA</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">I</span><span class="p">)</span><span class="ow">.NE.</span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">      
       </span><span class="n">RAN</span><span class="o">=</span><span class="n">drand48</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span><span class="w">
       </span><span class="k">IF</span><span class="p">(</span><span class="n">RAN</span><span class="ow">.GT.</span><span class="n">PENFRA</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">I</span><span class="p">))</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">5</span><span class="w">
       </span><span class="n">NCLUS</span><span class="o">=</span><span class="n">NCLUS</span><span class="mi">+1</span><span class="w">  
</span><span class="n">C</span><span class="w"> </span><span class="n">ENTER</span><span class="w"> </span><span class="n">HERE</span><span class="w"> </span><span class="n">POSSIBLE</span><span class="w"> </span><span class="n">DELOCALISATION</span><span class="w"> </span><span class="n">LENGTH</span><span class="w"> </span><span class="n">FOR</span><span class="w"> </span><span class="n">PENNING</span><span class="w"> </span><span class="nb">TRANSFER</span><span class="w">
       </span><span class="k">IF</span><span class="p">(</span><span class="n">PENFRA</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">I</span><span class="p">)</span><span class="ow">.EQ.</span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
        </span><span class="n">XS</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">X</span><span class="w">
        </span><span class="n">YS</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">Y</span><span class="w">      
        </span><span class="n">ZS</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">Z</span><span class="w">             
        </span><span class="n">NFLGFC</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">NFLGFF</span><span class="w">
        </span><span class="n">NFLGPPC</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">NFLGPPP</span><span class="w">
        </span><span class="n">NFLGBRMC</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">NFLGBRMM</span><span class="w">
        </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">667</span><span class="w">
       </span><span class="k">ENDIF</span><span class="w">
       </span><span class="n">ASIGN</span><span class="o">=</span><span class="mf">1.0</span><span class="w">
       </span><span class="n">RAN</span><span class="o">=</span><span class="n">drand48</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span><span class="w">
       </span><span class="n">RAN1</span><span class="o">=</span><span class="n">drand48</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span><span class="w">
       </span><span class="k">IF</span><span class="p">(</span><span class="n">RAN1</span><span class="ow">.LT.</span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="n">ASIGN</span><span class="o">=-</span><span class="n">ASIGN</span><span class="w">
       </span><span class="n">XS</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">X</span><span class="o">-</span><span class="n">DLOG</span><span class="p">(</span><span class="n">RAN</span><span class="p">)</span><span class="o">*</span><span class="n">PENFRA</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">ASIGN</span><span class="w">
       </span><span class="n">RAN</span><span class="o">=</span><span class="n">drand48</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span><span class="w">
       </span><span class="n">RAN1</span><span class="o">=</span><span class="n">drand48</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span><span class="w">
       </span><span class="k">IF</span><span class="p">(</span><span class="n">RAN1</span><span class="ow">.LT.</span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="n">ASIGN</span><span class="o">=-</span><span class="n">ASIGN</span><span class="w">
       </span><span class="n">YS</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">Y</span><span class="o">-</span><span class="n">DLOG</span><span class="p">(</span><span class="n">RAN</span><span class="p">)</span><span class="o">*</span><span class="n">PENFRA</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">ASIGN</span><span class="w">
       </span><span class="n">RAN</span><span class="o">=</span><span class="n">drand48</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span><span class="w">
       </span><span class="n">RAN1</span><span class="o">=</span><span class="n">drand48</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span><span class="w">
       </span><span class="k">IF</span><span class="p">(</span><span class="n">RAN1</span><span class="ow">.LT.</span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="n">ASIGN</span><span class="o">=-</span><span class="n">ASIGN</span><span class="w">
       </span><span class="n">ZS</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">Z</span><span class="o">-</span><span class="n">DLOG</span><span class="p">(</span><span class="n">RAN</span><span class="p">)</span><span class="o">*</span><span class="n">PENFRA</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">ASIGN</span><span class="w">
  </span><span class="mi">667</span><span class="w">  </span><span class="n">RAN</span><span class="o">=</span><span class="n">drand48</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span><span class="w">
       </span><span class="n">TS</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">ST</span><span class="o">-</span><span class="n">DLOG</span><span class="p">(</span><span class="n">RAN</span><span class="p">)</span><span class="o">*</span><span class="n">PENFRA</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">I</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">ASSIGN</span><span class="w"> </span><span class="n">EXCESS</span><span class="w"> </span><span class="n">ENERGY</span><span class="w"> </span><span class="n">OF</span><span class="w"> </span><span class="mi">1</span><span class="n">EV</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">PENNING</span><span class="w"> </span><span class="n">CREATED</span><span class="w"> </span><span class="n">ELECTRON</span><span class="w">
       </span><span class="n">ES</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="mf">1.0</span><span class="w">
       </span><span class="n">DCX</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">DCX1</span><span class="w">
       </span><span class="n">DCY</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">DCY1</span><span class="w">
       </span><span class="n">DCZ</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">)</span><span class="o">=</span><span class="n">DCZ1</span><span class="w">
       </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">6</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w"> 
</span><span class="n">C</span><span class="w">      </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">6</span><span class="w"> 
</span><span class="n">C</span><span class="w"> </span><span class="n">CALCULATE</span><span class="w"> </span><span class="nb">SUM</span><span class="w"> </span><span class="n">OF</span><span class="w"> </span><span class="n">EXCITATION</span><span class="w"> </span><span class="n">PER</span><span class="w"> </span><span class="n">CLUSTER</span><span class="w"> </span><span class="n">AND</span><span class="w"> </span><span class="n">STORE</span><span class="w"> </span><span class="n">EXCITATION</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="n">Z</span><span class="w"> </span><span class="n">T</span><span class="w">
   </span><span class="mi">5</span><span class="w">  </span><span class="k">IF</span><span class="p">(</span><span class="n">IPN</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="ow">.EQ.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
       </span><span class="k">IF</span><span class="p">((</span><span class="n">RGAS</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">EIN</span><span class="p">(</span><span class="n">I</span><span class="p">))</span><span class="ow">.GT.</span><span class="mf">4.0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
        </span><span class="n">KEXC</span><span class="o">=</span><span class="n">KEXC</span><span class="mi">+1</span><span class="w">
        </span><span class="k">IF</span><span class="p">(</span><span class="n">KEXC</span><span class="ow">.GT.</span><span class="mi">150000</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
         </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">548</span><span class="p">)</span><span class="w"> </span><span class="n">KEXC</span><span class="w">
 </span><span class="mi">548</span><span class="w">     </span><span class="k">FORMAT</span><span class="p">(</span><span class="l">2X</span><span class="p">,</span><span class="s1">' PROGRAM STOPPED . KEXC='</span><span class="p">,</span><span class="l">I7</span><span class="p">)</span><span class="w">
         </span><span class="k">STOP</span><span class="w">
        </span><span class="k">ENDIF</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">FIND</span><span class="w"> </span><span class="n">GAS</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">WHICH</span><span class="w"> </span><span class="n">EXCITATION</span><span class="w"> </span><span class="n">OCCURED</span><span class="w"> </span><span class="n">AND</span><span class="w"> </span><span class="n">INCREMENT</span><span class="w"> </span><span class="n">COUNTER</span><span class="w">
        </span><span class="k">IF</span><span class="p">(</span><span class="n">I</span><span class="ow">.LE.</span><span class="n">IDG1</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> 
         </span><span class="n">NGEXC1</span><span class="o">=</span><span class="n">NGEXC1</span><span class="mi">+1</span><span class="w">
        </span><span class="k">ELSE</span><span class="w"> </span><span class="k">IF</span><span class="p">(</span><span class="n">I</span><span class="ow">.LE.</span><span class="n">IDG2</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
         </span><span class="n">NGEXC2</span><span class="o">=</span><span class="n">NGEXC2</span><span class="mi">+1</span><span class="w">
        </span><span class="k">ELSE</span><span class="w"> </span><span class="k">IF</span><span class="p">(</span><span class="n">I</span><span class="ow">.LE.</span><span class="n">IDG3</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
         </span><span class="n">NGEXC3</span><span class="o">=</span><span class="n">NGEXC3</span><span class="mi">+1</span><span class="w">
        </span><span class="k">ELSE</span><span class="w"> </span><span class="k">IF</span><span class="p">(</span><span class="n">I</span><span class="ow">.LE.</span><span class="n">IDG4</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
         </span><span class="n">NGEXC4</span><span class="o">=</span><span class="n">NGEXC4</span><span class="mi">+1</span><span class="w">
        </span><span class="k">ELSE</span><span class="w"> </span><span class="k">IF</span><span class="p">(</span><span class="n">I</span><span class="ow">.LE.</span><span class="n">IDG5</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
         </span><span class="n">NGEXC5</span><span class="o">=</span><span class="n">NGEXC5</span><span class="mi">+1</span><span class="w">
        </span><span class="k">ELSE</span><span class="w"> </span><span class="k">IF</span><span class="p">(</span><span class="n">I</span><span class="ow">.LE.</span><span class="n">IDG6</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
         </span><span class="n">NGEXC6</span><span class="o">=</span><span class="n">NGEXC6</span><span class="mi">+1</span><span class="w">
        </span><span class="k">ELSE</span><span class="w">
         </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">9911</span><span class="p">)</span><span class="w"> 
 </span><span class="mi">9911</span><span class="w">    </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">' PROGRAM STOPPED BAD GAS ID IN MONTE'</span><span class="p">)</span><span class="w">
         </span><span class="k">STOP</span><span class="w">
        </span><span class="k">ENDIF</span><span class="w">
        </span><span class="n">NEXCTOT</span><span class="o">=</span><span class="n">NEXCTOT</span><span class="mi">+1</span><span class="w">
        </span><span class="n">NSTEXC</span><span class="o">=</span><span class="n">NSTEXC</span><span class="mi">+1</span><span class="w">
        </span><span class="n">XSTEXC</span><span class="p">(</span><span class="n">KEXC</span><span class="p">)</span><span class="o">=</span><span class="n">X</span><span class="w">
        </span><span class="n">YSTEXC</span><span class="p">(</span><span class="n">KEXC</span><span class="p">)</span><span class="o">=</span><span class="n">Y</span><span class="w">
        </span><span class="n">ZSTEXC</span><span class="p">(</span><span class="n">KEXC</span><span class="p">)</span><span class="o">=</span><span class="n">Z</span><span class="w">
        </span><span class="n">TSTEXC</span><span class="p">(</span><span class="n">KEXC</span><span class="p">)</span><span class="o">=</span><span class="n">ST</span><span class="w">
       </span><span class="k">ENDIF</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w"> 
   </span><span class="mi">6</span><span class="w">  </span><span class="n">S2</span><span class="o">=</span><span class="p">(</span><span class="n">S1</span><span class="o">*</span><span class="n">S1</span><span class="p">)/(</span><span class="n">S1</span><span class="mf">-1.0D0</span><span class="p">)</span><span class="w"> 
</span><span class="n">C</span><span class="w">   </span><span class="n">ANISOTROPIC</span><span class="w"> </span><span class="n">SCATTERING</span><span class="w">
      </span><span class="n">R3</span><span class="o">=</span><span class="n">drand48</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="ow">.EQ.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
       </span><span class="n">R31</span><span class="o">=</span><span class="n">drand48</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span><span class="w">
       </span><span class="n">F3</span><span class="o">=</span><span class="mf">1.0D0</span><span class="o">-</span><span class="n">R3</span><span class="o">*</span><span class="n">ANGCT</span><span class="p">(</span><span class="n">IE</span><span class="p">,</span><span class="n">I</span><span class="p">)</span><span class="w">          
       </span><span class="k">IF</span><span class="p">(</span><span class="n">R31</span><span class="ow">.GT.</span><span class="n">PSCT</span><span class="p">(</span><span class="n">IE</span><span class="p">,</span><span class="n">I</span><span class="p">))</span><span class="w">  </span><span class="n">F3</span><span class="o">=-</span><span class="n">F3</span><span class="w">
      </span><span class="k">ELSE</span><span class="w"> </span><span class="k">IF</span><span class="p">(</span><span class="nb">INDEX</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="ow">.EQ.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
       </span><span class="n">EPSI</span><span class="o">=</span><span class="n">PSCT</span><span class="p">(</span><span class="n">IE</span><span class="p">,</span><span class="n">I</span><span class="p">)</span><span class="w">
       </span><span class="n">F3</span><span class="o">=</span><span class="mf">1.0D0</span><span class="o">-</span><span class="p">(</span><span class="mf">2.0D0</span><span class="o">*</span><span class="n">R3</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0D0</span><span class="o">-</span><span class="n">EPSI</span><span class="p">)/(</span><span class="mf">1.0D0</span><span class="o">+</span><span class="n">EPSI</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0D0-2.0D0</span><span class="o">*</span><span class="n">R3</span><span class="p">)))</span><span class="w"> 
      </span><span class="k">ELSE</span><span class="w"> 
</span><span class="n">C</span><span class="w"> </span><span class="n">ISOTROPIC</span><span class="w"> </span><span class="n">SCATTERING</span><span class="w">                                             
       </span><span class="n">F3</span><span class="o">=</span><span class="mf">1.0D0-2.0D0</span><span class="o">*</span><span class="n">R3</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w">
      </span><span class="n">THETA0</span><span class="o">=</span><span class="n">DACOS</span><span class="p">(</span><span class="n">F3</span><span class="p">)</span><span class="w">
      </span><span class="n">R4</span><span class="o">=</span><span class="n">drand48</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span><span class="w">
      </span><span class="n">PHI0</span><span class="o">=</span><span class="n">F4</span><span class="o">*</span><span class="n">R4</span><span class="w">                                                        
      </span><span class="n">F8</span><span class="o">=</span><span class="n">DSIN</span><span class="p">(</span><span class="n">PHI0</span><span class="p">)</span><span class="w">                                                     
      </span><span class="n">F9</span><span class="o">=</span><span class="n">DCOS</span><span class="p">(</span><span class="n">PHI0</span><span class="p">)</span><span class="w">                                                     
      </span><span class="k">IF</span><span class="p">(</span><span class="n">E</span><span class="ow">.LT.</span><span class="n">EI</span><span class="p">)</span><span class="w"> </span><span class="n">EI</span><span class="o">=</span><span class="mf">0.0D0</span><span class="w">                                              
      </span><span class="n">ARG1</span><span class="o">=</span><span class="mf">1.0D0</span><span class="o">-</span><span class="n">S1</span><span class="o">*</span><span class="n">EI</span><span class="p">/</span><span class="n">E</span><span class="w">                                                
      </span><span class="n">ARG1</span><span class="o">=</span><span class="n">DMAX1</span><span class="p">(</span><span class="n">ARG1</span><span class="p">,</span><span class="n">SMALL</span><span class="p">)</span><span class="w">                                            
      </span><span class="n">D</span><span class="o">=</span><span class="mf">1.0D0</span><span class="o">-</span><span class="n">F3</span><span class="o">*</span><span class="n">DSQRT</span><span class="p">(</span><span class="n">ARG1</span><span class="p">)</span><span class="w">                                            
      </span><span class="n">E1</span><span class="o">=</span><span class="n">E</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0D0</span><span class="o">-</span><span class="n">EI</span><span class="p">/(</span><span class="n">S1</span><span class="o">*</span><span class="n">E</span><span class="p">)</span><span class="mf">-2.0D0</span><span class="o">*</span><span class="n">D</span><span class="p">/</span><span class="n">S2</span><span class="p">)</span><span class="w"> 
      </span><span class="n">E1</span><span class="o">=</span><span class="n">DMAX1</span><span class="p">(</span><span class="n">E1</span><span class="p">,</span><span class="n">SMALL</span><span class="p">)</span><span class="w">                                                
      </span><span class="n">Q</span><span class="o">=</span><span class="n">DSQRT</span><span class="p">((</span><span class="n">E</span><span class="p">/</span><span class="n">E1</span><span class="p">)</span><span class="o">*</span><span class="n">ARG1</span><span class="p">)/</span><span class="n">S1</span><span class="w">                                           
      </span><span class="n">Q</span><span class="o">=</span><span class="n">DMIN1</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="mf">1.0D0</span><span class="p">)</span><span class="w">                                                  
      </span><span class="n">THETA</span><span class="o">=</span><span class="n">DASIN</span><span class="p">(</span><span class="n">Q</span><span class="o">*</span><span class="n">DSIN</span><span class="p">(</span><span class="n">THETA0</span><span class="p">))</span><span class="w">                                       
      </span><span class="n">F6</span><span class="o">=</span><span class="n">DCOS</span><span class="p">(</span><span class="n">THETA</span><span class="p">)</span><span class="w">                                                    
      </span><span class="n">U</span><span class="o">=</span><span class="p">(</span><span class="n">S1</span><span class="mf">-1.0D0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">S1</span><span class="mf">-1.0D0</span><span class="p">)/</span><span class="n">ARG1</span><span class="w">                                      
      </span><span class="n">CSQD</span><span class="o">=</span><span class="n">F3</span><span class="o">*</span><span class="n">F3</span><span class="w">                                                        
      </span><span class="k">IF</span><span class="p">(</span><span class="n">F3</span><span class="ow">.LT.</span><span class="mf">0.0D0</span><span class="ow">.AND.</span><span class="n">CSQD</span><span class="ow">.GT.</span><span class="n">U</span><span class="p">)</span><span class="w"> </span><span class="n">F6</span><span class="o">=</span><span class="mf">-1.0D0</span><span class="o">*</span><span class="n">F6</span><span class="w">                        
      </span><span class="n">F5</span><span class="o">=</span><span class="n">DSIN</span><span class="p">(</span><span class="n">THETA</span><span class="p">)</span><span class="w">                                                    
      </span><span class="n">DCZ2</span><span class="o">=</span><span class="n">DMIN1</span><span class="p">(</span><span class="n">DCZ2</span><span class="p">,</span><span class="mf">1.0D0</span><span class="p">)</span><span class="w">                                            
      </span><span class="n">ARGZ</span><span class="o">=</span><span class="n">DSQRT</span><span class="p">(</span><span class="n">DCX2</span><span class="o">*</span><span class="n">DCX2</span><span class="o">+</span><span class="n">DCY2</span><span class="o">*</span><span class="n">DCY2</span><span class="p">)</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">ARGZ</span><span class="ow">.EQ.</span><span class="mf">0.0D0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
       </span><span class="n">DCZ1</span><span class="o">=</span><span class="n">F6</span><span class="w">         
       </span><span class="n">DCX1</span><span class="o">=</span><span class="n">F9</span><span class="o">*</span><span class="n">F5</span><span class="w">                             
       </span><span class="n">DCY1</span><span class="o">=</span><span class="n">F8</span><span class="o">*</span><span class="n">F5</span><span class="w"> 
       </span><span class="k">IF</span><span class="p">(</span><span class="n">NTMPFLG</span><span class="ow">.EQ.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="k">USE</span><span class="w"> </span><span class="n">FREE</span><span class="w"> </span><span class="n">KINEMATICS</span><span class="w"> </span><span class="n">FOR</span><span class="w"> </span><span class="n">IONISATION</span><span class="w"> </span><span class="n">SECONDARY</span><span class="w"> </span><span class="n">ANGLES</span><span class="w">
        </span><span class="n">F5S</span><span class="o">=</span><span class="n">F5</span><span class="o">*</span><span class="n">DSQRT</span><span class="p">(</span><span class="n">E1</span><span class="p">/</span><span class="n">ES</span><span class="p">(</span><span class="n">NCLTMP</span><span class="p">))</span><span class="w">
        </span><span class="k">IF</span><span class="p">(</span><span class="n">F5S</span><span class="ow">.GT.</span><span class="mf">1.0</span><span class="p">)</span><span class="w"> </span><span class="n">F5S</span><span class="o">=</span><span class="mf">1.0</span><span class="w">
        </span><span class="n">THSEC</span><span class="o">=</span><span class="n">DASIN</span><span class="p">(</span><span class="n">F5S</span><span class="p">)</span><span class="w">
        </span><span class="n">F5S</span><span class="o">=</span><span class="n">DSIN</span><span class="p">(</span><span class="n">THSEC</span><span class="p">)</span><span class="w">
        </span><span class="n">F6S</span><span class="o">=</span><span class="n">DCOS</span><span class="p">(</span><span class="n">THSEC</span><span class="p">)</span><span class="w">
        </span><span class="k">IF</span><span class="p">(</span><span class="n">F6</span><span class="ow">.LT.</span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="n">F6S</span><span class="o">=-</span><span class="n">F6S</span><span class="w">
        </span><span class="n">PHIS</span><span class="o">=</span><span class="n">PHI0</span><span class="o">+</span><span class="n">API</span><span class="w">   
        </span><span class="k">IF</span><span class="p">(</span><span class="n">PHIS</span><span class="ow">.GT.</span><span class="n">F4</span><span class="p">)</span><span class="w"> </span><span class="n">PHIS</span><span class="o">=</span><span class="n">PHI0</span><span class="o">-</span><span class="n">F4</span><span class="w">
        </span><span class="n">F8S</span><span class="o">=</span><span class="n">DSIN</span><span class="p">(</span><span class="n">PHIS</span><span class="p">)</span><span class="w">
        </span><span class="n">F9S</span><span class="o">=</span><span class="n">DCOS</span><span class="p">(</span><span class="n">PHIS</span><span class="p">)</span><span class="w">
        </span><span class="n">DCZ</span><span class="p">(</span><span class="n">NCLTMP</span><span class="p">)</span><span class="o">=</span><span class="n">F6S</span><span class="w">
        </span><span class="n">DCX</span><span class="p">(</span><span class="n">NCLTMP</span><span class="p">)</span><span class="o">=</span><span class="n">F9S</span><span class="o">*</span><span class="n">F5S</span><span class="w">
        </span><span class="n">DCY</span><span class="p">(</span><span class="n">NCLTMP</span><span class="p">)</span><span class="o">=</span><span class="n">F8S</span><span class="o">*</span><span class="n">F5S</span><span class="w">
        </span><span class="n">NTMPFLG</span><span class="o">=</span><span class="mi">0</span><span class="w">
       </span><span class="k">ENDIF</span><span class="w">
       </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">190</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w">                                            
      </span><span class="n">DCZ1</span><span class="o">=</span><span class="n">DCZ2</span><span class="o">*</span><span class="n">F6</span><span class="o">+</span><span class="n">ARGZ</span><span class="o">*</span><span class="n">F5</span><span class="o">*</span><span class="n">F8</span><span class="w">                                           
      </span><span class="n">DCY1</span><span class="o">=</span><span class="n">DCY2</span><span class="o">*</span><span class="n">F6</span><span class="o">+</span><span class="p">(</span><span class="n">F5</span><span class="p">/</span><span class="n">ARGZ</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">DCX2</span><span class="o">*</span><span class="n">F9</span><span class="o">-</span><span class="n">DCY2</span><span class="o">*</span><span class="n">DCZ2</span><span class="o">*</span><span class="n">F8</span><span class="p">)</span><span class="w">                     
      </span><span class="n">DCX1</span><span class="o">=</span><span class="n">DCX2</span><span class="o">*</span><span class="n">F6</span><span class="o">-</span><span class="p">(</span><span class="n">F5</span><span class="p">/</span><span class="n">ARGZ</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">DCY2</span><span class="o">*</span><span class="n">F9</span><span class="o">+</span><span class="n">DCX2</span><span class="o">*</span><span class="n">DCZ2</span><span class="o">*</span><span class="n">F8</span><span class="p">)</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">NTMPFLG</span><span class="ow">.EQ.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="k">USE</span><span class="w"> </span><span class="n">FREE</span><span class="w"> </span><span class="n">KINEMATICS</span><span class="w"> </span><span class="n">FOR</span><span class="w"> </span><span class="n">IONISATION</span><span class="w"> </span><span class="n">SECONDARY</span><span class="w"> </span><span class="n">ANGLES</span><span class="w">
       </span><span class="n">F5S</span><span class="o">=</span><span class="n">F5</span><span class="o">*</span><span class="n">DSQRT</span><span class="p">(</span><span class="n">E1</span><span class="p">/</span><span class="n">ES</span><span class="p">(</span><span class="n">NCLTMP</span><span class="p">))</span><span class="w">
       </span><span class="k">IF</span><span class="p">(</span><span class="n">F5S</span><span class="ow">.GT.</span><span class="mf">1.0</span><span class="p">)</span><span class="w"> </span><span class="n">F5S</span><span class="o">=</span><span class="mf">1.0</span><span class="w">            
       </span><span class="n">THSEC</span><span class="o">=</span><span class="n">DASIN</span><span class="p">(</span><span class="n">F5S</span><span class="p">)</span><span class="w">
       </span><span class="n">F5S</span><span class="o">=</span><span class="n">DSIN</span><span class="p">(</span><span class="n">THSEC</span><span class="p">)</span><span class="w">
       </span><span class="n">F6S</span><span class="o">=</span><span class="n">DCOS</span><span class="p">(</span><span class="n">THSEC</span><span class="p">)</span><span class="w">
       </span><span class="k">IF</span><span class="p">(</span><span class="n">F6</span><span class="ow">.LT.</span><span class="mf">0.0</span><span class="p">)</span><span class="w"> </span><span class="n">F6S</span><span class="o">=-</span><span class="n">F6S</span><span class="w">
       </span><span class="n">PHIS</span><span class="o">=</span><span class="n">PHI0</span><span class="o">+</span><span class="n">API</span><span class="w">   
       </span><span class="k">IF</span><span class="p">(</span><span class="n">PHIS</span><span class="ow">.GT.</span><span class="n">F4</span><span class="p">)</span><span class="w"> </span><span class="n">PHIS</span><span class="o">=</span><span class="n">PHI0</span><span class="o">-</span><span class="n">F4</span><span class="w">
       </span><span class="n">F8S</span><span class="o">=</span><span class="n">DSIN</span><span class="p">(</span><span class="n">PHIS</span><span class="p">)</span><span class="w">
       </span><span class="n">F9S</span><span class="o">=</span><span class="n">DCOS</span><span class="p">(</span><span class="n">PHIS</span><span class="p">)</span><span class="w">
       </span><span class="n">DCZ</span><span class="p">(</span><span class="n">NCLTMP</span><span class="p">)</span><span class="o">=</span><span class="n">DCZ2</span><span class="o">*</span><span class="n">F6S</span><span class="o">+</span><span class="n">ARGZ</span><span class="o">*</span><span class="n">F5S</span><span class="o">*</span><span class="n">F8S</span><span class="w">                               
       </span><span class="n">DCY</span><span class="p">(</span><span class="n">NCLTMP</span><span class="p">)</span><span class="o">=</span><span class="n">DCY2</span><span class="o">*</span><span class="n">F6S</span><span class="o">+</span><span class="p">(</span><span class="n">F5S</span><span class="p">/</span><span class="n">ARGZ</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">DCX2</span><span class="o">*</span><span class="n">F9S</span><span class="o">-</span><span class="n">DCY2</span><span class="o">*</span><span class="n">DCZ2</span><span class="o">*</span><span class="n">F8S</span><span class="p">)</span><span class="w">        
       </span><span class="n">DCX</span><span class="p">(</span><span class="n">NCLTMP</span><span class="p">)</span><span class="o">=</span><span class="n">DCX2</span><span class="o">*</span><span class="n">F6S</span><span class="o">-</span><span class="p">(</span><span class="n">F5S</span><span class="p">/</span><span class="n">ARGZ</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">DCY2</span><span class="o">*</span><span class="n">F9S</span><span class="o">+</span><span class="n">DCX2</span><span class="o">*</span><span class="n">DCZ2</span><span class="o">*</span><span class="n">F8S</span><span class="p">)</span><span class="w">
       </span><span class="n">NTMPFLG</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w"> 
  </span><span class="mi">190</span><span class="w"> </span><span class="k">CONTINUE</span><span class="w"> 
</span><span class="n">C</span><span class="w"> </span><span class="n">TEST</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="n">ELECTRON</span><span class="w"> </span><span class="n">IS</span><span class="w"> </span><span class="n">THERMALISED</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">E1</span><span class="ow">.GT.</span><span class="n">ETHRM</span><span class="p">)</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">1</span><span class="w">  
</span><span class="n">C</span><span class="w"> </span><span class="n">STORE</span><span class="w"> </span><span class="n">POSITION</span><span class="w"> </span><span class="n">AND</span><span class="w"> </span><span class="n">TIME</span><span class="w"> </span><span class="n">OF</span><span class="w"> </span><span class="n">ELECTRON</span><span class="w"> </span><span class="n">AND</span><span class="w"> </span><span class="n">COLLISION</span><span class="w"> </span><span class="n">HISTORY</span><span class="w">
  </span><span class="mi">191</span><span class="w"> </span><span class="k">CONTINUE</span><span class="w">
      </span><span class="n">K1</span><span class="o">=</span><span class="n">K1</span><span class="mi">+1</span><span class="w">
      </span><span class="n">XST</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span><span class="o">=</span><span class="n">X</span><span class="w">
      </span><span class="n">YST</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span><span class="o">=</span><span class="n">Y</span><span class="w">
      </span><span class="n">ZST</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span><span class="o">=</span><span class="n">Z</span><span class="w">
      </span><span class="n">TST</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span><span class="o">=</span><span class="n">ST</span><span class="w">
      </span><span class="n">NFGF</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span><span class="o">=</span><span class="n">NFLGFF</span><span class="w">
      </span><span class="n">NFGPP</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span><span class="o">=</span><span class="n">NFLGPPP</span><span class="w">
      </span><span class="n">NFGBR</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span><span class="o">=</span><span class="n">NFLGBRMM</span><span class="w">
      </span><span class="n">TTIME</span><span class="p">(</span><span class="n">K1</span><span class="p">)</span><span class="o">=</span><span class="n">ST</span><span class="o">-</span><span class="n">TLAST</span><span class="w">
      </span><span class="n">NELEC</span><span class="o">=</span><span class="n">NELEC</span><span class="mi">+1</span><span class="w">
      </span><span class="n">NETOT</span><span class="o">=</span><span class="n">NETOT</span><span class="mi">+1</span><span class="w">
 </span><span class="mi">335</span><span class="w">  </span><span class="k">IF</span><span class="p">(</span><span class="n">K1</span><span class="ow">.EQ.</span><span class="mi">150000</span><span class="p">)</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">889</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">CATCH</span><span class="w"> </span><span class="n">SINGLE</span><span class="w"> </span><span class="n">ELECTRON</span><span class="w"> </span><span class="n">CLUSTER</span><span class="w"> </span><span class="n">THAT</span><span class="w"> </span><span class="n">WAS</span><span class="w"> </span><span class="n">ATTACHED</span><span class="err">.</span><span class="w">
</span><span class="n">c</span><span class="w">     </span><span class="k">IF</span><span class="p">(</span><span class="n">NELEC</span><span class="ow">.EQ.</span><span class="mf">1.</span><span class="n">AND</span><span class="ow">.NCLUS.</span><span class="n">EQ</span><span class="mf">.0</span><span class="p">)</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">210</span><span class="w"> 
</span><span class="n">C</span><span class="w">
        </span><span class="k">IF</span><span class="p">(</span><span class="n">NELEC</span><span class="ow">.EQ.</span><span class="p">(</span><span class="n">NCLUS</span><span class="mi">+1</span><span class="p">))</span><span class="w"> </span><span class="k">THEN</span><span class="w">
</span><span class="n">C</span><span class="w">       </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">884</span><span class="p">)</span><span class="w"> </span><span class="n">NELEC</span><span class="p">,</span><span class="n">NCLUS</span><span class="p">,</span><span class="n">NEGION</span><span class="p">,</span><span class="n">J11</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="mi">884</span><span class="w"> </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">' NELEC='</span><span class="p">,</span><span class="l">I6</span><span class="p">,</span><span class="s1">' NCLUS='</span><span class="p">,</span><span class="l">I6</span><span class="p">,</span><span class="s1">' NEGION='</span><span class="p">,</span><span class="l">I3</span><span class="p">,</span><span class="s1">' J11='</span><span class="p">,</span><span class="l">I6</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">LAST</span><span class="w"> </span><span class="n">ELECTRON</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="n">CLUSTER</span><span class="w"> </span><span class="k">DO</span><span class="w"> </span><span class="n">STATISTICS</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="n">PRIMARY</span><span class="w"> </span><span class="n">CLUSTER</span><span class="w">
        </span><span class="k">CALL</span><span class="w"> </span><span class="n">STATS</span><span class="p">(</span><span class="n">J11</span><span class="p">,</span><span class="n">J1</span><span class="p">)</span><span class="w">
        </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">210</span><span class="w">
       </span><span class="k">ENDIF</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">NELEC</span><span class="ow">.LT.</span><span class="p">(</span><span class="n">NCLUS</span><span class="mi">+1</span><span class="p">))</span><span class="w"> </span><span class="k">THEN</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">GET</span><span class="w"> </span><span class="n">NEW</span><span class="w"> </span><span class="n">IONISATION</span><span class="w"> </span><span class="n">ELECTRON</span><span class="w"> </span><span class="n">FROM</span><span class="w"> </span><span class="n">STORE</span><span class="w">
       </span><span class="n">X</span><span class="o">=</span><span class="n">XS</span><span class="p">(</span><span class="n">NELEC</span><span class="p">)</span><span class="w">
       </span><span class="n">Y</span><span class="o">=</span><span class="n">YS</span><span class="p">(</span><span class="n">NELEC</span><span class="p">)</span><span class="w">
       </span><span class="n">Z</span><span class="o">=</span><span class="n">ZS</span><span class="p">(</span><span class="n">NELEC</span><span class="p">)</span><span class="w">
       </span><span class="n">ST</span><span class="o">=</span><span class="n">TS</span><span class="p">(</span><span class="n">NELEC</span><span class="p">)</span><span class="w">
       </span><span class="n">NFLGFF</span><span class="o">=</span><span class="n">NFLGFC</span><span class="p">(</span><span class="n">NELEC</span><span class="p">)</span><span class="w">
       </span><span class="n">NFLGPPP</span><span class="o">=</span><span class="n">NFLGPPC</span><span class="p">(</span><span class="n">NELEC</span><span class="p">)</span><span class="w">
       </span><span class="n">NFLGBRMM</span><span class="o">=</span><span class="n">NFLGBRMC</span><span class="p">(</span><span class="n">NELEC</span><span class="p">)</span><span class="w">
       </span><span class="n">TLAST</span><span class="o">=</span><span class="n">TS</span><span class="p">(</span><span class="n">NELEC</span><span class="p">)</span><span class="w">
       </span><span class="n">E1</span><span class="o">=</span><span class="n">ES</span><span class="p">(</span><span class="n">NELEC</span><span class="p">)</span><span class="w">
       </span><span class="n">DCX1</span><span class="o">=</span><span class="n">DCX</span><span class="p">(</span><span class="n">NELEC</span><span class="p">)</span><span class="w">
       </span><span class="n">DCY1</span><span class="o">=</span><span class="n">DCY</span><span class="p">(</span><span class="n">NELEC</span><span class="p">)</span><span class="w">
       </span><span class="n">DCZ1</span><span class="o">=</span><span class="n">DCZ</span><span class="p">(</span><span class="n">NELEC</span><span class="p">)</span><span class="w">
       </span><span class="k">IF</span><span class="p">(</span><span class="n">E1</span><span class="ow">.LT.</span><span class="n">ETHRM</span><span class="p">)</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">191</span><span class="w">                       
       </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">1</span><span class="w">   
      </span><span class="k">ENDIF</span><span class="w">
</span><span class="n">C</span><span class="w">  </span><span class="n">MAIN</span><span class="w"> </span><span class="n">LOOP</span><span class="w"> </span><span class="k">END</span><span class="w">    
  </span><span class="mi">210</span><span class="w"> </span><span class="k">CONTINUE</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">RESET</span><span class="w"> </span><span class="n">NUMBER</span><span class="w"> </span><span class="n">OF</span><span class="w"> </span><span class="n">EVENTS</span><span class="w"> </span><span class="n">FOR</span><span class="w"> </span><span class="n">BAD</span><span class="w"> </span><span class="n">EVENTS</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">IMIP</span><span class="ow">.GT.</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="n">NDELTA</span><span class="o">=</span><span class="n">NDELTA</span><span class="o">-</span><span class="n">IBADTOT</span><span class="w">
</span><span class="n">C</span><span class="w">
      </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">887</span><span class="p">)</span><span class="w"> </span><span class="n">EMAX</span><span class="p">,</span><span class="n">NEOVFL</span><span class="w">
  </span><span class="mi">887</span><span class="w"> </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">' EMAX='</span><span class="p">,</span><span class="l">D12.7</span><span class="p">,</span><span class="s1">' NEOVFL='</span><span class="p">,</span><span class="l">I5</span><span class="p">)</span><span class="w">  
      </span><span class="k">IF</span><span class="p">(</span><span class="n">EMAX</span><span class="ow">.GT.</span><span class="n">EFINAL</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
      </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">989</span><span class="p">)</span><span class="w"> </span><span class="n">EFINAL</span><span class="p">,</span><span class="n">EMAX</span><span class="w">
  </span><span class="mi">989</span><span class="w"> </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">'INCREASE ENERGY LIMIT FROM'</span><span class="p">,</span><span class="l">D12.6</span><span class="p">,</span><span class="s1">' EV TO AT LEAST'</span><span class="p">,</span><span class="l">D12.6</span><span class="p">,</span><span class="w">
     </span><span class="l">/</span><span class="s1">' EV.'</span><span class="p">)</span><span class="w">
      </span><span class="k">STOP</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w">                                         
      </span><span class="k">RETURN</span><span class="w"> 
  </span><span class="mi">889</span><span class="w"> </span><span class="n">NLEFT</span><span class="o">=</span><span class="n">NCLUS</span><span class="o">-</span><span class="n">NELEC</span><span class="w">
      </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">992</span><span class="p">)</span><span class="w"> </span><span class="n">NPRIME</span><span class="p">,</span><span class="n">NLEFT</span><span class="p">,</span><span class="n">NCLUS</span><span class="w">
  </span><span class="mi">992</span><span class="w"> </span><span class="k">FORMAT</span><span class="p">(</span><span class="l">3</span><span class="p">(</span><span class="l">/</span><span class="p">),</span><span class="s1">' WARNING STOPPED AFTER NPRIME='</span><span class="p">,</span><span class="l">I6</span><span class="p">,</span><span class="s1">' LAST PRIMARY HAS
     /AT LEAST '</span><span class="p">,</span><span class="l">I6</span><span class="p">,</span><span class="s1">' SECONDARIES LEFT TO TRACK OUT OF '</span><span class="p">,</span><span class="l">I6</span><span class="p">,</span><span class="s1">' ELECTRONS 
     /ALREADY IN CLUSTER'</span><span class="p">)</span><span class="w"> 
      </span><span class="k">STOP</span><span class="w">                      
      </span><span class="k">RETURN</span><span class="w">                                                            
      </span><span class="k">END</span><span class="w">
</span></code></pre><pre class="highlight python tab-python"><code><span class="k">def</span> <span class="nf">MONTEFE</span><span class="p">():</span>                                                
      <span class="c"># IMPLICIT #real*8 (A-H,O-Z)</span>
      <span class="c"># IMPLICIT #integer*8 (I-N)                                         </span>
      <span class="c"># global /INPT/</span>
      <span class="k">global</span> <span class="n">NGAS</span><span class="p">,</span><span class="n">NSTEP</span><span class="p">,</span><span class="n">NANISO</span><span class="p">,</span><span class="n">EFINAL</span><span class="p">,</span><span class="n">ESTEP</span><span class="p">,</span><span class="n">AKT</span><span class="p">,</span><span class="n">ARY</span><span class="p">,</span><span class="n">TEMPC</span><span class="p">,</span><span class="n">TORR</span><span class="p">,</span><span class="n">IPEN</span>
      <span class="c"># global /INPT1/</span>
      <span class="k">global</span> <span class="n">NDVEC</span>
      <span class="c"># global /CNSTS1/</span>
      <span class="k">global</span> <span class="n">CONST1</span><span class="p">,</span><span class="n">CONST2</span><span class="p">,</span><span class="n">CONST3</span><span class="p">,</span><span class="n">CONST4</span><span class="p">,</span><span class="n">CONST5</span>                  
      <span class="c"># global /SETP/</span>
      <span class="k">global</span> <span class="n">TMAX</span><span class="p">,</span><span class="n">SMALL</span><span class="p">,</span><span class="n">API</span><span class="p">,</span><span class="n">ESTART</span><span class="p">,</span><span class="n">THETA</span><span class="p">,</span><span class="n">PHI</span><span class="p">,</span><span class="n">TCFMAX</span><span class="c">#(10)</span>
      <span class="k">global</span> <span class="n">TCFMAX1</span><span class="p">,</span><span class="n">RSTART</span><span class="p">,</span><span class="n">EFIELD</span><span class="p">,</span><span class="n">ETHRM</span><span class="p">,</span><span class="n">ECUT</span><span class="p">,</span><span class="n">NDELTA</span><span class="p">,</span><span class="n">IMIP</span><span class="p">,</span><span class="n">IWRITE</span>                    
      <span class="c"># global /LARGE/</span>
      <span class="k">global</span> <span class="n">CF</span><span class="c">#(20000,512)</span>
      <span class="k">global</span> <span class="n">EIN</span><span class="c">#(512)</span>
      <span class="k">global</span> <span class="n">TCF</span><span class="c">#(20000)</span>
      <span class="k">global</span> <span class="n">IARRY</span><span class="c">#(512),</span>
      <span class="k">global</span> <span class="n">RGAS</span><span class="c">#(512)</span>
      <span class="k">global</span> <span class="n">IPN</span><span class="c">#(512)</span>
      <span class="k">global</span> <span class="n">WPL</span><span class="c">#(512)</span>
      <span class="k">global</span> <span class="n">IZBR</span><span class="c">#(512)</span>
      <span class="k">global</span> <span class="n">IPLAST</span><span class="p">,</span><span class="n">PENFRA</span><span class="c">#[3,512]</span>
      <span class="c"># global /LARGEN/</span>
      <span class="k">global</span> <span class="n">CFN</span><span class="c">#(20000,60),</span>
      <span class="k">global</span> <span class="n">TCFN</span><span class="c">#(20000)</span>
      <span class="k">global</span> <span class="n">SCLENUL</span><span class="c">#(60)</span>
      <span class="k">global</span> <span class="n">NPLAST</span>
      <span class="c"># global /OUTPT/</span>
      <span class="k">global</span> <span class="n">ICOLL</span><span class="c">#(30)</span>
      <span class="k">global</span> <span class="n">NETOT</span><span class="p">,</span><span class="n">NPRIME</span><span class="p">,</span><span class="n">TMAX1</span><span class="p">,</span><span class="n">TIME</span><span class="c">#(300)</span>
      <span class="k">global</span> <span class="n">NNULL</span><span class="p">,</span><span class="n">NITOT</span><span class="p">,</span><span class="n">ICOLN</span><span class="c">#(512)</span>
      <span class="k">global</span> <span class="n">ICOLNN</span><span class="c">#(60)</span>
      <span class="k">global</span> <span class="n">NREAL</span><span class="p">,</span><span class="n">NEXCTOT</span> 
      <span class="c"># global /RLTVY/</span>
      <span class="k">global</span> <span class="n">BET</span><span class="c">#(20000)</span>
      <span class="k">global</span> <span class="n">GAM</span><span class="c">#(20000)</span>
      <span class="k">global</span> <span class="n">VC</span><span class="p">,</span><span class="n">EMS</span>
      <span class="c"># global /STTS/</span>
      <span class="k">global</span> <span class="n">XST</span><span class="c">#(150000)</span>
      <span class="k">global</span> <span class="n">YST</span><span class="c">#(150000)</span>
      <span class="k">global</span> <span class="n">ZST</span><span class="c">#(150000)</span>
      <span class="k">global</span> <span class="n">TST</span><span class="c">#(150000),</span>
      <span class="k">global</span> <span class="n">TTIME</span><span class="c">#(150000)</span>
      <span class="k">global</span> <span class="n">NFGF</span><span class="c">#(150000)</span>
      <span class="k">global</span> <span class="n">NFGPP</span><span class="c">#(150000)</span>
      <span class="k">global</span> <span class="n">NFGBR</span><span class="c">#(150000)</span>
      <span class="k">global</span> <span class="n">NELEC</span><span class="p">,</span><span class="n">NEGION</span><span class="p">,</span><span class="n">EST1</span><span class="p">,</span><span class="n">EST2</span>
      <span class="c"># global /STEXC/</span>
      <span class="k">global</span> <span class="n">XSTEXC</span><span class="c">#(150000)</span>
      <span class="k">global</span> <span class="n">YSTEXC</span><span class="c">#(150000)</span>
      <span class="k">global</span> <span class="n">ZSTEXC</span><span class="c">#(150000),</span>
      <span class="k">global</span> <span class="n">TSTEXC</span><span class="c">#(150000)</span>
      <span class="k">global</span> <span class="n">NSTEXC</span>
      <span class="c"># global /STEXCNUL/</span>
      <span class="k">global</span> <span class="n">XSTN</span><span class="c">#(150000)</span>
      <span class="k">global</span> <span class="n">YSTN</span><span class="c">#(150000)</span>
      <span class="k">global</span> <span class="n">ZSTN</span><span class="c">#(150000),</span>
      <span class="k">global</span> <span class="n">TSTN</span><span class="c">#(150000)</span>
      <span class="k">global</span> <span class="n">IDNUL</span><span class="c">#(150000)</span>
      <span class="k">global</span> <span class="n">NEXCNUL</span>
      <span class="c"># global /IONC/</span>
      <span class="k">global</span> <span class="n">DOUBLE</span><span class="c">#(6,20000)</span>
      <span class="k">global</span> <span class="n">CMINIXSC</span><span class="c">#[6]</span>
      <span class="k">global</span> <span class="n">CMINEXSC</span><span class="c">#[6]</span>
      <span class="k">global</span> <span class="n">ECLOSS</span><span class="c">#[6],</span>
      <span class="k">global</span> <span class="n">WPLN</span><span class="c">#[6]</span>
      <span class="k">global</span> <span class="n">ICOUNT</span><span class="p">,</span><span class="n">AVPFRAC</span><span class="c">#(3,6) </span>
      <span class="c"># global /IONFL/</span>
      <span class="k">global</span> <span class="n">NC0</span><span class="c">#(512)</span>
      <span class="k">global</span> <span class="n">EC0</span><span class="c">#(512)</span>
      <span class="k">global</span> <span class="n">NG1</span><span class="c">#(512)</span>
      <span class="k">global</span> <span class="n">EG1</span><span class="c">#(512)</span>
      <span class="k">global</span> <span class="n">NG2</span><span class="c">#(512),</span>
      <span class="k">global</span> <span class="n">EG2</span><span class="c">#(512)</span>
      <span class="k">global</span> <span class="n">WKLM</span><span class="c">#(512)</span>
      <span class="k">global</span> <span class="n">DSTFL</span><span class="c">#(512)</span>
      <span class="c"># global /IONMOD/</span>
      <span class="k">global</span> <span class="n">ESPLIT</span><span class="c">#(512,20)</span>
      <span class="k">global</span> <span class="n">IONMODEL</span><span class="c">#(512)</span>
      <span class="c"># global /ANIS/</span>
      <span class="k">global</span> <span class="n">PSCT</span><span class="c">#(20000,512)</span>
      <span class="k">global</span> <span class="n">ANGCT</span><span class="c">#(20000,512)</span>
      <span class="k">global</span> <span class="n">INDEX</span><span class="c">#(512)</span>
      <span class="k">global</span> <span class="n">NISO</span>
      <span class="c"># global /CASRS/</span>
      <span class="k">global</span> <span class="n">ECAS</span><span class="c">#(400)</span>
      <span class="k">global</span> <span class="n">XCAS</span><span class="c">#(400)</span>
      <span class="k">global</span> <span class="n">YCAS</span><span class="c">#(400)</span>
      <span class="k">global</span> <span class="n">ZCAS</span><span class="c">#(400)</span>
      <span class="k">global</span> <span class="n">DRXS</span><span class="c">#(400),</span>
      <span class="k">global</span> <span class="n">DRYS</span><span class="c">#(400)</span>
      <span class="k">global</span> <span class="n">DRZS</span><span class="c">#(400)</span>
      <span class="k">global</span> <span class="n">TT1</span><span class="c">#(400)</span>
      <span class="k">global</span> <span class="n">NFLGF</span><span class="c">#(400)</span>
      <span class="k">global</span> <span class="n">NFLGPP</span><span class="c">#(400)</span>
      <span class="k">global</span> <span class="n">IEVNTL</span>
      <span class="c"># global /COMP/</span>
      <span class="k">global</span> <span class="n">LCMPLCFLG</span><span class="p">,</span><span class="n">LRAY</span><span class="p">,</span><span class="n">LRFLG</span><span class="p">,</span><span class="n">LPAP</span><span class="p">,</span><span class="n">LPFLG</span><span class="p">,</span><span class="n">LBRM</span><span class="p">,</span><span class="n">LBFLG</span><span class="p">,</span><span class="n">LPEFLG</span>
      <span class="c"># global /BREMG/</span>
      <span class="k">global</span> <span class="n">EBRGAM</span><span class="c">#(10)</span>
      <span class="k">global</span> <span class="n">BRDCOSX</span><span class="c">#(10)</span>
      <span class="k">global</span> <span class="n">BRDCOSY</span><span class="c">#(10)</span>
      <span class="k">global</span> <span class="n">BRDCOSZ</span><span class="c">#[10],</span>
      <span class="k">global</span> <span class="n">BRX</span><span class="c">#(10)</span>
      <span class="k">global</span> <span class="n">BRY</span><span class="c">#(10)</span>
      <span class="k">global</span> <span class="n">BRZ</span><span class="c">#[10]</span>
      <span class="k">global</span> <span class="n">BRT</span><span class="c">#(10)</span>
      <span class="k">global</span> <span class="n">EBRTOT</span><span class="c">#[6]</span>
      <span class="k">global</span> <span class="n">NBREM</span><span class="c">#[6]</span>
      <span class="c"># global /CASRSB/</span>
      <span class="k">global</span> <span class="n">ECASB</span><span class="c">#[400]</span>
      <span class="k">global</span> <span class="n">XCASB</span><span class="c">#[400]</span>
      <span class="k">global</span> <span class="n">YCASB</span><span class="c">#[400]</span>
      <span class="k">global</span> <span class="n">ZCASB</span><span class="c">#[400],</span>
      <span class="k">global</span> <span class="n">DRXB</span><span class="c">#[400]</span>
      <span class="k">global</span> <span class="n">DRYB</span><span class="c">#[400]</span>
      <span class="k">global</span> <span class="n">DRZB</span><span class="c">#[400]</span>
      <span class="k">global</span> <span class="n">TTB1</span><span class="c">#(400)</span>
      <span class="k">global</span> <span class="n">NFLGFB</span><span class="c">#[400]</span>
      <span class="k">global</span> <span class="n">NFLGPPB</span><span class="c">#[400],</span>
      <span class="k">global</span> <span class="n">IEVNTLB</span>
      <span class="c"># global /CASRSE/</span>
      <span class="k">global</span> <span class="n">ECASE</span><span class="c">#(400)</span>
      <span class="k">global</span> <span class="n">XCASE</span><span class="c">#(400)</span>
      <span class="k">global</span> <span class="n">YCASE</span><span class="c">#(400)</span>
      <span class="k">global</span> <span class="n">ZCASE</span><span class="c">#(400),</span>
      <span class="k">global</span> <span class="n">DRXCE</span><span class="c">#(400)</span>
      <span class="k">global</span> <span class="n">DRYCE</span><span class="c">#(400)</span>
      <span class="k">global</span> <span class="n">DRZCE</span><span class="c">#(400)</span>
      <span class="k">global</span> <span class="n">TCASE</span><span class="c">#(400),</span>
      <span class="k">global</span> <span class="n">NFLGFE</span><span class="c">#(400)</span>
      <span class="k">global</span> <span class="n">NFLGPPE</span><span class="c">#(400)</span>
      <span class="k">global</span> <span class="n">IEVENTE</span>
      <span class="c"># global /ECASC/</span>
      <span class="k">global</span> <span class="n">NEGAS</span><span class="c">#(512)</span>
      <span class="k">global</span> <span class="n">LEGAS</span><span class="c">#(512)</span>
      <span class="k">global</span> <span class="n">IESHELL</span><span class="c">#(512)</span>
      <span class="k">global</span> <span class="n">IECASC</span>
      <span class="c"># global /IDEXC/</span>
      <span class="k">global</span> <span class="n">NGEXC1</span><span class="p">,</span><span class="n">NGEXC2</span><span class="p">,</span><span class="n">NGEXC3</span><span class="p">,</span><span class="n">NGEXC4</span><span class="p">,</span><span class="n">NGEXC5</span><span class="p">,</span><span class="n">NGEXC6</span><span class="p">,</span><span class="n">IDG1</span><span class="p">,</span><span class="n">IDG2</span><span class="p">,</span><span class="n">IDG3</span><span class="p">,</span><span class="n">IDG4</span><span class="p">,</span><span class="n">IDG5</span><span class="p">,</span><span class="n">IDG6</span>
      <span class="n">NGAS</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NGAS</span>
      <span class="n">NSTEP</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NSTEP</span>
      <span class="n">NANISO</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NANISO</span>
      <span class="n">EFINAL</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">EFINAL</span>
      <span class="n">ESTEP</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">ESTEP</span>
      <span class="n">AKT</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">AKT</span>
      <span class="n">ARY</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">ARY</span>
      <span class="n">TEMPC</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">TEMPC</span>
      <span class="n">TORR</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">TORR</span>
      <span class="n">IPEN</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">IPEN</span>
      <span class="n">NDVEC</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NDVEC</span>
      <span class="n">CONST1</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">CONST1</span>
      <span class="n">CONST2</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">CONST2</span>
      <span class="n">CONST3</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">CONST3</span>
      <span class="n">CONST4</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">CONST4</span>
      <span class="n">CONST5</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">CONST5</span>                  
      <span class="n">TMAX</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">TMAX</span>
      <span class="n">SMALL</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">SMALL</span>
      <span class="n">API</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">API</span>
      <span class="n">ESTART</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">ESTART</span>
      <span class="n">THETA</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">THETA</span>
      <span class="n">PHI</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">PHI</span>
      <span class="n">TCFMAX</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">TCFMAX</span>
      <span class="n">TCFMAX1</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">TCFMAX1</span>
      <span class="n">RSTART</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">RSTART</span>
      <span class="n">EFIELD</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">EFIELD</span>
      <span class="n">ETHRM</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">ETHRM</span>
      <span class="n">ECUT</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">ECUT</span>
      <span class="n">NDELTA</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NDELTA</span>
      <span class="n">IMIP</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">IMIP</span>
      <span class="n">IWRITE</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">IWRITE</span>                    
      <span class="n">CF</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">CF</span>
      <span class="n">EIN</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">EIN</span>
      <span class="n">TCF</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">TCF</span>
      <span class="n">IARRY</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">IARRY</span>
      <span class="n">RGAS</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">RGAS</span>
      <span class="n">IPN</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">IPN</span>
      <span class="n">WPL</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">WPL</span>
      <span class="n">IZBR</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">IZBR</span>
      <span class="n">IPLAST</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">IPLAST</span>
      <span class="n">PENFRA</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">PENFRA</span>
      <span class="n">CFN</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">CFN</span>
      <span class="n">TCFN</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">TCFN</span>
      <span class="n">SCLENUL</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">SCLENUL</span>
      <span class="n">NPLAST</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NPLAST</span>
      <span class="n">ICOLL</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">ICOLL</span>
      <span class="n">NETOT</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NETOT</span>
      <span class="n">NPRIME</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NPRIME</span>
      <span class="n">TMAX1</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">TMAX1</span>
      <span class="n">TIME</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">TIME</span>
      <span class="n">NNULL</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NNULL</span>
      <span class="n">NITOT</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NITOT</span>
      <span class="n">ICOLN</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">ICOLN</span>
      <span class="n">ICOLNN</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">ICOLNN</span>
      <span class="n">NREAL</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NREAL</span>
      <span class="n">NEXCTOT</span> <span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NEXCTOT</span> 
      <span class="n">BET</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">BET</span>
      <span class="n">GAM</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">GAM</span>
      <span class="n">VC</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">VC</span>
      <span class="n">EMS</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">EMS</span>
      <span class="n">XST</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">XST</span>
      <span class="n">YST</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">YST</span>
      <span class="n">ZST</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">ZST</span>
      <span class="n">TST</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">TST</span>
      <span class="n">TTIME</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">TTIME</span>
      <span class="n">NFGF</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NFGF</span>
      <span class="n">NFGPP</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NFGPP</span>
      <span class="n">NFGBR</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NFGBR</span>
      <span class="n">NELEC</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NELEC</span>
      <span class="n">NEGION</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NEGION</span>
      <span class="n">EST1</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">EST1</span>
      <span class="n">EST2</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">EST2</span>
      <span class="n">XSTEXC</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">XSTEXC</span>
      <span class="n">YSTEXC</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">YSTEXC</span>
      <span class="n">ZSTEXC</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">ZSTEXC</span>
      <span class="n">TSTEXC</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">TSTEXC</span>
      <span class="n">NSTEXC</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NSTEXC</span>
      <span class="n">XSTN</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">XSTN</span>
      <span class="n">YSTN</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">YSTN</span>
      <span class="n">ZSTN</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">ZSTN</span>
      <span class="n">TSTN</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">TSTN</span>
      <span class="n">IDNUL</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">IDNUL</span>
      <span class="n">NEXCNUL</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NEXCNUL</span>
      <span class="n">DOUBLE</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">DOUBLE</span>
      <span class="n">CMINIXSC</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">CMINIXSC</span>
      <span class="n">CMINEXSC</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">CMINEXSC</span>
      <span class="n">ECLOSS</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">ECLOSS</span>
      <span class="n">WPLN</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">WPLN</span>
      <span class="n">ICOUNT</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">ICOUNT</span>
      <span class="n">AVPFRAC</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">AVPFRAC</span>
      <span class="n">NC0</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NC0</span>
      <span class="n">EC0</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">EC0</span>
      <span class="n">NG1</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NG1</span>
      <span class="n">EG1</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">EG1</span>
      <span class="n">NG2</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NG2</span>
      <span class="n">EG2</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">EG2</span>
      <span class="n">WKLM</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">WKLM</span>
      <span class="n">DSTFL</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">DSTFL</span>
      <span class="n">ESPLIT</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">ESPLIT</span>
      <span class="n">IONMODEL</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">IONMODEL</span>
      <span class="n">PSCT</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">PSCT</span>
      <span class="n">ANGCT</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">ANGCT</span>
      <span class="n">INDEX</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">INDEX</span>
      <span class="n">NISO</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NISO</span>
      <span class="n">ECAS</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">ECAS</span>
      <span class="n">XCAS</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">XCAS</span>
      <span class="n">YCAS</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">YCAS</span>
      <span class="n">ZCAS</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">ZCAS</span>
      <span class="n">DRXS</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">DRXS</span>
      <span class="n">DRYS</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">DRYS</span>
      <span class="n">DRZS</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">DRZS</span>
      <span class="n">TT1</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">TT1</span>
      <span class="n">NFLGF</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NFLGF</span>
      <span class="n">NFLGPP</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NFLGPP</span>
      <span class="n">IEVNTL</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">IEVNTL</span>
      <span class="n">LCMPLCFLG</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">LCMPLCFLG</span>
      <span class="n">LRAY</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">LRAY</span>
      <span class="n">LRFLG</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">LRFLG</span>
      <span class="n">LPAP</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">LPAP</span>
      <span class="n">LPFLG</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">LPFLG</span>
      <span class="n">LBRM</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">LBRM</span>
      <span class="n">LBFLG</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">LBFLG</span>
      <span class="n">LPEFLG</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">LPEFLG</span>
      <span class="n">EBRGAM</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">EBRGAM</span>
      <span class="n">BRDCOSX</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">BRDCOSX</span>
      <span class="n">BRDCOSY</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">BRDCOSY</span>
      <span class="n">BRDCOSZ</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">BRDCOSZ</span>
      <span class="n">BRX</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">BRX</span>
      <span class="n">BRY</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">BRY</span>
      <span class="n">BRZ</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">BRZ</span>
      <span class="n">BRT</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">BRT</span>
      <span class="n">EBRTOT</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">EBRTOT</span>
      <span class="n">NBREM</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NBREM</span>
      <span class="n">ECASB</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">ECASB</span>
      <span class="n">XCASB</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">XCASB</span>
      <span class="n">YCASB</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">YCASB</span>
      <span class="n">ZCASB</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">ZCASB</span>
      <span class="n">DRXB</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">DRXB</span>
      <span class="n">DRYB</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">DRYB</span>
      <span class="n">DRZB</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">DRZB</span>
      <span class="n">TTB1</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">TTB1</span>
      <span class="n">NFLGFB</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NFLGFB</span>
      <span class="n">NFLGPPB</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NFLGPPB</span>
      <span class="n">IEVNTLB</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">IEVNTLB</span>
      <span class="n">ECASE</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">ECASE</span>
      <span class="n">XCASE</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">XCASE</span>
      <span class="n">YCASE</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">YCASE</span>
      <span class="n">ZCASE</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">ZCASE</span>
      <span class="n">DRXCE</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">DRXCE</span>
      <span class="n">DRYCE</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">DRYCE</span>
      <span class="n">DRZCE</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">DRZCE</span>
      <span class="n">TCASE</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">TCASE</span>
      <span class="n">NFLGFE</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NFLGFE</span>
      <span class="n">NFLGPPE</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NFLGPPE</span>
      <span class="n">IEVENTE</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">IEVENTE</span>
      <span class="n">NEGAS</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NEGAS</span>
      <span class="n">LEGAS</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">LEGAS</span>
      <span class="n">IESHELL</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">IESHELL</span>
      <span class="n">IECASC</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">IECASC</span>
      <span class="n">NGEXC1</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NGEXC1</span>
      <span class="n">NGEXC2</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NGEXC2</span>
      <span class="n">NGEXC3</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NGEXC3</span>
      <span class="n">NGEXC4</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NGEXC4</span>
      <span class="n">NGEXC5</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NGEXC5</span>
      <span class="n">NGEXC6</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">NGEXC6</span>
      <span class="n">IDG1</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">IDG1</span>
      <span class="n">IDG2</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">IDG2</span>
      <span class="n">IDG3</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">IDG3</span>
      <span class="n">IDG4</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">IDG4</span>
      <span class="n">IDG5</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">IDG5</span>
      <span class="n">IDG6</span><span class="o">=</span><span class="n">conf</span><span class="o">.</span><span class="n">IDG6</span>
      <span class="c"># DIMENSION </span>
      <span class="n">XS</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">150000</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
      <span class="n">YS</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">150000</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
      <span class="n">ZS</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">150000</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
      <span class="n">TS</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">150000</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
      <span class="n">ES</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">150000</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
      <span class="n">DCX</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">150000</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
      <span class="n">DCY</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">150000</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
      <span class="n">DCZ</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">150000</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
      <span class="n">NFLGFC</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">150000</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
      <span class="n">NFLGPPC</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">150000</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
      <span class="n">NFLGBRMC</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">150000</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
      <span class="c"># DIMENSION </span>
      <span class="n">TEMP</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">20000</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
      <span class="c">#     DIMENSION ETEMP(1000)</span>
      <span class="c"># ----------------------------------------------------------------------</span>
      <span class="c">#      RELATIVISTIC VERSION SEPTEMBER 2013</span>
      <span class="c">#      ELECTRIC FIELD ALONG Z AXIS. NO MAGNETIC FIELD. </span>
      <span class="c">#      TRACKS DELTA ELECTRONS AND UPDATES ARRAYS CONTAINING POSITION AND</span>
      <span class="c">#      TIME OF THERMALISED ELECTRONS.</span>
      <span class="c">#     CALCULATES NUMBER OF PRODUCED ELECTRONS PER PRIMARY AND OTHER</span>
      <span class="c">#     HIGHER FANO FACTORS. </span>
      <span class="c">#     RANGE IS ACCURATE ONLY FOR ANISOTROPIC X-SECTIONS              </span>
      <span class="c"># ----------------------------------------------------------------------</span>
      <span class="c"># VARYING ENERGY STEPS</span>
      <span class="k">if</span><span class="p">(</span><span class="n">EFINAL</span> <span class="o">&lt;=</span> <span class="mf">140000.</span><span class="p">):</span>
            <span class="n">ESTEP1</span><span class="o">=</span><span class="p">(</span><span class="n">EFINAL</span><span class="o">-</span><span class="mf">16000.0</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">4000</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
            <span class="n">ESTEP1</span><span class="o">=</span><span class="mf">20.0</span>
            <span class="n">ESTEP2</span><span class="o">=</span><span class="p">(</span><span class="n">EFINAL</span><span class="o">-</span><span class="mf">92000.0</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">4000</span><span class="p">)</span>
      <span class="c"># endif</span>
      <span class="n">NPRINT</span><span class="o">=</span><span class="mi">0</span>
      <span class="n">J20000</span><span class="o">=</span><span class="mi">20000</span> 
      <span class="n">J300</span><span class="o">=</span><span class="mi">300</span>
      <span class="n">API</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="o">-</span><span class="mf">1.00</span><span class="p">)</span>
      <span class="n">SMALL</span><span class="o">=</span><span class="mf">1.0E-20</span>                                                     
      <span class="n">TMAX1</span><span class="o">=</span><span class="mf">0.00</span> 
      <span class="n">EMAX</span><span class="o">=</span><span class="mf">0.00</span>                                                      
      <span class="n">RDUM</span><span class="o">=</span><span class="n">RSTART</span>                                                       
      <span class="n">CONST9</span><span class="o">=</span><span class="n">CONST3</span><span class="o">*</span><span class="mf">0.010</span>
      <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">300</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">TIME</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">=</span><span class="mf">0.00</span>
      <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">30</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">ICOLL</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
      <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">512</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">ICOLN</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
      <span class="n">NREAL</span><span class="o">=</span><span class="mi">0</span>
      <span class="n">NNULL</span><span class="o">=</span><span class="mi">0</span>
      <span class="n">NETOT</span><span class="o">=</span><span class="mi">0</span>
      <span class="n">NEXCTOT</span><span class="o">=</span><span class="mi">0</span>
      <span class="n">NITOT</span><span class="o">=</span><span class="mi">0</span>
      <span class="n">NMXADD</span><span class="o">=</span><span class="mi">0</span>
      <span class="n">NTMPFLG</span><span class="o">=</span><span class="mi">0</span>
      <span class="n">BP</span><span class="o">=</span><span class="n">EFIELD</span><span class="o">*</span><span class="n">EFIELD</span><span class="o">*</span><span class="n">CONST1</span>                                           
      <span class="n">F1</span><span class="o">=</span><span class="n">EFIELD</span><span class="o">*</span><span class="n">CONST2</span>                                                  
      <span class="n">F2</span><span class="o">=</span><span class="n">EFIELD</span><span class="o">*</span><span class="n">CONST3</span>                                                  
      <span class="n">F4</span><span class="o">=</span><span class="mf">2.00</span><span class="o">*</span><span class="n">API</span>
      <span class="n">THETA1</span><span class="o">=</span><span class="n">THETA</span>
      <span class="n">PHI1</span><span class="o">=</span><span class="n">PHI</span>
      <span class="c"># CALCULATE MAXIMUM COLLISION FREQUENCY    </span>
      <span class="n">TLIM</span><span class="o">=</span><span class="mf">0.0</span> 
      <span class="k">for</span> <span class="n">J</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">20000</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">TEMP</span><span class="p">[</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">TCFN</span><span class="p">[</span><span class="n">J</span><span class="p">]</span><span class="o">+</span><span class="n">TCF</span><span class="p">[</span><span class="n">J</span><span class="p">]</span> 
            <span class="k">if</span><span class="p">(</span><span class="n">TLIM</span> <span class="o">&lt;</span> <span class="n">TEMP</span><span class="p">[</span><span class="n">J</span><span class="p">]):</span>
                  <span class="n">TLIM</span><span class="o">=</span><span class="n">TEMP</span><span class="p">[</span><span class="n">J</span><span class="p">]</span> 
            <span class="c"># 111 CONTINUE</span>
      <span class="n">NEOVFL</span><span class="o">=</span><span class="mi">0</span>
      <span class="n">J1</span><span class="o">=</span><span class="mi">0</span>
      <span class="c"># START OF PRIMARY EVENT LOOP </span>
      <span class="k">for</span> <span class="n">J11</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">NDELTA</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">J1</span><span class="o">=</span><span class="n">J1</span><span class="o">+</span><span class="mi">1</span>
            <span class="n">NPRIME</span><span class="o">=</span><span class="n">J1</span>
            <span class="n">NGEXC1</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">NGEXC2</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">NGEXC3</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">NGEXC4</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">NGEXC5</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">NGEXC6</span><span class="o">=</span><span class="mi">0</span>
            <span class="c">#     INITIAL DIRECTION COSINES FOR ELECTRON BEAM                    </span>
            <span class="n">DCZ1</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">THETA1</span><span class="p">)</span>
            <span class="n">DCX1</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">THETA1</span><span class="p">)</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">PHI1</span><span class="p">)</span>                                      
            <span class="n">DCY1</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">THETA1</span><span class="p">)</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">PHI1</span><span class="p">)</span>
            <span class="n">NFLGFF</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">NFLGPPP</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">NFLGBRMM</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">NFLGHIGH</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">EST1</span><span class="o">=</span><span class="n">ESTART</span>
            <span class="n">E1</span><span class="o">=</span><span class="n">ESTART</span>
            <span class="n">X</span><span class="o">=</span><span class="mf">0.00</span>
            <span class="n">Y</span><span class="o">=</span><span class="mf">0.00</span>
            <span class="n">Z</span><span class="o">=</span><span class="mf">0.00</span>
            <span class="n">K1</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">KEXC</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">NSTEXC</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">NEXCNUL</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">NCLUS</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">NELEC</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">NEGION</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">TLAST</span><span class="o">=</span><span class="mf">0.00</span>
            <span class="n">ST</span><span class="o">=</span><span class="mf">0.00</span>
            <span class="n">TDASH</span><span class="o">=</span><span class="mf">0.00</span>
            <span class="k">if</span><span class="p">(</span><span class="n">IMIP</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
                  <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                  <span class="k">if</span><span class="p">(</span><span class="n">IMIP</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">):</span>
                        <span class="c"># READIN FIRST ELECTRON FROM BETA DECAY OR XRAY UNTHERMALISED CLUSTERS</span>
                        <span class="n">CASRES</span><span class="p">(</span><span class="n">J11</span><span class="p">,</span><span class="n">IBADTOT</span><span class="p">,</span><span class="n">IBAD1</span><span class="p">)</span>
                        <span class="c">#  SKIP IF BAD EVENT</span>
                        <span class="k">if</span><span class="p">(</span><span class="n">IBAD1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                              <span class="n">J1</span><span class="o">=</span><span class="n">J1</span><span class="o">-</span><span class="mi">1</span>
                              <span class="n">flag1</span><span class="o">=</span><span class="mi">0</span>
                              <span class="k">continue</span>
                        <span class="c"># endif </span>
                  <span class="k">elif</span><span class="p">(</span><span class="n">IMIP</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">:</span>
                        <span class="c"># READ IN FIRST ELECTRON FROM MIP INTERACTION</span>
                        <span class="n">CASREM</span><span class="p">(</span><span class="n">J11</span><span class="p">)</span>
                        <span class="n">EST1</span><span class="o">=</span><span class="n">ECAS</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">EST2</span><span class="o">=</span><span class="n">EST1</span>
                  <span class="c"># endif</span>
                  <span class="n">X</span><span class="o">=</span><span class="n">XCAS</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                  <span class="n">Y</span><span class="o">=</span><span class="n">YCAS</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                  <span class="n">Z</span><span class="o">=</span><span class="n">ZCAS</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                  <span class="n">ST</span><span class="o">=</span><span class="n">TT1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                  <span class="n">TS</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">TT1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                  <span class="n">E1</span><span class="o">=</span><span class="n">ECAS</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                  <span class="n">DCZ1</span><span class="o">=</span><span class="n">DRZS</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                  <span class="n">DCY1</span><span class="o">=</span><span class="n">DRYS</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                  <span class="n">DCX1</span><span class="o">=</span><span class="n">DRXS</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                  <span class="n">NFLGFF</span><span class="o">=</span><span class="n">NFLGF</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                  <span class="n">NFLGPPP</span><span class="o">=</span><span class="n">NFLGPP</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                  <span class="n">NFLGBRMM</span><span class="o">=</span><span class="mi">0</span>
                  <span class="n">NFLGHIGH</span><span class="o">=</span><span class="n">NFLGFF</span>
                  <span class="c"># PUT REMAINDER OF ELECTRONS INTO CLUSTER STORE</span>
                  <span class="n">ISDUM</span><span class="o">=</span><span class="mi">0</span>
                  <span class="k">for</span> <span class="n">IST</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">IEVNTL</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                        <span class="n">ISDUM</span><span class="o">=</span><span class="n">ISDUM</span><span class="o">+</span><span class="mi">1</span>
                        <span class="n">XS</span><span class="p">[</span><span class="n">ISDUM</span><span class="p">]</span><span class="o">=</span><span class="n">XCAS</span><span class="p">[</span><span class="n">IST</span><span class="p">]</span>
                        <span class="n">YS</span><span class="p">[</span><span class="n">ISDUM</span><span class="p">]</span><span class="o">=</span><span class="n">YCAS</span><span class="p">[</span><span class="n">IST</span><span class="p">]</span>
                        <span class="n">ZS</span><span class="p">[</span><span class="n">ISDUM</span><span class="p">]</span><span class="o">=</span><span class="n">ZCAS</span><span class="p">[</span><span class="n">IST</span><span class="p">]</span>
                        <span class="n">TS</span><span class="p">[</span><span class="n">ISDUM</span><span class="p">]</span><span class="o">=</span><span class="n">TT1</span><span class="p">[</span><span class="n">IST</span><span class="p">]</span>
                        <span class="n">ES</span><span class="p">[</span><span class="n">ISDUM</span><span class="p">]</span><span class="o">=</span><span class="n">ECAS</span><span class="p">[</span><span class="n">IST</span><span class="p">]</span>
                        <span class="n">DCX</span><span class="p">[</span><span class="n">ISDUM</span><span class="p">]</span><span class="o">=</span><span class="n">DRXS</span><span class="p">[</span><span class="n">IST</span><span class="p">]</span>
                        <span class="n">DCY</span><span class="p">[</span><span class="n">ISDUM</span><span class="p">]</span><span class="o">=</span><span class="n">DRYS</span><span class="p">[</span><span class="n">IST</span><span class="p">]</span>
                        <span class="n">DCZ</span><span class="p">[</span><span class="n">ISDUM</span><span class="p">]</span><span class="o">=</span><span class="n">DRZS</span><span class="p">[</span><span class="n">IST</span><span class="p">]</span>
                        <span class="n">NFLGFC</span><span class="p">[</span><span class="n">ISDUM</span><span class="p">]</span><span class="o">=</span><span class="n">NFLGF</span><span class="p">[</span><span class="n">IST</span><span class="p">]</span>
                        <span class="n">NFLGPPC</span><span class="p">[</span><span class="n">ISDUM</span><span class="p">]</span><span class="o">=</span><span class="n">NFLGPP</span><span class="p">[</span><span class="n">IST</span><span class="p">]</span>
                        <span class="n">NFLGBRMC</span><span class="p">[</span><span class="n">ISDUM</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
                        <span class="n">NCLUS</span><span class="o">=</span><span class="n">ISDUM</span>
                        <span class="k">if</span><span class="p">(</span><span class="n">NFLGF</span><span class="p">[</span><span class="n">IST</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">NFLGHIGH</span><span class="p">):</span>
                              <span class="n">NFLGHIGH</span><span class="o">=</span><span class="n">NFLGF</span><span class="p">[</span><span class="n">IST</span><span class="p">]</span>
                        <span class="c"># 35 CONTINUE</span>

                  <span class="c"># START OF LOOP FOR NEWLY CREATED ELECTRONS</span>
            <span class="c"># 1 CONTINUE</span>
            <span class="n">flag1</span><span class="o">=</span><span class="mi">1</span>
            <span class="n">flag210</span><span class="o">=</span><span class="mi">0</span>
            <span class="k">while</span><span class="p">(</span><span class="n">flag1</span><span class="p">):</span>  
                  <span class="n">flag1</span><span class="o">=</span><span class="mi">0</span>                                                       
                  <span class="n">R1</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span>
                  <span class="n">T</span><span class="o">=-</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">R1</span><span class="p">)</span><span class="o">/</span><span class="n">TLIM</span><span class="o">+</span><span class="n">TDASH</span>
                  <span class="n">TDASH</span><span class="o">=</span><span class="n">T</span>
                  <span class="c">#     AP=DCZ1*F2*DSQRT(E1)</span>
                  <span class="n">GAM1</span><span class="o">=</span><span class="p">(</span><span class="n">EMS</span><span class="o">+</span><span class="n">E1</span><span class="p">)</span><span class="o">/</span><span class="n">EMS</span>
                  <span class="n">BET1</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.00</span><span class="o">-</span><span class="mf">1.00</span><span class="o">/</span><span class="p">(</span><span class="n">GAM1</span><span class="o">*</span><span class="n">GAM1</span><span class="p">))</span>
                  <span class="n">AP</span><span class="o">=</span><span class="n">DCZ1</span><span class="o">*</span><span class="n">EFIELD</span><span class="o">*</span><span class="n">BET1</span><span class="o">*</span><span class="n">VC</span><span class="o">*</span><span class="mf">1.0e-10</span>
                  <span class="n">BP1</span><span class="o">=</span><span class="n">BP</span><span class="o">/</span><span class="n">GAM1</span>              
                  <span class="n">E</span><span class="o">=</span><span class="n">E1</span><span class="o">+</span><span class="p">(</span><span class="n">AP</span><span class="o">+</span><span class="n">BP1</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="n">T</span>
                  <span class="k">if</span><span class="p">(</span><span class="n">E</span> <span class="o">&lt;</span> <span class="mf">0.00</span><span class="p">):</span>
                        <span class="n">E</span><span class="o">=</span><span class="mf">0.0010</span>
                  <span class="c"># endif    </span>
                  <span class="c"># INSERT NEW ALGORITHM TO FIND IE FOR VARYING ENERGY STEP          </span>
                  <span class="k">if</span><span class="p">(</span><span class="n">IMIP</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                        <span class="n">IE</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">E</span><span class="o">/</span><span class="n">ESTEP</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>                                               
                  <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span><span class="p">(</span><span class="n">EFINAL</span> <span class="o">&lt;=</span> <span class="mf">20000.</span><span class="p">):</span>
                              <span class="n">IE</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">E</span><span class="o">/</span><span class="n">ESTEP</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
                        <span class="k">elif</span><span class="p">(</span><span class="n">EFINAL</span> <span class="o">&lt;=</span> <span class="mf">140000.</span><span class="p">)</span> <span class="p">:</span>
                              <span class="k">if</span><span class="p">(</span><span class="n">E</span> <span class="o">&lt;=</span> <span class="mf">16000.</span><span class="p">):</span>
                                    <span class="n">IE</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">E</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
                              <span class="k">else</span><span class="p">:</span>
                                    <span class="n">IE</span><span class="o">=</span><span class="mi">16000</span><span class="o">+</span><span class="nb">int</span><span class="p">((</span><span class="n">E</span><span class="o">-</span><span class="mf">16000.</span><span class="p">)</span><span class="o">/</span><span class="n">ESTEP1</span><span class="p">)</span>
                              <span class="c"># endif</span>
                        <span class="k">else</span><span class="p">:</span>
                              <span class="k">if</span><span class="p">(</span><span class="n">E</span> <span class="o">&lt;=</span> <span class="mf">12000.</span><span class="p">):</span>
                                    <span class="n">IE</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">E</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
                              <span class="k">elif</span><span class="p">(</span><span class="n">E</span> <span class="o">&lt;=</span> <span class="mf">92000.</span><span class="p">)</span> <span class="p">:</span>
                                    <span class="n">IE</span><span class="o">=</span><span class="mi">12000</span><span class="o">+</span><span class="nb">int</span><span class="p">((</span><span class="n">E</span><span class="o">-</span><span class="mf">12000.</span><span class="p">)</span><span class="o">/</span><span class="n">ESTEP1</span><span class="p">)</span>
                              <span class="k">else</span><span class="p">:</span>
                                    <span class="n">IE</span><span class="o">=</span><span class="mi">16000</span><span class="o">+</span><span class="nb">int</span><span class="p">((</span><span class="n">E</span><span class="o">-</span><span class="mf">92000.</span><span class="p">)</span><span class="o">/</span><span class="n">ESTEP2</span><span class="p">)</span>
                              <span class="c"># endif</span>
                        <span class="c"># endif</span>
                  <span class="c"># endif </span>
                  <span class="n">IE</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">IE</span><span class="p">,</span><span class="n">J20000</span><span class="p">)</span>                                            
                  <span class="c">#                                                                       </span>
                  <span class="c">#     TEST FOR REAL OR NULL COLLISION                                   </span>
                  <span class="c">#                                                                       </span>
                  <span class="n">R5</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span>
                  <span class="n">TEST1</span><span class="o">=</span><span class="n">TCF</span><span class="p">[</span><span class="n">IE</span><span class="p">]</span><span class="o">/</span><span class="n">TLIM</span>                                               
                  <span class="k">if</span><span class="p">(</span><span class="n">R5</span> <span class="o">&lt;=</span> <span class="n">TEST1</span><span class="p">):</span>
                        <span class="k">pass</span>
                  <span class="k">else</span><span class="p">:</span>
                        <span class="n">NNULL</span><span class="o">=</span><span class="n">NNULL</span><span class="o">+</span><span class="mi">1</span>                          
                        <span class="n">TEST2</span><span class="o">=</span><span class="n">TEMP</span><span class="p">[</span><span class="n">IE</span><span class="p">]</span><span class="o">/</span><span class="n">TLIM</span>
                        <span class="k">if</span><span class="p">(</span><span class="n">R5</span> <span class="o">&lt;</span> <span class="n">TEST2</span><span class="p">):</span>
                              <span class="c"># TEST FOR NULL LEVELS</span>
                              <span class="k">if</span><span class="p">(</span><span class="n">NPLAST</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                                    <span class="n">flag1</span><span class="o">=</span><span class="mi">1</span>
                                    <span class="k">continue</span>
                              <span class="n">R2</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span> 
                              <span class="n">I</span><span class="o">=</span><span class="mi">0</span>
                              <span class="n">flag888</span><span class="o">=</span><span class="mi">1</span>
                              <span class="k">while</span><span class="p">(</span><span class="n">flag888</span><span class="p">):</span>  
                                    <span class="n">flag888</span><span class="o">=</span><span class="mi">0</span>
                                    <span class="n">I</span><span class="o">=</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span>
                                    <span class="k">if</span><span class="p">(</span><span class="n">CFN</span><span class="p">[</span><span class="n">IE</span><span class="p">][</span><span class="n">I</span><span class="p">]</span><span class="o">&lt;</span> <span class="n">R2</span><span class="p">):</span>
                                          <span class="n">flag888</span><span class="o">=</span><span class="mi">1</span>

                              <span class="c"># INCREMENT NULL LEVEL SUM</span>
                              <span class="n">NEXCNUL</span><span class="o">=</span><span class="n">NEXCNUL</span><span class="o">+</span><span class="mi">1</span>
                              <span class="n">ICOLNN</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">=</span><span class="n">ICOLNN</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
                              <span class="c"># STORE X Y Z T ID FOR MOLECULAR LIGHT EMISSION FROM NULL EXCITATION</span>
                              <span class="c"># NOTE:  SMALL APPROX USED POSITION OF PREVIOUS REAL COLLISION</span>
                              <span class="n">XSTN</span><span class="p">[</span><span class="n">NEXCNUL</span><span class="p">]</span><span class="o">=</span><span class="n">X</span>
                              <span class="n">YSTN</span><span class="p">[</span><span class="n">NEXCNUL</span><span class="p">]</span><span class="o">=</span><span class="n">Y</span>
                              <span class="n">ZSTN</span><span class="p">[</span><span class="n">NEXCNUL</span><span class="p">]</span><span class="o">=</span><span class="n">Z</span>
                              <span class="n">TSTN</span><span class="p">[</span><span class="n">NEXCNUL</span><span class="p">]</span><span class="o">=</span><span class="n">ST</span>
                              <span class="n">IDNUL</span><span class="p">[</span><span class="n">NEXCNUL</span><span class="p">]</span><span class="o">=</span><span class="n">I</span>      
                              <span class="n">flag1</span><span class="o">=</span><span class="mi">1</span>
                              <span class="k">continue</span>
                        <span class="k">else</span><span class="p">:</span>
                              <span class="c"># NULL </span>
                              <span class="n">flag1</span><span class="o">=</span><span class="mi">1</span>
                              <span class="k">continue</span>
                        <span class="c"># endif    </span>
                        <span class="c">#                                                                       </span>
                        <span class="c">#  CALCULATE DIRECTION COSINES AND POSITIONS AT INSTANT BEFORE COLLISION</span>
                  <span class="c"># 137 </span>
                  <span class="n">T2</span><span class="o">=</span><span class="n">T</span><span class="o">*</span><span class="n">T</span>
                  <span class="k">if</span><span class="p">(</span><span class="n">E</span> <span class="o">&gt;</span> <span class="n">EMAX</span><span class="p">):</span>
                        <span class="n">EMAX</span><span class="o">=</span><span class="n">E</span>
                  <span class="k">if</span><span class="p">(</span><span class="n">T</span> <span class="o">&gt;</span> <span class="n">TMAX1</span><span class="p">):</span>
                        <span class="n">TMAX1</span><span class="o">=</span><span class="n">T</span>
                  <span class="n">TDASH</span><span class="o">=</span><span class="mf">0.00</span>
                  <span class="n">NREAL</span><span class="o">=</span><span class="n">NREAL</span><span class="o">+</span><span class="mi">1</span>                                                     
                  <span class="c">#     CONST6=DSQRT(E1/E)</span>
                  <span class="n">GAM2</span><span class="o">=</span><span class="p">(</span><span class="n">EMS</span><span class="o">+</span><span class="n">E</span><span class="p">)</span><span class="o">/</span><span class="n">EMS</span>
                  <span class="n">GAM12</span><span class="o">=</span><span class="p">(</span><span class="n">GAM1</span><span class="o">+</span><span class="n">GAM2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.00</span>
                  <span class="n">BET2</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.00</span><span class="o">-</span><span class="mf">1.00</span><span class="o">/</span><span class="p">(</span><span class="n">GAM2</span><span class="o">*</span><span class="n">GAM2</span><span class="p">))</span>   
                  <span class="n">CONST6</span><span class="o">=</span><span class="n">BET1</span><span class="o">/</span><span class="n">BET2</span>                                             
                  <span class="n">DCX2</span><span class="o">=</span><span class="n">DCX1</span><span class="o">*</span><span class="n">CONST6</span>                                                  
                  <span class="n">DCY2</span><span class="o">=</span><span class="n">DCY1</span><span class="o">*</span><span class="n">CONST6</span>                                                  
                  <span class="c">#     DCZ2=DCZ1*CONST6+EFIELD*T*CONST5/DSQRT(E) </span>
                  <span class="n">DCZ2</span><span class="o">=</span><span class="n">DCZ1</span><span class="o">*</span><span class="n">CONST6</span><span class="o">+</span><span class="n">EFIELD</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="mf">2.0e10</span><span class="o">*</span><span class="n">CONST1</span><span class="o">/</span><span class="p">(</span><span class="n">VC</span><span class="o">*</span><span class="n">BET2</span><span class="p">)</span>
                  <span class="c">#     CONST7=CONST9*DSQRT(E1)  </span>
                  <span class="n">CONST7</span><span class="o">=</span><span class="n">VC</span><span class="o">*</span><span class="n">BET1</span><span class="o">*</span><span class="mf">1.0e-12</span>                          
                  <span class="n">A</span><span class="o">=</span><span class="n">T</span><span class="o">*</span><span class="n">CONST7</span>                                                        
                  <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="o">+</span><span class="n">DCX1</span><span class="o">*</span><span class="n">A</span>                                                        
                  <span class="n">Y</span><span class="o">=</span><span class="n">Y</span><span class="o">+</span><span class="n">DCY1</span><span class="o">*</span><span class="n">A</span>
                  <span class="n">Z</span><span class="o">=</span><span class="n">Z</span><span class="o">+</span><span class="n">DCZ1</span><span class="o">*</span><span class="n">A</span><span class="o">+</span><span class="n">T2</span><span class="o">*</span><span class="n">F1</span><span class="o">/</span><span class="n">GAM12</span>
                  <span class="c">#     Z=Z+DCZ1*A+T2*F1     </span>
                  <span class="n">ST</span><span class="o">=</span><span class="n">ST</span><span class="o">+</span><span class="n">T</span>
                  <span class="n">IT</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">T</span><span class="o">+</span><span class="mf">1.00</span><span class="p">)</span>                                                  
                  <span class="n">IT</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">IT</span><span class="p">,</span><span class="n">J300</span><span class="p">)</span>                                               
                  <span class="n">TIME</span><span class="p">[</span><span class="n">IT</span><span class="p">]</span><span class="o">=</span><span class="n">TIME</span><span class="p">[</span><span class="n">IT</span><span class="p">]</span><span class="o">+</span><span class="mf">1.00</span>                                           
                  <span class="c"># --------------------------------------------------------------------- </span>
                  <span class="c">#     DETERMINATION OF REAL COLLISION TYPE                              </span>
                  <span class="c"># --------------------------------------------------------------------- </span>
                  <span class="n">R2</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span>
                  <span class="n">I</span><span class="o">=</span><span class="mi">0</span>                                                               
                  <span class="n">flag140</span><span class="o">=</span><span class="mi">1</span>
                  <span class="k">while</span><span class="p">(</span><span class="n">flag140</span><span class="p">):</span>
                        <span class="n">flag140</span><span class="o">=</span><span class="mi">0</span>
                        <span class="n">I</span><span class="o">=</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span>                                                             
                        <span class="k">if</span><span class="p">(</span><span class="n">CF</span><span class="p">[</span><span class="n">IE</span><span class="p">][</span><span class="n">I</span><span class="p">]</span><span class="o">&lt;</span> <span class="n">R2</span><span class="p">):</span>
                              <span class="n">flag140</span><span class="o">=</span><span class="mi">1</span>
                              <span class="k">break</span>
                  <span class="c">#************************************************************</span>
                  <span class="c"># CHECK IF BREMSSTRAHLUNG</span>
                  <span class="k">if</span><span class="p">(</span><span class="n">IZBR</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">LBRM</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">:</span>
                        <span class="n">NFLGBRMM</span><span class="o">=</span><span class="mi">1</span>
                  <span class="n">IPT</span><span class="o">=</span><span class="n">IARRY</span><span class="p">[</span><span class="n">I</span><span class="p">]</span>
                  <span class="n">ICOLL</span><span class="p">[</span><span class="n">IPT</span><span class="p">]</span><span class="o">=</span><span class="n">ICOLL</span><span class="p">[</span><span class="n">IPT</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
                  <span class="n">ICOLN</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">=</span><span class="n">ICOLN</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
                  <span class="k">for</span> <span class="n">KNGS</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">NGAS</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                        <span class="k">if</span><span class="p">(</span><span class="n">IPT</span> <span class="o">==</span> <span class="p">(</span><span class="n">KNGS</span><span class="o">*</span><span class="mi">5</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                              <span class="k">break</span>
                        <span class="c"># 141  CONTINUE</span>
                  <span class="c"># 142  </span>
                  <span class="n">IATOMNO</span><span class="o">=</span><span class="n">IZBR</span><span class="p">[</span><span class="n">I</span><span class="p">]</span> 
                  <span class="n">BREMS</span><span class="p">(</span><span class="n">IATOMNO</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">DCX2</span><span class="p">,</span><span class="n">DCY2</span><span class="p">,</span><span class="n">DCZ2</span><span class="p">,</span><span class="n">EOUT</span><span class="p">,</span><span class="n">EDCX</span><span class="p">,</span><span class="n">EDCY</span><span class="p">,</span><span class="n">EDCZ</span><span class="p">,</span><span class="n">EGAMMA</span><span class="p">,</span><span class="n">GDCX</span><span class="p">,</span><span class="n">GDCY</span><span class="p">,</span><span class="n">GDCZ</span><span class="p">)</span>
                  <span class="n">NBREM</span><span class="p">[</span><span class="n">KNGS</span><span class="p">]</span><span class="o">=</span><span class="n">NBREM</span><span class="p">[</span><span class="n">KNGS</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
                  <span class="n">EBRTOT</span><span class="p">[</span><span class="n">KNGS</span><span class="p">]</span><span class="o">=</span><span class="n">EBRTOT</span><span class="p">[</span><span class="n">KNGS</span><span class="p">]</span><span class="o">+</span><span class="n">EGAMMA</span>
                  <span class="c"># GET  NEW DRCOS DRCOSY DRCOSX AND ENERGY OF ELECTRON</span>
                  <span class="n">E1</span><span class="o">=</span><span class="n">EOUT</span>
                  <span class="n">DCX1</span><span class="o">=</span><span class="n">EDCX</span>
                  <span class="n">DCY1</span><span class="o">=</span><span class="n">EDCY</span>
                  <span class="n">DCZ1</span><span class="o">=</span><span class="n">EDCZ</span>
                  <span class="c"># RUN BREMSSTRAHLUNG GAMMA THROUGH CASCADE THEN STORE CONVERTED </span>
                  <span class="c"># ELECTRONS IN global /CASRSB/</span>
                  <span class="c">#</span>
                  <span class="n">BREMSCASC</span><span class="p">(</span><span class="n">J11</span><span class="p">,</span><span class="n">EGAMMA</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">ST</span><span class="p">,</span><span class="n">GDCX</span><span class="p">,</span><span class="n">GDCY</span><span class="p">,</span><span class="n">GDCZ</span><span class="p">,</span><span class="n">ILOW</span><span class="p">)</span>
                  <span class="c"># BREMSSTRAHLUNG ENERGY TOO LOW TO IONISE</span>
                  <span class="n">flag191</span><span class="o">=</span><span class="mi">0</span>
                  <span class="k">if</span><span class="p">(</span><span class="n">ILOW</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                        <span class="k">pass</span>
                  <span class="k">else</span><span class="p">:</span>
                        <span class="c">#    </span>
                        <span class="c">#  STORE BREMSSTRAHLUNG DATA IN CLUSTER STORE</span>
                        <span class="c"># </span>
                        <span class="n">ETSUM</span><span class="o">=</span><span class="mf">0.0</span>     
                        <span class="k">for</span> <span class="n">KBR</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IEVNTLB</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                              <span class="n">NCLUS</span><span class="o">=</span><span class="n">NCLUS</span><span class="o">+</span><span class="mi">1</span>
                              <span class="k">if</span><span class="p">(</span><span class="n">NCLUS</span> <span class="o">&gt;</span> <span class="mi">150000</span><span class="p">):</span>
                                    <span class="k">print</span><span class="p">(</span><span class="s">'   SUBROUTINE STOPPED . NCLUS='</span><span class="p">,</span><span class="n">NCLUS</span><span class="p">,</span><span class="s">' NREAL='</span><span class="p">,</span><span class="n">NREAL</span><span class="p">)</span>
                                    <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">()</span>
                              <span class="c"># endif    </span>
                              <span class="n">ES</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">ECASB</span><span class="p">[</span><span class="n">KBR</span><span class="p">]</span>
                              <span class="n">ETSUM</span><span class="o">=</span><span class="n">ETSUM</span><span class="o">+</span><span class="n">ES</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span>
                              <span class="n">XS</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">XCASB</span><span class="p">[</span><span class="n">KBR</span><span class="p">]</span>
                              <span class="n">YS</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">YCASB</span><span class="p">[</span><span class="n">KBR</span><span class="p">]</span>
                              <span class="n">ZS</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">ZCASB</span><span class="p">[</span><span class="n">KBR</span><span class="p">]</span>
                              <span class="n">TS</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">TTB1</span><span class="p">[</span><span class="n">KBR</span><span class="p">]</span>
                              <span class="n">DCX</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">DRXB</span><span class="p">[</span><span class="n">KBR</span><span class="p">]</span>
                              <span class="n">DCY</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">DRYB</span><span class="p">[</span><span class="n">KBR</span><span class="p">]</span>
                              <span class="n">DCZ</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">DRZB</span><span class="p">[</span><span class="n">KBR</span><span class="p">]</span>
                              <span class="n">NFLGFC</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">NFLGFB</span><span class="p">[</span><span class="n">KBR</span><span class="p">]</span><span class="o">+</span><span class="n">NFLGHIGH</span>
                              <span class="n">NFLGPPC</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">NFLGPPB</span><span class="p">[</span><span class="n">KBR</span><span class="p">]</span>
                              <span class="n">NFLGBRMC</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span>
                              <span class="c"># 890  CONTINUE </span>
                        <span class="k">if</span><span class="p">(</span><span class="n">NFLGFC</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">NFLGHIGH</span><span class="p">):</span>
                              <span class="n">NFLGHIGH</span><span class="o">=</span><span class="n">NFLGFC</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span>
                              <span class="k">pass</span>
                        <span class="k">else</span><span class="p">:</span>
                              <span class="c"># endif                </span>
                              <span class="c"># 891 CONTINUE  </span>
                              <span class="c">#*****************************************************************</span>
                              <span class="c">#     S1=RGAS[I]   </span>
                              <span class="n">S1</span><span class="o">=</span><span class="mf">1.00</span><span class="o">+</span><span class="n">GAM2</span><span class="o">*</span><span class="p">(</span><span class="n">RGAS</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">-</span><span class="mf">1.00</span><span class="p">)</span>                                    
                              <span class="n">EI</span><span class="o">=</span><span class="n">EIN</span><span class="p">[</span><span class="n">I</span><span class="p">]</span>
                              <span class="c">#     WRITE(6,8890) EIN[I],I</span>
                              <span class="c">#8890 FORMAT(' EIN=',D12.4,' I=',I3)</span>
                              <span class="k">if</span><span class="p">(</span><span class="n">E</span> <span class="o">&lt;</span> <span class="n">EI</span><span class="p">):</span>
                                    <span class="n">EI</span><span class="o">=</span><span class="n">E</span><span class="o">-</span><span class="mf">0.00010</span>
                              <span class="c"># endif                                                          </span>
                              <span class="k">if</span><span class="p">(</span><span class="n">IPN</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                                    <span class="c"># GO TO 666</span>
                                    <span class="k">pass</span>
                              <span class="k">else</span><span class="p">:</span>
                                    <span class="n">flag335</span><span class="o">=</span><span class="mi">0</span>
                                    <span class="c"># ATTACHMENT       </span>
                                    <span class="k">if</span><span class="p">(</span><span class="n">IPN</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">:</span>
                                          <span class="n">NETOT</span><span class="o">=</span><span class="n">NETOT</span><span class="o">+</span><span class="mi">1</span>
                                          <span class="n">NITOT</span><span class="o">=</span><span class="n">NITOT</span><span class="o">+</span><span class="mi">1</span>
                                          <span class="n">NELEC</span><span class="o">=</span><span class="n">NELEC</span><span class="o">+</span><span class="mi">1</span>
                                          <span class="n">NEGION</span><span class="o">=</span><span class="n">NEGION</span><span class="o">+</span><span class="mi">1</span>
                                          <span class="n">IPT</span><span class="o">=</span><span class="n">IARRY</span><span class="p">[</span><span class="n">I</span><span class="p">]</span>
                                          <span class="n">ICOLL</span><span class="p">[</span><span class="n">IPT</span><span class="p">]</span><span class="o">=</span><span class="n">ICOLL</span><span class="p">[</span><span class="n">IPT</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
                                          <span class="n">ICOLN</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">=</span><span class="n">ICOLN</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span> 
                                          <span class="n">IT</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">T</span><span class="o">+</span><span class="mf">1.00</span><span class="p">)</span>
                                          <span class="n">IT</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">IT</span><span class="p">,</span><span class="n">J300</span><span class="p">)</span>
                                          <span class="n">TIME</span><span class="p">[</span><span class="n">IT</span><span class="p">]</span><span class="o">=</span><span class="n">TIME</span><span class="p">[</span><span class="n">IT</span><span class="p">]</span><span class="o">+</span><span class="mf">1.00</span>
                                          <span class="n">flag335</span><span class="o">=</span><span class="mi">1</span>
                                    <span class="c"># endif</span>
                                    <span class="k">if</span><span class="p">(</span><span class="n">flag335</span><span class="p">):</span>
                                          <span class="c"># 335 Copied it form the end till here </span>
                                          <span class="k">if</span><span class="p">(</span><span class="n">K1</span> <span class="o">==</span> <span class="mi">150000</span><span class="p">):</span>
                                                <span class="c"># GO TO 889</span>
                                                <span class="c"># 889 </span>
                                                <span class="n">NLEFT</span><span class="o">=</span><span class="n">NCLUS</span><span class="o">-</span><span class="n">NELEC</span>
                                                <span class="c"># WRITE(6,992) NPRIME,NLEFT,NCLUS</span>
                                                <span class="c"># 992 </span>
                                                <span class="k">print</span><span class="p">(</span><span class="s">'</span><span class="se">\n\n\n</span><span class="s"> WARNING STOPPED AFTER NPRIME='</span><span class="p">,</span><span class="n">NPRIME</span><span class="p">,</span><span class="s">' LAST PRIMARY HAS AT LEAST '</span><span class="p">,</span><span class="n">NLEFT</span><span class="p">,</span><span class="s">' SECONDARIES LEFT TO TRACK OUT OF '</span><span class="p">,</span><span class="n">NCLUS</span><span class="p">,</span><span class="s">' ELECTRONS ALREADY IN CLUSTER'</span><span class="p">)</span> 
                                                <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">()</span>                      
                                                <span class="k">return</span>                                                            
                                                <span class="c"># end</span>
                                          <span class="c"># CATCH SINGLE ELECTRON CLUSTER THAT WAS ATTACHED.</span>
                                          <span class="c">#     if(NELEC == 1 and NCLUS == 0) GO TO 210 </span>
                                          <span class="c">#</span>
                                          <span class="k">if</span><span class="p">(</span><span class="n">NELEC</span> <span class="o">==</span> <span class="p">(</span><span class="n">NCLUS</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="p">:</span>
                                                <span class="c">#       WRITE(6,884) NELEC,NCLUS,NEGION,J11</span>
                                                <span class="c"># 884 FORMAT(' NELEC=',I6,' NCLUS=',I6,' NEGION=',I3,' J11=',I6)</span>
                                                <span class="c"># LAST ELECTRON IN CLUSTER DO STATISTICS OVER PRIMARY CLUSTER</span>
                                                <span class="n">STATS</span><span class="p">(</span><span class="n">J11</span><span class="p">,</span><span class="n">J1</span><span class="p">)</span>
                                                <span class="c"># GO TO 210</span>
                                                <span class="n">flag210</span><span class="o">=</span><span class="mi">1</span>

                                          <span class="c"># endif</span>
                                          <span class="k">if</span><span class="p">(</span><span class="n">NELEC</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">NCLUS</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="p">:</span>
                                                <span class="c"># GET NEW IONISATION ELECTRON FROM STORE</span>
                                                <span class="n">X</span><span class="o">=</span><span class="n">XS</span><span class="p">[</span><span class="n">NELEC</span><span class="p">]</span>
                                                <span class="n">Y</span><span class="o">=</span><span class="n">YS</span><span class="p">[</span><span class="n">NELEC</span><span class="p">]</span>
                                                <span class="n">Z</span><span class="o">=</span><span class="n">ZS</span><span class="p">[</span><span class="n">NELEC</span><span class="p">]</span>
                                                <span class="n">ST</span><span class="o">=</span><span class="n">TS</span><span class="p">[</span><span class="n">NELEC</span><span class="p">]</span>
                                                <span class="n">NFLGFF</span><span class="o">=</span><span class="n">NFLGFC</span><span class="p">[</span><span class="n">NELEC</span><span class="p">]</span>
                                                <span class="n">NFLGPPP</span><span class="o">=</span><span class="n">NFLGPPC</span><span class="p">[</span><span class="n">NELEC</span><span class="p">]</span>
                                                <span class="n">NFLGBRMM</span><span class="o">=</span><span class="n">NFLGBRMC</span><span class="p">[</span><span class="n">NELEC</span><span class="p">]</span>
                                                <span class="n">TLAST</span><span class="o">=</span><span class="n">TS</span><span class="p">[</span><span class="n">NELEC</span><span class="p">]</span>
                                                <span class="n">E1</span><span class="o">=</span><span class="n">ES</span><span class="p">[</span><span class="n">NELEC</span><span class="p">]</span>
                                                <span class="n">DCX1</span><span class="o">=</span><span class="n">DCX</span><span class="p">[</span><span class="n">NELEC</span><span class="p">]</span>
                                                <span class="n">DCY1</span><span class="o">=</span><span class="n">DCY</span><span class="p">[</span><span class="n">NELEC</span><span class="p">]</span>
                                                <span class="n">DCZ1</span><span class="o">=</span><span class="n">DCZ</span><span class="p">[</span><span class="n">NELEC</span><span class="p">]</span>
                                                <span class="k">if</span><span class="p">(</span><span class="n">E1</span> <span class="o">&lt;</span> <span class="n">ETHRM</span><span class="p">):</span>
                                                      <span class="n">flag191</span><span class="o">=</span><span class="mi">1</span>
                                                      <span class="k">pass</span>
                                                <span class="k">else</span><span class="p">:</span>                       
                                                      <span class="c"># GO TO 1   </span>
                                                      <span class="k">continue</span>
                                          <span class="c"># endif</span>

                                    <span class="n">EISTR</span><span class="o">=</span><span class="n">EI</span>
                                    <span class="k">if</span><span class="p">(</span><span class="n">IONMODEL</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">:</span> 
                                          <span class="c"># CALCULATE SECONDARY ENERGY,ESEC,IN IONISATION COLLISION USING</span>
                                          <span class="c"># FIVE DIFFERENT MODELS</span>
                                          <span class="n">IONSPLIT</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">EI</span><span class="p">,</span><span class="n">ESEC</span><span class="p">)</span>
                                          <span class="c"># GO TO 544</span>
                                          <span class="k">pass</span>
                                    <span class="k">else</span><span class="p">:</span>
                                          <span class="c"># endif</span>
                                          <span class="n">R9</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span>
                                          <span class="c">#    USE OPAL PETERSON AND BEATY SPLITTING FACTOR.</span>
                                          <span class="n">ESEC</span><span class="o">=</span><span class="n">WPL</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">R9</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">arctan</span><span class="p">((</span><span class="n">E</span><span class="o">-</span><span class="n">EI</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">2.00</span><span class="o">*</span><span class="n">WPL</span><span class="p">[</span><span class="n">I</span><span class="p">])))</span>
                                          <span class="n">ESEC</span><span class="o">=</span><span class="n">WPL</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">ESEC</span><span class="o">/</span><span class="n">WPL</span><span class="p">[</span><span class="n">I</span><span class="p">])</span><span class="o">**</span><span class="mf">0.9524</span>
                                    <span class="c"># 544 CONTINUE</span>
                                    <span class="n">EI</span><span class="o">=</span><span class="n">ESEC</span><span class="o">+</span><span class="n">EI</span> 
                                    <span class="c"># STORE POSITION ,ENERGY, DIRECTION COSINES AND TIME OF GENERATION</span>
                                    <span class="c"># OF SECONDARY IONISATION ELECTRONS</span>
                                    <span class="n">NCLUS</span><span class="o">=</span><span class="n">NCLUS</span><span class="o">+</span><span class="mi">1</span>
                                    <span class="n">NMXADD</span><span class="o">=</span><span class="n">MAX</span><span class="p">(</span><span class="n">NCLUS</span><span class="p">,</span><span class="n">NMXADD</span><span class="p">)</span>
                                    <span class="k">if</span><span class="p">(</span><span class="n">NCLUS</span> <span class="o">&gt;</span> <span class="mi">150000</span><span class="p">):</span>
                                          <span class="c"># WRITE(6,546) NCLUS,NREAL</span>
                                          <span class="c"># 546  </span>
                                          <span class="k">print</span><span class="p">(</span><span class="s">'   SUBROUTINE STOPPED . NCLUS='</span><span class="p">,</span><span class="n">NCLUS</span><span class="p">,</span><span class="s">' NREAL='</span><span class="p">,</span><span class="n">NREAL</span><span class="p">)</span>
                                          <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">()</span>
                                    <span class="c"># endif     </span>
                                    <span class="n">XS</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">X</span>       
                                    <span class="n">YS</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">Y</span>
                                    <span class="n">ZS</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">Z</span>
                                    <span class="n">TS</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">ST</span>
                                    <span class="n">ES</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">ESEC</span>   
                                    <span class="n">NFLGFC</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">NFLGFF</span>
                                    <span class="n">NFLGPPC</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">NFLGPPP</span>
                                    <span class="n">NFLGBRMC</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">NFLGBRMM</span>
                                    <span class="n">NTMPFLG</span><span class="o">=</span><span class="mi">1</span>
                                    <span class="n">NCLTMP</span><span class="o">=</span><span class="n">NCLUS</span>
                                    <span class="c">#     ES[NCLUS]=ESEC</span>
                                    <span class="c"># RANDOMISE SECONDARY ELECTRON DIRECTION</span>
                                    <span class="c">#     R3=drand48(RDUM)</span>
                                    <span class="c">#     F3=1.0-2.0D0*R3</span>
                                    <span class="c">#     THETA0=DACOS(F3)</span>
                                    <span class="c">#     F6=DCOS(THETA0)</span>
                                    <span class="c">#     F5=DSIN(THETA0)</span>
                                    <span class="c">#     R4=drand48(RDUM)</span>
                                    <span class="c">#     PHI0=F4*R4</span>
                                    <span class="c">#     F8=DSIN(PHI0)</span>
                                    <span class="c">#     F9=DCOS(PHI0)               </span>
                                    <span class="c">#     DCX[NCLUS]=F9*F5</span>
                                    <span class="c">#     DCY[NCLUS]=F8*F5</span>
                                    <span class="c">#     DCZ[NCLUS]=F6   </span>
                                    <span class="c">#*********************************************************</span>
                                    <span class="n">flag666</span><span class="o">=</span><span class="mi">0</span>
                                    <span class="k">if</span><span class="p">(</span><span class="n">IECASC</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                                          <span class="c"># GO TO 333</span>
                                          <span class="k">pass</span>
                                    <span class="k">else</span><span class="p">:</span>
                                          <span class="k">if</span><span class="p">(</span><span class="n">LEGAS</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                                                <span class="c"># GO TO 333</span>
                                                <span class="k">pass</span>
                                          <span class="k">else</span><span class="p">:</span>
                                                <span class="c"># USE COMPLETE CASCADE FOR ELECTRON IONISATION</span>
                                                <span class="n">KG1</span><span class="o">=</span><span class="n">NEGAS</span><span class="p">[</span><span class="n">I</span><span class="p">]</span>
                                                <span class="n">LG1</span><span class="o">=</span><span class="n">LEGAS</span><span class="p">[</span><span class="n">I</span><span class="p">]</span>
                                                <span class="n">IGSHEL</span><span class="o">=</span><span class="n">IESHELL</span><span class="p">[</span><span class="n">I</span><span class="p">]</span>
                                                <span class="n">CASCADEE</span><span class="p">(</span><span class="n">J11</span><span class="p">,</span><span class="n">KG1</span><span class="p">,</span><span class="n">LG1</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">ST</span><span class="p">,</span><span class="n">ESEC</span><span class="p">,</span><span class="n">IGSHEL</span><span class="p">)</span>
                                                <span class="c">#</span>
                                                <span class="c"># STORE CASCADE IN CLUSTER STORE</span>
                                                <span class="c">#</span>
                                                <span class="n">ETSUM</span><span class="o">=</span><span class="mf">0.0</span>
                                                <span class="k">for</span> <span class="n">KBR</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IEVENTE</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                                                      <span class="n">NCLUS</span><span class="o">=</span><span class="n">NCLUS</span><span class="o">+</span><span class="mi">1</span>
                                                      <span class="k">if</span><span class="p">(</span><span class="n">NCLUS</span> <span class="o">&gt;</span> <span class="mi">150000</span><span class="p">):</span>
                                                            <span class="k">print</span><span class="p">(</span><span class="s">'   SUBROUTINE STOPPED . NCLUS='</span><span class="p">,</span><span class="n">NCLUS</span><span class="p">,</span><span class="s">' NREAL='</span><span class="p">,</span><span class="n">NREAL</span><span class="p">)</span>
                                                            <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">()</span>
                                                      <span class="c"># endif</span>
                                                      <span class="n">ES</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">ECASE</span><span class="p">[</span><span class="n">KBR</span><span class="p">]</span>
                                                      <span class="n">ETSUM</span><span class="o">=</span><span class="n">ETSUM</span><span class="o">+</span><span class="n">ES</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span>
                                                      <span class="n">XS</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">XCASE</span><span class="p">[</span><span class="n">KBR</span><span class="p">]</span>
                                                      <span class="n">YS</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">YCASE</span><span class="p">[</span><span class="n">KBR</span><span class="p">]</span>
                                                      <span class="n">ZS</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">ZCASE</span><span class="p">[</span><span class="n">KBR</span><span class="p">]</span>
                                                      <span class="n">TS</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">TCASE</span><span class="p">[</span><span class="n">KBR</span><span class="p">]</span>
                                                      <span class="n">DCX</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">DRXCE</span><span class="p">[</span><span class="n">KBR</span><span class="p">]</span>
                                                      <span class="n">DCY</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">DRYCE</span><span class="p">[</span><span class="n">KBR</span><span class="p">]</span>
                                                      <span class="n">DCZ</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">DRZCE</span><span class="p">[</span><span class="n">KBR</span><span class="p">]</span>
                                                      <span class="n">NFLGFC</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">NFLGFE</span><span class="p">[</span><span class="n">KBR</span><span class="p">]</span><span class="o">+</span><span class="n">NFLGHIGH</span>
                                                      <span class="n">NFLGPPC</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">NFLGPPE</span><span class="p">[</span><span class="n">KBR</span><span class="p">]</span>
                                                      <span class="n">NFLGBRMC</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">NFLGBRMM</span>
                                                      <span class="c"># 844 CONTINUE</span>
                                                <span class="k">if</span><span class="p">(</span><span class="n">NFLGFC</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">NFLGHIGH</span><span class="p">):</span>
                                                      <span class="n">NFLGHIGH</span><span class="o">=</span><span class="n">NFLGFC</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span>
                                                <span class="n">flag666</span><span class="o">=</span><span class="mi">1</span>
                                                <span class="c">#*********************************************************</span>
                                                <span class="c"># STORE POSSIBLE SHELL EMISSIONS AUGER OR FLUORESCENCE </span>
                                    <span class="c"># 333 </span>
                                    <span class="k">if</span><span class="p">(</span><span class="n">flag666</span><span class="p">):</span>
                                          <span class="k">pass</span>
                                    <span class="k">else</span><span class="p">:</span>
                                          <span class="k">if</span><span class="p">(</span><span class="n">EISTR</span> <span class="o">&gt;</span> <span class="mf">30.0</span><span class="p">)</span> <span class="p">:</span>
                                                <span class="c">#      WRITE(6,8891) EISTR</span>
                                                <span class="c">#8891  FORMAT(' EISTR=',D12.4)</span>
                                                <span class="c"># TEST IF FLUORESCENCE EMISSION</span>
                                                <span class="n">IFLTST</span><span class="o">=</span><span class="mi">0</span>
                                                <span class="k">if</span><span class="p">(</span><span class="n">WKLM</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">):</span>
                                                      <span class="n">R9</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span>
                                                <span class="k">if</span><span class="p">(</span><span class="n">R9</span> <span class="o">&lt;</span> <span class="n">WKLM</span><span class="p">[</span><span class="n">I</span><span class="p">]):</span>
                                                      <span class="n">IFLTST</span><span class="o">=</span><span class="mi">1</span>
                                          <span class="c"># endif</span>
                                          <span class="k">if</span><span class="p">(</span><span class="n">IFLTST</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                                                <span class="c"># AUGER EMISSION WITHOUT FLUORESCENCE</span>
                                                <span class="n">NAUG</span><span class="o">=</span><span class="n">NC0</span><span class="p">[</span><span class="n">I</span><span class="p">]</span>
                                                <span class="n">EAVAUG</span><span class="o">=</span><span class="n">EC0</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">NAUG</span><span class="p">)</span>
                                                <span class="k">for</span> <span class="n">JFL</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">NC0</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                                                      <span class="n">NCLUS</span><span class="o">=</span><span class="n">NCLUS</span><span class="o">+</span><span class="mi">1</span>
                                                      <span class="n">XS</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">X</span>
                                                      <span class="n">YS</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">Y</span>
                                                      <span class="n">ZS</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">Z</span>
                                                      <span class="n">TS</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">ST</span>
                                                      <span class="n">NFLGFC</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">NFLGFF</span>
                                                      <span class="n">NFLGPPC</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">NFLGPPP</span>
                                                      <span class="n">NFLGBRMC</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">NFLGBRMM</span>
                                                      <span class="n">ES</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">EAVAUG</span>
                                                      <span class="n">R3</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span>
                                                      <span class="n">F3</span><span class="o">=</span><span class="mf">1.0</span><span class="o">-</span><span class="mf">2.00</span><span class="o">*</span><span class="n">R3</span>
                                                      <span class="n">THETA0</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">F3</span><span class="p">)</span>
                                                      <span class="n">F6</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">THETA0</span><span class="p">)</span>
                                                      <span class="n">F5</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">THETA0</span><span class="p">)</span>
                                                      <span class="n">R4</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span>
                                                      <span class="n">PHI0</span><span class="o">=</span><span class="n">F4</span><span class="o">*</span><span class="n">R4</span>
                                                      <span class="n">F8</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">PHI0</span><span class="p">)</span>
                                                      <span class="n">F9</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">PHI0</span><span class="p">)</span>               
                                                      <span class="n">DCX</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">F9</span><span class="o">*</span><span class="n">F5</span>
                                                      <span class="n">DCY</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">F8</span><span class="o">*</span><span class="n">F5</span>
                                                      <span class="n">DCZ</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">F6</span>
                                                      <span class="c"># 700   CONTINUE </span>
                                          <span class="k">else</span><span class="p">:</span>
                                                <span class="c"># AUGER EMISSION AND FLUORESENCE </span>
                                                <span class="k">if</span><span class="p">(</span><span class="n">NG2</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                                                      <span class="c"># GO TO 702</span>
                                                      <span class="k">pass</span>
                                                <span class="k">else</span><span class="p">:</span>
                                                      <span class="n">NAUG</span><span class="o">=</span><span class="n">NG2</span><span class="p">[</span><span class="n">I</span><span class="p">]</span>
                                                      <span class="n">EAVAUG</span><span class="o">=</span><span class="n">EG2</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">NAUG</span><span class="p">)</span>
                                                      <span class="k">for</span> <span class="n">JFL</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">NG2</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                                                            <span class="n">NCLUS</span><span class="o">=</span><span class="n">NCLUS</span><span class="o">+</span><span class="mi">1</span>
                                                            <span class="n">XS</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">X</span>
                                                            <span class="n">YS</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">Y</span>
                                                            <span class="n">ZS</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">Z</span>
                                                            <span class="n">NFLGFC</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">NFLGFF</span>
                                                            <span class="n">NFLGPPC</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">NFLGPPP</span>
                                                            <span class="n">NFLGBRMC</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">NFLGBRMM</span>
                                                            <span class="n">TS</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">ST</span>
                                                            <span class="n">ES</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">EAVAUG</span>
                                                            <span class="n">R3</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span>
                                                            <span class="n">F3</span><span class="o">=</span><span class="mf">1.0</span><span class="o">-</span><span class="mf">2.00</span><span class="o">*</span><span class="n">R3</span>
                                                            <span class="n">THETA0</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">F3</span><span class="p">)</span>
                                                            <span class="n">F6</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">THETA0</span><span class="p">)</span>
                                                            <span class="n">F5</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">THETA0</span><span class="p">)</span>
                                                            <span class="n">R4</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span>
                                                            <span class="n">PHI0</span><span class="o">=</span><span class="n">F4</span><span class="o">*</span><span class="n">R4</span>
                                                            <span class="n">F8</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">PHI0</span><span class="p">)</span>
                                                            <span class="n">F9</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">PHI0</span><span class="p">)</span>               
                                                            <span class="n">DCX</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">F9</span><span class="o">*</span><span class="n">F5</span>
                                                            <span class="n">DCY</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">F8</span><span class="o">*</span><span class="n">F5</span>
                                                            <span class="n">DCZ</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">F6</span>
                                                            <span class="c"># 701   CONTINUE</span>
                                                <span class="c"># 702   </span>
                                                <span class="k">if</span><span class="p">(</span><span class="n">NG1</span><span class="p">[</span><span class="n">I</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                                                      <span class="c"># GO TO 704</span>
                                                      <span class="k">pass</span>
                                                <span class="k">else</span><span class="p">:</span>
                                                      <span class="n">NAUG</span><span class="o">=</span><span class="n">NG1</span><span class="p">[</span><span class="n">I</span><span class="p">]</span>
                                                      <span class="n">EAVAUG</span><span class="o">=</span><span class="n">EG1</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">NAUG</span><span class="p">)</span>
                                                      <span class="n">R9</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span>
                                                      <span class="n">DFL</span><span class="o">=-</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">R9</span><span class="p">)</span><span class="o">*</span><span class="n">DSTFL</span><span class="p">[</span><span class="n">I</span><span class="p">]</span>
                                                      <span class="k">for</span> <span class="n">JFL</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">NG1</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                                                            <span class="n">NCLUS</span><span class="o">=</span><span class="n">NCLUS</span><span class="o">+</span><span class="mi">1</span>
                                                            <span class="n">R3</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span>
                                                            <span class="n">THEFL</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="mf">2.00</span><span class="o">*</span><span class="n">R3</span><span class="p">)</span>
                                                            <span class="n">R4</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span>
                                                            <span class="n">PHIFL</span><span class="o">=</span><span class="n">F4</span><span class="o">*</span><span class="n">R4</span>
                                                            <span class="n">XS</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">X</span><span class="o">+</span><span class="n">DFL</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">THEFL</span><span class="p">)</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">PHIFL</span><span class="p">)</span>
                                                            <span class="n">YS</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">Y</span><span class="o">+</span><span class="n">DFL</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">THEFL</span><span class="p">)</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">PHIFL</span><span class="p">)</span>
                                                            <span class="n">ZS</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">Z</span><span class="o">+</span><span class="n">DFL</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">THEFL</span><span class="p">)</span>
                                                            <span class="n">NFLGFC</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">NFLGHIGH</span><span class="o">+</span><span class="mi">1</span>
                                                            <span class="n">NFLGPPC</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">NFLGPPP</span>
                                                            <span class="n">NFLGBRMC</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">NFLGBRMM</span>
                                                            <span class="n">TS</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">ST</span>
                                                            <span class="n">ES</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">EAVAUG</span>
                                                            <span class="n">R3</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span>
                                                            <span class="n">F3</span><span class="o">=</span><span class="mf">1.0</span><span class="o">-</span><span class="mf">2.00</span><span class="o">*</span><span class="n">R3</span>
                                                            <span class="n">THETA0</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">F3</span><span class="p">)</span>
                                                            <span class="n">F6</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">THETA0</span><span class="p">)</span>
                                                            <span class="n">F5</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">THETA0</span><span class="p">)</span>
                                                            <span class="n">R4</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span>
                                                            <span class="n">PHI0</span><span class="o">=</span><span class="n">F4</span><span class="o">*</span><span class="n">R4</span>
                                                            <span class="n">F8</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">PHI0</span><span class="p">)</span>
                                                            <span class="n">F9</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">PHI0</span><span class="p">)</span>               
                                                            <span class="n">DCX</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">F9</span><span class="o">*</span><span class="n">F5</span>
                                                            <span class="n">DCY</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">F8</span><span class="o">*</span><span class="n">F5</span>
                                                            <span class="n">DCZ</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">F6</span>
                                                            <span class="n">NFLGHIGH</span><span class="o">=</span><span class="n">NFLGFC</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span>
                                                            <span class="c"># 703   CONTINUE</span>
                                                <span class="c"># 704   CONTINUE</span>
                                                <span class="c"># endif</span>
                                          <span class="c"># endif</span>
                                          <span class="c">#                                                                       </span>
                                          <span class="c">#  GENERATE SCATTERING ANGLES AND UPDATE  LABORATORY COSINES AFTER      </span>
                                          <span class="c">#   COLLISION ALSO UPDATE ENERGY OF ELECTRON.                           </span>
                                          <span class="c">#</span>
                                          <span class="c"># 666 </span>
                              <span class="n">IPT</span><span class="o">=</span><span class="n">IARRY</span><span class="p">[</span><span class="n">I</span><span class="p">]</span>
                              <span class="n">ICOLL</span><span class="p">[</span><span class="n">IPT</span><span class="p">]</span><span class="o">=</span><span class="n">ICOLL</span><span class="p">[</span><span class="n">IPT</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span> 
                              <span class="n">ICOLN</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">=</span><span class="n">ICOLN</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span> 
                              <span class="c"># IF EXCITATION THEN ADD PROBABILITY ,PENFRA(1,I),OF TRANSFER TO GIVE   </span>
                              <span class="c"># IONISATION OF THE OTHER GASES IN MIXTURE</span>
                              <span class="n">flag6</span><span class="o">=</span><span class="mi">0</span>
                              <span class="k">if</span><span class="p">(</span><span class="n">IPEN</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">NGAS</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                                    <span class="c"># GO TO 5</span>
                                    <span class="k">pass</span>
                              <span class="k">else</span><span class="p">:</span>
                                    <span class="k">if</span><span class="p">(</span><span class="n">PENFRA</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">I</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">):</span>
                                          <span class="n">RAN</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span>
                                          <span class="k">if</span><span class="p">(</span><span class="n">RAN</span> <span class="o">&gt;</span> <span class="n">PENFRA</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">I</span><span class="p">]):</span>
                                                <span class="c"># GO TO 5</span>
                                                <span class="k">pass</span>
                                          <span class="k">else</span><span class="p">:</span>
                                                <span class="n">NCLUS</span><span class="o">=</span><span class="n">NCLUS</span><span class="o">+</span><span class="mi">1</span>  
                                                <span class="c"># ENTER HERE POSSIBLE DELOCALISATION LENGTH FOR PENNING TRANSFER</span>
                                                <span class="k">if</span><span class="p">(</span><span class="n">PENFRA</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">I</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">):</span>
                                                      <span class="n">XS</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">X</span>
                                                      <span class="n">YS</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">Y</span>      
                                                      <span class="n">ZS</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">Z</span>             
                                                      <span class="n">NFLGFC</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">NFLGFF</span>
                                                      <span class="n">NFLGPPC</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">NFLGPPP</span>
                                                      <span class="n">NFLGBRMC</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">NFLGBRMM</span>
                                                      <span class="k">pass</span>
                                                <span class="k">else</span><span class="p">:</span>
                                                      <span class="c"># endif</span>
                                                      <span class="n">ASIGN</span><span class="o">=</span><span class="mf">1.0</span>
                                                      <span class="n">RAN</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span>
                                                      <span class="n">RAN1</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span>
                                                      <span class="k">if</span><span class="p">(</span><span class="n">RAN1</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">):</span>
                                                            <span class="n">ASIGN</span><span class="o">=-</span><span class="n">ASIGN</span>
                                                      <span class="n">XS</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">X</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">RAN</span><span class="p">)</span><span class="o">*</span><span class="n">PENFRA</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">I</span><span class="p">]</span><span class="o">*</span><span class="n">ASIGN</span>
                                                      <span class="n">RAN</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span>
                                                      <span class="n">RAN1</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span>
                                                      <span class="k">if</span><span class="p">(</span><span class="n">RAN1</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">):</span>
                                                            <span class="n">ASIGN</span><span class="o">=-</span><span class="n">ASIGN</span>
                                                      <span class="n">YS</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">Y</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">RAN</span><span class="p">)</span><span class="o">*</span><span class="n">PENFRA</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">I</span><span class="p">]</span><span class="o">*</span><span class="n">ASIGN</span>
                                                      <span class="n">RAN</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span>
                                                      <span class="n">RAN1</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span>
                                                      <span class="k">if</span><span class="p">(</span><span class="n">RAN1</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">):</span>
                                                            <span class="n">ASIGN</span><span class="o">=-</span><span class="n">ASIGN</span>
                                                      <span class="n">ZS</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">Z</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">RAN</span><span class="p">)</span><span class="o">*</span><span class="n">PENFRA</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">I</span><span class="p">]</span><span class="o">*</span><span class="n">ASIGN</span>
                                                <span class="c"># 667  </span>
                                                <span class="n">RAN</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span>
                                                <span class="n">TS</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">ST</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">RAN</span><span class="p">)</span><span class="o">*</span><span class="n">PENFRA</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">I</span><span class="p">]</span>
                                                <span class="c"># ASSIGN EXCESS ENERGY OF 1EV TO PENNING CREATED ELECTRON</span>
                                                <span class="n">ES</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="mf">1.0</span>
                                                <span class="n">DCX</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">DCX1</span>
                                                <span class="n">DCY</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">DCY1</span>
                                                <span class="n">DCZ</span><span class="p">[</span><span class="n">NCLUS</span><span class="p">]</span><span class="o">=</span><span class="n">DCZ1</span>
                                                <span class="n">flag6</span><span class="o">=</span><span class="mi">1</span>
                                          <span class="c"># endif </span>
                                          <span class="c">#      GO TO 6 </span>
                                          <span class="c"># CALCULATE SUM OF EXCITATION PER CLUSTER AND STORE EXCITATION X Y Z T</span>
                              <span class="c"># 5 </span>
                              <span class="k">if</span><span class="p">(</span><span class="n">flag6</span><span class="p">):</span> 
                                    <span class="k">if</span><span class="p">(</span><span class="n">IPN</span><span class="p">[</span><span class="n">I</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">:</span>
                                          <span class="k">if</span><span class="p">((</span><span class="n">RGAS</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">*</span><span class="n">EIN</span><span class="p">[</span><span class="n">I</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mf">4.0</span><span class="p">)</span> <span class="p">:</span>
                                                <span class="n">KEXC</span><span class="o">=</span><span class="n">KEXC</span><span class="o">+</span><span class="mi">1</span>
                                          <span class="k">if</span><span class="p">(</span><span class="n">KEXC</span> <span class="o">&gt;</span> <span class="mi">150000</span><span class="p">):</span>
                                                <span class="c"># WRITE(6,548) KEXC</span>
                                                <span class="c"># 548     </span>
                                                <span class="k">print</span><span class="p">(</span><span class="s">'   SUBROUTINE STOPPED . KEXC='</span><span class="p">,</span><span class="n">KEXC</span><span class="p">)</span>
                                                <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">()</span>
                                          <span class="c"># endif</span>
                                          <span class="c"># FIND GAS IN WHICH EXCITATION OCCURED AND INCREMENT COUNTER</span>
                                          <span class="k">if</span><span class="p">(</span><span class="n">I</span> <span class="o">&lt;=</span> <span class="n">IDG1</span><span class="p">):</span>
                                                <span class="n">NGEXC1</span><span class="o">=</span><span class="n">NGEXC1</span><span class="o">+</span><span class="mi">1</span>
                                          <span class="k">elif</span><span class="p">(</span><span class="n">I</span> <span class="o">&lt;=</span> <span class="n">IDG2</span><span class="p">)</span> <span class="p">:</span>
                                                <span class="n">NGEXC2</span><span class="o">=</span><span class="n">NGEXC2</span><span class="o">+</span><span class="mi">1</span>
                                          <span class="k">elif</span><span class="p">(</span><span class="n">I</span> <span class="o">&lt;=</span> <span class="n">IDG3</span><span class="p">)</span> <span class="p">:</span>
                                                <span class="n">NGEXC3</span><span class="o">=</span><span class="n">NGEXC3</span><span class="o">+</span><span class="mi">1</span>
                                          <span class="k">elif</span><span class="p">(</span><span class="n">I</span> <span class="o">&lt;=</span> <span class="n">IDG4</span><span class="p">)</span> <span class="p">:</span>
                                                <span class="n">NGEXC4</span><span class="o">=</span><span class="n">NGEXC4</span><span class="o">+</span><span class="mi">1</span>
                                          <span class="k">elif</span><span class="p">(</span><span class="n">I</span> <span class="o">&lt;=</span> <span class="n">IDG5</span><span class="p">)</span> <span class="p">:</span>
                                                <span class="n">NGEXC5</span><span class="o">=</span><span class="n">NGEXC5</span><span class="o">+</span><span class="mi">1</span>
                                          <span class="k">elif</span><span class="p">(</span><span class="n">I</span> <span class="o">&lt;=</span> <span class="n">IDG6</span><span class="p">)</span> <span class="p">:</span>
                                                <span class="n">NGEXC6</span><span class="o">=</span><span class="n">NGEXC6</span><span class="o">+</span><span class="mi">1</span>
                                          <span class="k">else</span><span class="p">:</span>
                                                <span class="c"># WRITE(6,9911) </span>
                                                <span class="c"># 9911    </span>
                                                <span class="k">print</span><span class="p">(</span><span class="s">' SUBROUTINE STOPPED BAD GAS ID IN MONTE'</span><span class="p">)</span>
                                                <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">()</span>
                                          <span class="c"># endif</span>
                                          <span class="n">NEXCTOT</span><span class="o">=</span><span class="n">NEXCTOT</span><span class="o">+</span><span class="mi">1</span>
                                          <span class="n">NSTEXC</span><span class="o">=</span><span class="n">NSTEXC</span><span class="o">+</span><span class="mi">1</span>
                                          <span class="n">XSTEXC</span><span class="p">[</span><span class="n">KEXC</span><span class="p">]</span><span class="o">=</span><span class="n">X</span>
                                          <span class="n">YSTEXC</span><span class="p">[</span><span class="n">KEXC</span><span class="p">]</span><span class="o">=</span><span class="n">Y</span>
                                          <span class="n">ZSTEXC</span><span class="p">[</span><span class="n">KEXC</span><span class="p">]</span><span class="o">=</span><span class="n">Z</span>
                                          <span class="n">TSTEXC</span><span class="p">[</span><span class="n">KEXC</span><span class="p">]</span><span class="o">=</span><span class="n">ST</span>
                                          <span class="c"># endif</span>
                                    <span class="c"># endif </span>
                              <span class="c"># 6  </span>
                              <span class="n">S2</span><span class="o">=</span><span class="p">(</span><span class="n">S1</span><span class="o">*</span><span class="n">S1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">S1</span><span class="o">-</span><span class="mf">1.00</span><span class="p">)</span> 
                              <span class="c">#   ANISOTROPIC SCATTERING</span>
                              <span class="n">R3</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span>
                              <span class="k">if</span><span class="p">(</span><span class="n">INDEX</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                                    <span class="n">R31</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span>
                              <span class="n">F3</span><span class="o">=</span><span class="mf">1.00</span><span class="o">-</span><span class="n">R3</span><span class="o">*</span><span class="n">ANGCT</span><span class="p">(</span><span class="n">IE</span><span class="p">,</span><span class="n">I</span><span class="p">)</span>          
                              <span class="k">if</span><span class="p">(</span><span class="n">R31</span> <span class="o">&gt;</span> <span class="n">PSCT</span><span class="p">[</span><span class="n">IE</span><span class="p">][</span><span class="n">I</span><span class="p">]):</span>
                                    <span class="n">F3</span><span class="o">=-</span><span class="n">F3</span>
                              <span class="k">elif</span><span class="p">(</span><span class="n">INDEX</span><span class="p">[</span><span class="n">I</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">:</span>
                                    <span class="n">EPSI</span><span class="o">=</span><span class="n">PSCT</span><span class="p">(</span><span class="n">IE</span><span class="p">,</span><span class="n">I</span><span class="p">)</span>
                                    <span class="n">F3</span><span class="o">=</span><span class="mf">1.00</span><span class="o">-</span><span class="p">(</span><span class="mf">2.00</span><span class="o">*</span><span class="n">R3</span><span class="o">*</span><span class="p">(</span><span class="mf">1.00</span><span class="o">-</span><span class="n">EPSI</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.00</span><span class="o">+</span><span class="n">EPSI</span><span class="o">*</span><span class="p">(</span><span class="mf">1.00</span><span class="o">-</span><span class="mf">2.00</span><span class="o">*</span><span class="n">R3</span><span class="p">)))</span> 
                              <span class="k">else</span><span class="p">:</span> 
                                    <span class="c"># ISOTROPIC SCATTERING                                             </span>
                                    <span class="n">F3</span><span class="o">=</span><span class="mf">1.00</span><span class="o">-</span><span class="mf">2.00</span><span class="o">*</span><span class="n">R3</span>
                              <span class="c"># endif</span>
                              <span class="n">THETA0</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">F3</span><span class="p">)</span>
                              <span class="n">R4</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">RDUM</span><span class="p">)</span>
                              <span class="n">PHI0</span><span class="o">=</span><span class="n">F4</span><span class="o">*</span><span class="n">R4</span>                                                        
                              <span class="n">F8</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">PHI0</span><span class="p">)</span>                                                     
                              <span class="n">F9</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">PHI0</span><span class="p">)</span>                                                     
                              <span class="k">if</span><span class="p">(</span><span class="n">E</span> <span class="o">&lt;</span> <span class="n">EI</span><span class="p">):</span>
                                    <span class="n">EI</span><span class="o">=</span><span class="mf">0.00</span>                                              
                              <span class="n">ARG1</span><span class="o">=</span><span class="mf">1.00</span><span class="o">-</span><span class="n">S1</span><span class="o">*</span><span class="n">EI</span><span class="o">/</span><span class="n">E</span>                                                
                              <span class="n">ARG1</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">ARG1</span><span class="p">,</span><span class="n">SMALL</span><span class="p">)</span>                                            
                              <span class="n">D</span><span class="o">=</span><span class="mf">1.00</span><span class="o">-</span><span class="n">F3</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ARG1</span><span class="p">)</span>                                            
                              <span class="n">E1</span><span class="o">=</span><span class="n">E</span><span class="o">*</span><span class="p">(</span><span class="mf">1.00</span><span class="o">-</span><span class="n">EI</span><span class="o">/</span><span class="p">(</span><span class="n">S1</span><span class="o">*</span><span class="n">E</span><span class="p">)</span><span class="o">-</span><span class="mf">2.00</span><span class="o">*</span><span class="n">D</span><span class="o">/</span><span class="n">S2</span><span class="p">)</span> 
                              <span class="n">E1</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">E1</span><span class="p">,</span><span class="n">SMALL</span><span class="p">)</span>                                                
                              <span class="n">Q</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">E</span><span class="o">/</span><span class="n">E1</span><span class="p">)</span><span class="o">*</span><span class="n">ARG1</span><span class="p">)</span><span class="o">/</span><span class="n">S1</span>                                           
                              <span class="n">Q</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="mf">1.00</span><span class="p">)</span>                                                  
                              <span class="n">THETA</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">Q</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">THETA0</span><span class="p">))</span>                                       
                              <span class="n">F6</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">THETA</span><span class="p">)</span>                                                    
                              <span class="n">U</span><span class="o">=</span><span class="p">(</span><span class="n">S1</span><span class="o">-</span><span class="mf">1.00</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">S1</span><span class="o">-</span><span class="mf">1.00</span><span class="p">)</span><span class="o">/</span><span class="n">ARG1</span>                                      
                              <span class="n">CSQD</span><span class="o">=</span><span class="n">F3</span><span class="o">*</span><span class="n">F3</span>                                                        
                              <span class="k">if</span><span class="p">(</span><span class="n">F3</span> <span class="o">&lt;</span> <span class="mf">0.00</span> <span class="ow">and</span> <span class="n">CSQD</span> <span class="o">&gt;</span> <span class="n">U</span><span class="p">):</span>
                                    <span class="n">F6</span><span class="o">=-</span><span class="mf">1.00</span><span class="o">*</span><span class="n">F6</span>                        
                              <span class="n">F5</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">THETA</span><span class="p">)</span>                                                    
                              <span class="n">DCZ2</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">DCZ2</span><span class="p">,</span><span class="mf">1.00</span><span class="p">)</span>                                            
                              <span class="n">ARGZ</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">DCX2</span><span class="o">*</span><span class="n">DCX2</span><span class="o">+</span><span class="n">DCY2</span><span class="o">*</span><span class="n">DCY2</span><span class="p">)</span>
                              <span class="n">flag190</span><span class="o">=</span><span class="mi">0</span>
                              <span class="k">if</span><span class="p">(</span><span class="n">ARGZ</span> <span class="o">==</span> <span class="mf">0.00</span><span class="p">):</span>
                                    <span class="n">DCZ1</span><span class="o">=</span><span class="n">F6</span>         
                                    <span class="n">DCX1</span><span class="o">=</span><span class="n">F9</span><span class="o">*</span><span class="n">F5</span>                             
                                    <span class="n">DCY1</span><span class="o">=</span><span class="n">F8</span><span class="o">*</span><span class="n">F5</span> 
                                    <span class="k">if</span><span class="p">(</span><span class="n">NTMPFLG</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                                          <span class="c"># USE FREE KINEMATICS FOR IONISATION SECONDARY ANGLES</span>
                                          <span class="n">F5S</span><span class="o">=</span><span class="n">F5</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">E1</span><span class="o">/</span><span class="n">ES</span><span class="p">[</span><span class="n">NCLTMP</span><span class="p">])</span>
                                          <span class="k">if</span><span class="p">(</span><span class="n">F5S</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">):</span>
                                                <span class="n">F5S</span><span class="o">=</span><span class="mf">1.0</span>
                                          <span class="n">THSEC</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">F5S</span><span class="p">)</span>
                                          <span class="n">F5S</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">THSEC</span><span class="p">)</span>
                                          <span class="n">F6S</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">THSEC</span><span class="p">)</span>
                                          <span class="k">if</span><span class="p">(</span><span class="n">F6</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">):</span>
                                                <span class="n">F6S</span><span class="o">=-</span><span class="n">F6S</span>
                                          <span class="n">PHIS</span><span class="o">=</span><span class="n">PHI0</span><span class="o">+</span><span class="n">API</span>   
                                          <span class="k">if</span><span class="p">(</span><span class="n">PHIS</span> <span class="o">&gt;</span> <span class="n">F4</span><span class="p">):</span>
                                                <span class="n">PHIS</span><span class="o">=</span><span class="n">PHI0</span><span class="o">-</span><span class="n">F4</span>
                                          <span class="n">F8S</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">PHIS</span><span class="p">)</span>
                                          <span class="n">F9S</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">PHIS</span><span class="p">)</span>
                                          <span class="n">DCZ</span><span class="p">[</span><span class="n">NCLTMP</span><span class="p">]</span><span class="o">=</span><span class="n">F6S</span>
                                          <span class="n">DCX</span><span class="p">[</span><span class="n">NCLTMP</span><span class="p">]</span><span class="o">=</span><span class="n">F9S</span><span class="o">*</span><span class="n">F5S</span>
                                          <span class="n">DCY</span><span class="p">[</span><span class="n">NCLTMP</span><span class="p">]</span><span class="o">=</span><span class="n">F8S</span><span class="o">*</span><span class="n">F5S</span>
                                          <span class="n">NTMPFLG</span><span class="o">=</span><span class="mi">0</span>
                                    <span class="c"># endif</span>
                                    <span class="n">flag190</span><span class="o">=</span><span class="mi">1</span>
                              <span class="c"># endif                                            </span>
                              <span class="k">if</span><span class="p">(</span><span class="n">flag190</span><span class="p">):</span>
                                    <span class="c"># GO TO 190</span>
                                    <span class="k">pass</span>
                              <span class="k">else</span><span class="p">:</span>
                                    <span class="n">DCZ1</span><span class="o">=</span><span class="n">DCZ2</span><span class="o">*</span><span class="n">F6</span><span class="o">+</span><span class="n">ARGZ</span><span class="o">*</span><span class="n">F5</span><span class="o">*</span><span class="n">F8</span>                                           
                                    <span class="n">DCY1</span><span class="o">=</span><span class="n">DCY2</span><span class="o">*</span><span class="n">F6</span><span class="o">+</span><span class="p">(</span><span class="n">F5</span><span class="o">/</span><span class="n">ARGZ</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">DCX2</span><span class="o">*</span><span class="n">F9</span><span class="o">-</span><span class="n">DCY2</span><span class="o">*</span><span class="n">DCZ2</span><span class="o">*</span><span class="n">F8</span><span class="p">)</span>                     
                                    <span class="n">DCX1</span><span class="o">=</span><span class="n">DCX2</span><span class="o">*</span><span class="n">F6</span><span class="o">-</span><span class="p">(</span><span class="n">F5</span><span class="o">/</span><span class="n">ARGZ</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">DCY2</span><span class="o">*</span><span class="n">F9</span><span class="o">+</span><span class="n">DCX2</span><span class="o">*</span><span class="n">DCZ2</span><span class="o">*</span><span class="n">F8</span><span class="p">)</span>
                                    <span class="k">if</span><span class="p">(</span><span class="n">NTMPFLG</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                                          <span class="c"># USE FREE KINEMATICS FOR IONISATION SECONDARY ANGLES</span>
                                          <span class="n">F5S</span><span class="o">=</span><span class="n">F5</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">E1</span><span class="o">/</span><span class="n">ES</span><span class="p">[</span><span class="n">NCLTMP</span><span class="p">])</span>
                                          <span class="k">if</span><span class="p">(</span><span class="n">F5S</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">):</span>
                                                <span class="n">F5S</span><span class="o">=</span><span class="mf">1.0</span>            
                                          <span class="n">THSEC</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">F5S</span><span class="p">)</span>
                                          <span class="n">F5S</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">THSEC</span><span class="p">)</span>
                                          <span class="n">F6S</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">THSEC</span><span class="p">)</span>
                                          <span class="k">if</span><span class="p">(</span><span class="n">F6</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">):</span>
                                                <span class="n">F6S</span><span class="o">=-</span><span class="n">F6S</span>
                                          <span class="n">PHIS</span><span class="o">=</span><span class="n">PHI0</span><span class="o">+</span><span class="n">API</span>   
                                          <span class="k">if</span><span class="p">(</span><span class="n">PHIS</span> <span class="o">&gt;</span> <span class="n">F4</span><span class="p">):</span>
                                                <span class="n">PHIS</span><span class="o">=</span><span class="n">PHI0</span><span class="o">-</span><span class="n">F4</span>
                                          <span class="n">F8S</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">PHIS</span><span class="p">)</span>
                                          <span class="n">F9S</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">PHIS</span><span class="p">)</span>
                                          <span class="n">DCZ</span><span class="p">[</span><span class="n">NCLTMP</span><span class="p">]</span><span class="o">=</span><span class="n">DCZ2</span><span class="o">*</span><span class="n">F6S</span><span class="o">+</span><span class="n">ARGZ</span><span class="o">*</span><span class="n">F5S</span><span class="o">*</span><span class="n">F8S</span>                               
                                          <span class="n">DCY</span><span class="p">[</span><span class="n">NCLTMP</span><span class="p">]</span><span class="o">=</span><span class="n">DCY2</span><span class="o">*</span><span class="n">F6S</span><span class="o">+</span><span class="p">(</span><span class="n">F5S</span><span class="o">/</span><span class="n">ARGZ</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">DCX2</span><span class="o">*</span><span class="n">F9S</span><span class="o">-</span><span class="n">DCY2</span><span class="o">*</span><span class="n">DCZ2</span><span class="o">*</span><span class="n">F8S</span><span class="p">)</span>        
                                          <span class="n">DCX</span><span class="p">[</span><span class="n">NCLTMP</span><span class="p">]</span><span class="o">=</span><span class="n">DCX2</span><span class="o">*</span><span class="n">F6S</span><span class="o">-</span><span class="p">(</span><span class="n">F5S</span><span class="o">/</span><span class="n">ARGZ</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">DCY2</span><span class="o">*</span><span class="n">F9S</span><span class="o">+</span><span class="n">DCX2</span><span class="o">*</span><span class="n">DCZ2</span><span class="o">*</span><span class="n">F8S</span><span class="p">)</span>
                                          <span class="n">NTMPFLG</span><span class="o">=</span><span class="mi">0</span>
                                    <span class="c"># endif </span>

                  <span class="c"># 190 CONTINUE </span>
                  <span class="c"># TEST IF ELECTRON IS THERMALISED</span>
                  <span class="k">if</span><span class="p">(</span><span class="n">E1</span> <span class="o">&gt;</span> <span class="n">ETHRM</span><span class="p">):</span>
                        <span class="n">flag1</span><span class="o">=</span><span class="mi">1</span>
                        <span class="k">continue</span>  
                  <span class="c"># STORE POSITION AND TIME OF ELECTRON AND COLLISION HISTORY</span>
                  <span class="c"># 191 CONTINUE</span>
                  <span class="n">flag191</span><span class="o">=</span><span class="mi">1</span>
                  <span class="k">while</span><span class="p">(</span><span class="n">flag191</span><span class="p">):</span>
                        <span class="n">flag191</span><span class="o">=</span><span class="mi">0</span>
                        <span class="n">K1</span><span class="o">=</span><span class="n">K1</span><span class="o">+</span><span class="mi">1</span>
                        <span class="n">XST</span><span class="p">[</span><span class="n">K1</span><span class="p">]</span><span class="o">=</span><span class="n">X</span>
                        <span class="n">YST</span><span class="p">[</span><span class="n">K1</span><span class="p">]</span><span class="o">=</span><span class="n">Y</span>
                        <span class="n">ZST</span><span class="p">[</span><span class="n">K1</span><span class="p">]</span><span class="o">=</span><span class="n">Z</span>
                        <span class="n">TST</span><span class="p">[</span><span class="n">K1</span><span class="p">]</span><span class="o">=</span><span class="n">ST</span>
                        <span class="n">NFGF</span><span class="p">[</span><span class="n">K1</span><span class="p">]</span><span class="o">=</span><span class="n">NFLGFF</span>
                        <span class="n">NFGPP</span><span class="p">[</span><span class="n">K1</span><span class="p">]</span><span class="o">=</span><span class="n">NFLGPPP</span>
                        <span class="n">NFGBR</span><span class="p">[</span><span class="n">K1</span><span class="p">]</span><span class="o">=</span><span class="n">NFLGBRMM</span>
                        <span class="n">TTIME</span><span class="p">[</span><span class="n">K1</span><span class="p">]</span><span class="o">=</span><span class="n">ST</span><span class="o">-</span><span class="n">TLAST</span>
                        <span class="n">NELEC</span><span class="o">=</span><span class="n">NELEC</span><span class="o">+</span><span class="mi">1</span>
                        <span class="n">NETOT</span><span class="o">=</span><span class="n">NETOT</span><span class="o">+</span><span class="mi">1</span>
                        <span class="c"># 335  </span>
                        <span class="k">if</span><span class="p">(</span><span class="n">K1</span> <span class="o">==</span> <span class="mi">150000</span><span class="p">):</span>
                              <span class="c"># GO TO 889</span>
                              <span class="c"># 889 </span>
                              <span class="n">NLEFT</span><span class="o">=</span><span class="n">NCLUS</span><span class="o">-</span><span class="n">NELEC</span>
                              <span class="c"># WRITE(6,992) NPRIME,NLEFT,NCLUS</span>
                              <span class="c"># 992 </span>
                              <span class="k">print</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span><span class="s">' WARNING STOPPED AFTER NPRIME= </span><span class="si">%</span><span class="s">d LAST PRIMARY HAS AT LEAST </span><span class="si">%</span><span class="s">d SECONDARIES LEFT TO TRACK OUT OF </span><span class="si">%</span><span class="s">d ELECTRONS ALREADY IN CLUSTER'</span><span class="o">%</span><span class="p">(</span><span class="n">NPRIME</span><span class="p">,</span><span class="n">NLEFT</span><span class="p">,</span><span class="n">NCLUS</span><span class="p">))</span> 
                              <span class="c"># sys.exit()  </span>
                              <span class="c"># doing this if so that updating conf variables can be collapsed by indentation in sublime</span>
                              <span class="k">if</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>   
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NGAS</span><span class="o">=</span><span class="n">NGAS</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NSTEP</span><span class="o">=</span><span class="n">NSTEP</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NANISO</span><span class="o">=</span><span class="n">NANISO</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">EFINAL</span><span class="o">=</span><span class="n">EFINAL</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">ESTEP</span><span class="o">=</span><span class="n">ESTEP</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">AKT</span><span class="o">=</span><span class="n">AKT</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">ARY</span><span class="o">=</span><span class="n">ARY</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">TEMPC</span><span class="o">=</span><span class="n">TEMPC</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">TORR</span><span class="o">=</span><span class="n">TORR</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">IPEN</span><span class="o">=</span><span class="n">IPEN</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NDVEC</span><span class="o">=</span><span class="n">NDVEC</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">CONST1</span><span class="o">=</span><span class="n">CONST1</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">CONST2</span><span class="o">=</span><span class="n">CONST2</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">CONST3</span><span class="o">=</span><span class="n">CONST3</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">CONST4</span><span class="o">=</span><span class="n">CONST4</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">CONST5</span><span class="o">=</span><span class="n">CONST5</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">TMAX</span><span class="o">=</span><span class="n">TMAX</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">SMALL</span><span class="o">=</span><span class="n">SMALL</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">API</span><span class="o">=</span><span class="n">API</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">ESTART</span><span class="o">=</span><span class="n">ESTART</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">THETA</span><span class="o">=</span><span class="n">THETA</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">PHI</span><span class="o">=</span><span class="n">PHI</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">TCFMAX</span><span class="o">=</span><span class="n">TCFMAX</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">TCFMAX1</span><span class="o">=</span><span class="n">TCFMAX1</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">RSTART</span><span class="o">=</span><span class="n">RSTART</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">EFIELD</span><span class="o">=</span><span class="n">EFIELD</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">ETHRM</span><span class="o">=</span><span class="n">ETHRM</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">ECUT</span><span class="o">=</span><span class="n">ECUT</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NDELTA</span><span class="o">=</span><span class="n">NDELTA</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">IMIP</span><span class="o">=</span><span class="n">IMIP</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">IWRITE</span><span class="o">=</span><span class="n">IWRITE</span>                    
                                    <span class="n">conf</span><span class="o">.</span><span class="n">CF</span><span class="o">=</span><span class="n">CF</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">EIN</span><span class="o">=</span><span class="n">EIN</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">TCF</span><span class="o">=</span><span class="n">TCF</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">IARRY</span><span class="o">=</span><span class="n">IARRY</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">RGAS</span><span class="o">=</span><span class="n">RGAS</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">IPN</span><span class="o">=</span><span class="n">IPN</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">WPL</span><span class="o">=</span><span class="n">WPL</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">IZBR</span><span class="o">=</span><span class="n">IZBR</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">IPLAST</span><span class="o">=</span><span class="n">IPLAST</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">PENFRA</span><span class="o">=</span><span class="n">PENFRA</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">CFN</span><span class="o">=</span><span class="n">CFN</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">TCFN</span><span class="o">=</span><span class="n">TCFN</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">SCLENUL</span><span class="o">=</span><span class="n">SCLENUL</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NPLAST</span><span class="o">=</span><span class="n">NPLAST</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">ICOLL</span><span class="o">=</span><span class="n">ICOLL</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NETOT</span><span class="o">=</span><span class="n">NETOT</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NPRIME</span><span class="o">=</span><span class="n">NPRIME</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">TMAX1</span><span class="o">=</span><span class="n">TMAX1</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">TIME</span><span class="o">=</span><span class="n">TIME</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NNULL</span><span class="o">=</span><span class="n">NNULL</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NITOT</span><span class="o">=</span><span class="n">NITOT</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">ICOLN</span><span class="o">=</span><span class="n">ICOLN</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">ICOLNN</span><span class="o">=</span><span class="n">ICOLNN</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NREAL</span><span class="o">=</span><span class="n">NREAL</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NEXCTOT</span> <span class="o">=</span><span class="n">NEXCTOT</span> 
                                    <span class="n">conf</span><span class="o">.</span><span class="n">BET</span><span class="o">=</span><span class="n">BET</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">GAM</span><span class="o">=</span><span class="n">GAM</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">VC</span><span class="o">=</span><span class="n">VC</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">EMS</span><span class="o">=</span><span class="n">EMS</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">XST</span><span class="o">=</span><span class="n">XST</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">YST</span><span class="o">=</span><span class="n">YST</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">ZST</span><span class="o">=</span><span class="n">ZST</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">TST</span><span class="o">=</span><span class="n">TST</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">TTIME</span><span class="o">=</span><span class="n">TTIME</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NFGF</span><span class="o">=</span><span class="n">NFGF</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NFGPP</span><span class="o">=</span><span class="n">NFGPP</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NFGBR</span><span class="o">=</span><span class="n">NFGBR</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NELEC</span><span class="o">=</span><span class="n">NELEC</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NEGION</span><span class="o">=</span><span class="n">NEGION</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">EST1</span><span class="o">=</span><span class="n">EST1</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">EST2</span><span class="o">=</span><span class="n">EST2</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">XSTEXC</span><span class="o">=</span><span class="n">XSTEXC</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">YSTEXC</span><span class="o">=</span><span class="n">YSTEXC</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">ZSTEXC</span><span class="o">=</span><span class="n">ZSTEXC</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">TSTEXC</span><span class="o">=</span><span class="n">TSTEXC</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NSTEXC</span><span class="o">=</span><span class="n">NSTEXC</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">XSTN</span><span class="o">=</span><span class="n">XSTN</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">YSTN</span><span class="o">=</span><span class="n">YSTN</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">ZSTN</span><span class="o">=</span><span class="n">ZSTN</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">TSTN</span><span class="o">=</span><span class="n">TSTN</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">IDNUL</span><span class="o">=</span><span class="n">IDNUL</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NEXCNUL</span><span class="o">=</span><span class="n">NEXCNUL</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">DOUBLE</span><span class="o">=</span><span class="n">DOUBLE</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">CMINIXSC</span><span class="o">=</span><span class="n">CMINIXSC</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">CMINEXSC</span><span class="o">=</span><span class="n">CMINEXSC</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">ECLOSS</span><span class="o">=</span><span class="n">ECLOSS</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">WPLN</span><span class="o">=</span><span class="n">WPLN</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">ICOUNT</span><span class="o">=</span><span class="n">ICOUNT</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">AVPFRAC</span><span class="o">=</span><span class="n">AVPFRAC</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NC0</span><span class="o">=</span><span class="n">NC0</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">EC0</span><span class="o">=</span><span class="n">EC0</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NG1</span><span class="o">=</span><span class="n">NG1</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">EG1</span><span class="o">=</span><span class="n">EG1</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NG2</span><span class="o">=</span><span class="n">NG2</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">EG2</span><span class="o">=</span><span class="n">EG2</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">WKLM</span><span class="o">=</span><span class="n">WKLM</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">DSTFL</span><span class="o">=</span><span class="n">DSTFL</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">ESPLIT</span><span class="o">=</span><span class="n">ESPLIT</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">IONMODEL</span><span class="o">=</span><span class="n">IONMODEL</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">PSCT</span><span class="o">=</span><span class="n">PSCT</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">ANGCT</span><span class="o">=</span><span class="n">ANGCT</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">INDEX</span><span class="o">=</span><span class="n">INDEX</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NISO</span><span class="o">=</span><span class="n">NISO</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">ECAS</span><span class="o">=</span><span class="n">ECAS</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">XCAS</span><span class="o">=</span><span class="n">XCAS</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">YCAS</span><span class="o">=</span><span class="n">YCAS</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">ZCAS</span><span class="o">=</span><span class="n">ZCAS</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">DRXS</span><span class="o">=</span><span class="n">DRXS</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">DRYS</span><span class="o">=</span><span class="n">DRYS</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">DRZS</span><span class="o">=</span><span class="n">DRZS</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">TT1</span><span class="o">=</span><span class="n">TT1</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NFLGF</span><span class="o">=</span><span class="n">NFLGF</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NFLGPP</span><span class="o">=</span><span class="n">NFLGPP</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">IEVNTL</span><span class="o">=</span><span class="n">IEVNTL</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">LCMPLCFLG</span><span class="o">=</span><span class="n">LCMPLCFLG</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">LRAY</span><span class="o">=</span><span class="n">LRAY</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">LRFLG</span><span class="o">=</span><span class="n">LRFLG</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">LPAP</span><span class="o">=</span><span class="n">LPAP</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">LPFLG</span><span class="o">=</span><span class="n">LPFLG</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">LBRM</span><span class="o">=</span><span class="n">LBRM</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">LBFLG</span><span class="o">=</span><span class="n">LBFLG</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">LPEFLG</span><span class="o">=</span><span class="n">LPEFLG</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">EBRGAM</span><span class="o">=</span><span class="n">EBRGAM</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">BRDCOSX</span><span class="o">=</span><span class="n">BRDCOSX</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">BRDCOSY</span><span class="o">=</span><span class="n">BRDCOSY</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">BRDCOSZ</span><span class="o">=</span><span class="n">BRDCOSZ</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">BRX</span><span class="o">=</span><span class="n">BRX</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">BRY</span><span class="o">=</span><span class="n">BRY</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">BRZ</span><span class="o">=</span><span class="n">BRZ</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">BRT</span><span class="o">=</span><span class="n">BRT</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">EBRTOT</span><span class="o">=</span><span class="n">EBRTOT</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NBREM</span><span class="o">=</span><span class="n">NBREM</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">ECASB</span><span class="o">=</span><span class="n">ECASB</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">XCASB</span><span class="o">=</span><span class="n">XCASB</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">YCASB</span><span class="o">=</span><span class="n">YCASB</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">ZCASB</span><span class="o">=</span><span class="n">ZCASB</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">DRXB</span><span class="o">=</span><span class="n">DRXB</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">DRYB</span><span class="o">=</span><span class="n">DRYB</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">DRZB</span><span class="o">=</span><span class="n">DRZB</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">TTB1</span><span class="o">=</span><span class="n">TTB1</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NFLGFB</span><span class="o">=</span><span class="n">NFLGFB</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NFLGPPB</span><span class="o">=</span><span class="n">NFLGPPB</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">IEVNTLB</span><span class="o">=</span><span class="n">IEVNTLB</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">ECASE</span><span class="o">=</span><span class="n">ECASE</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">XCASE</span><span class="o">=</span><span class="n">XCASE</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">YCASE</span><span class="o">=</span><span class="n">YCASE</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">ZCASE</span><span class="o">=</span><span class="n">ZCASE</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">DRXCE</span><span class="o">=</span><span class="n">DRXCE</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">DRYCE</span><span class="o">=</span><span class="n">DRYCE</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">DRZCE</span><span class="o">=</span><span class="n">DRZCE</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">TCASE</span><span class="o">=</span><span class="n">TCASE</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NFLGFE</span><span class="o">=</span><span class="n">NFLGFE</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NFLGPPE</span><span class="o">=</span><span class="n">NFLGPPE</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">IEVENTE</span><span class="o">=</span><span class="n">IEVENTE</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NEGAS</span><span class="o">=</span><span class="n">NEGAS</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">LEGAS</span><span class="o">=</span><span class="n">LEGAS</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">IESHELL</span><span class="o">=</span><span class="n">IESHELL</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">IECASC</span><span class="o">=</span><span class="n">IECASC</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NGEXC1</span><span class="o">=</span><span class="n">NGEXC1</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NGEXC2</span><span class="o">=</span><span class="n">NGEXC2</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NGEXC3</span><span class="o">=</span><span class="n">NGEXC3</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NGEXC4</span><span class="o">=</span><span class="n">NGEXC4</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NGEXC5</span><span class="o">=</span><span class="n">NGEXC5</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">NGEXC6</span><span class="o">=</span><span class="n">NGEXC6</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">IDG1</span><span class="o">=</span><span class="n">IDG1</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">IDG2</span><span class="o">=</span><span class="n">IDG2</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">IDG3</span><span class="o">=</span><span class="n">IDG3</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">IDG4</span><span class="o">=</span><span class="n">IDG4</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">IDG5</span><span class="o">=</span><span class="n">IDG5</span>
                                    <span class="n">conf</span><span class="o">.</span><span class="n">IDG6</span><span class="o">=</span><span class="n">IDG6</span>                 
                              <span class="k">return</span> 

                        <span class="c"># CATCH SINGLE ELECTRON CLUSTER THAT WAS ATTACHED.</span>
                        <span class="c">#     if(NELEC == 1 and NCLUS == 0) GO TO 210 </span>
                        <span class="c">#</span>
                        <span class="k">if</span><span class="p">(</span><span class="n">NELEC</span> <span class="o">==</span> <span class="p">(</span><span class="n">NCLUS</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="p">:</span>
                              <span class="c">#       WRITE(6,884) NELEC,NCLUS,NEGION,J11</span>
                              <span class="c"># 884 FORMAT(' NELEC=',I6,' NCLUS=',I6,' NEGION=',I3,' J11=',I6)</span>
                              <span class="c"># LAST ELECTRON IN CLUSTER DO STATISTICS OVER PRIMARY CLUSTER</span>
                              <span class="n">STATS</span><span class="p">(</span><span class="n">J11</span><span class="p">,</span><span class="n">J1</span><span class="p">)</span>
                              <span class="c"># GO TO 210</span>
                              <span class="n">flag1</span><span class="o">=</span><span class="mi">0</span>
                              <span class="n">flag210</span><span class="o">=</span><span class="mi">1</span>
                              <span class="k">break</span>
                        <span class="c"># endif</span>
                        <span class="k">if</span><span class="p">(</span><span class="n">NELEC</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">NCLUS</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="p">:</span>
                              <span class="c"># GET NEW IONISATION ELECTRON FROM STORE</span>
                              <span class="n">X</span><span class="o">=</span><span class="n">XS</span><span class="p">[</span><span class="n">NELEC</span><span class="p">]</span>
                              <span class="n">Y</span><span class="o">=</span><span class="n">YS</span><span class="p">[</span><span class="n">NELEC</span><span class="p">]</span>
                              <span class="n">Z</span><span class="o">=</span><span class="n">ZS</span><span class="p">[</span><span class="n">NELEC</span><span class="p">]</span>
                              <span class="n">ST</span><span class="o">=</span><span class="n">TS</span><span class="p">[</span><span class="n">NELEC</span><span class="p">]</span>
                              <span class="n">NFLGFF</span><span class="o">=</span><span class="n">NFLGFC</span><span class="p">[</span><span class="n">NELEC</span><span class="p">]</span>
                              <span class="n">NFLGPPP</span><span class="o">=</span><span class="n">NFLGPPC</span><span class="p">[</span><span class="n">NELEC</span><span class="p">]</span>
                              <span class="n">NFLGBRMM</span><span class="o">=</span><span class="n">NFLGBRMC</span><span class="p">[</span><span class="n">NELEC</span><span class="p">]</span>
                              <span class="n">TLAST</span><span class="o">=</span><span class="n">TS</span><span class="p">[</span><span class="n">NELEC</span><span class="p">]</span>
                              <span class="n">E1</span><span class="o">=</span><span class="n">ES</span><span class="p">[</span><span class="n">NELEC</span><span class="p">]</span>
                              <span class="n">DCX1</span><span class="o">=</span><span class="n">DCX</span><span class="p">[</span><span class="n">NELEC</span><span class="p">]</span>
                              <span class="n">DCY1</span><span class="o">=</span><span class="n">DCY</span><span class="p">[</span><span class="n">NELEC</span><span class="p">]</span>
                              <span class="n">DCZ1</span><span class="o">=</span><span class="n">DCZ</span><span class="p">[</span><span class="n">NELEC</span><span class="p">]</span>
                              <span class="k">if</span><span class="p">(</span><span class="n">E1</span> <span class="o">&lt;</span> <span class="n">ETHRM</span><span class="p">):</span>
                                    <span class="n">flag191</span><span class="o">=</span><span class="mi">1</span>
                                    <span class="k">continue</span>
                              <span class="n">flag1</span><span class="o">=</span><span class="mi">1</span>                       
                              <span class="k">break</span>
                  <span class="c"># endif</span>
                  <span class="c">#  MAIN LOOP END    </span>
                  <span class="c"># 210 CONTINUE</span>
                  <span class="k">if</span><span class="p">(</span><span class="n">flag210</span><span class="p">):</span>
                        <span class="k">break</span>
      <span class="c"># RESET NUMBER OF EVENTS FOR BAD EVENTS</span>
      <span class="k">if</span><span class="p">(</span><span class="n">IMIP</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">NDELTA</span><span class="o">=</span><span class="n">NDELTA</span><span class="o">-</span><span class="n">IBADTOT</span>
      <span class="c">#</span>
      <span class="c"># WRITE(6,887) EMAX,NEOVFL</span>
      <span class="c"># 887 </span>
      <span class="k">print</span><span class="p">(</span><span class="s">' EMAX= </span><span class="si">%.7</span><span class="s">f NEOVFL= </span><span class="si">%</span><span class="s">d'</span><span class="o">%</span><span class="p">(</span><span class="n">EMAX</span><span class="p">,</span><span class="n">NEOVFL</span><span class="p">))</span>  
      <span class="k">if</span><span class="p">(</span><span class="n">EMAX</span> <span class="o">&gt;</span> <span class="n">EFINAL</span><span class="p">):</span>
            <span class="c"># WRITE(6,989) EFINAL,EMAX</span>
            <span class="c"># 989 </span>
            <span class="k">print</span><span class="p">(</span><span class="s">'INCREASE ENERGY LIMIT FROM </span><span class="si">%.6</span><span class="s">f EV TO AT LEAST </span><span class="si">%.6</span><span class="s">f </span><span class="se">\n</span><span class="s"> EV.'</span><span class="o">%</span><span class="p">(</span><span class="n">EFINAL</span><span class="p">,</span><span class="n">EMAX</span><span class="p">))</span>
            <span class="c"># sys.exit()</span>
            <span class="c"># doing if(1) so that updating conf variables can be collapsed by indentation in sublime</span>
            <span class="k">if</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NGAS</span><span class="o">=</span><span class="n">NGAS</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NSTEP</span><span class="o">=</span><span class="n">NSTEP</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NANISO</span><span class="o">=</span><span class="n">NANISO</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">EFINAL</span><span class="o">=</span><span class="n">EFINAL</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">ESTEP</span><span class="o">=</span><span class="n">ESTEP</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">AKT</span><span class="o">=</span><span class="n">AKT</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">ARY</span><span class="o">=</span><span class="n">ARY</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">TEMPC</span><span class="o">=</span><span class="n">TEMPC</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">TORR</span><span class="o">=</span><span class="n">TORR</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">IPEN</span><span class="o">=</span><span class="n">IPEN</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NDVEC</span><span class="o">=</span><span class="n">NDVEC</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">CONST1</span><span class="o">=</span><span class="n">CONST1</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">CONST2</span><span class="o">=</span><span class="n">CONST2</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">CONST3</span><span class="o">=</span><span class="n">CONST3</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">CONST4</span><span class="o">=</span><span class="n">CONST4</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">CONST5</span><span class="o">=</span><span class="n">CONST5</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">TMAX</span><span class="o">=</span><span class="n">TMAX</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">SMALL</span><span class="o">=</span><span class="n">SMALL</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">API</span><span class="o">=</span><span class="n">API</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">ESTART</span><span class="o">=</span><span class="n">ESTART</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">THETA</span><span class="o">=</span><span class="n">THETA</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">PHI</span><span class="o">=</span><span class="n">PHI</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">TCFMAX</span><span class="o">=</span><span class="n">TCFMAX</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">TCFMAX1</span><span class="o">=</span><span class="n">TCFMAX1</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">RSTART</span><span class="o">=</span><span class="n">RSTART</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">EFIELD</span><span class="o">=</span><span class="n">EFIELD</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">ETHRM</span><span class="o">=</span><span class="n">ETHRM</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">ECUT</span><span class="o">=</span><span class="n">ECUT</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NDELTA</span><span class="o">=</span><span class="n">NDELTA</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">IMIP</span><span class="o">=</span><span class="n">IMIP</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">IWRITE</span><span class="o">=</span><span class="n">IWRITE</span>                    
                  <span class="n">conf</span><span class="o">.</span><span class="n">CF</span><span class="o">=</span><span class="n">CF</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">EIN</span><span class="o">=</span><span class="n">EIN</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">TCF</span><span class="o">=</span><span class="n">TCF</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">IARRY</span><span class="o">=</span><span class="n">IARRY</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">RGAS</span><span class="o">=</span><span class="n">RGAS</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">IPN</span><span class="o">=</span><span class="n">IPN</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">WPL</span><span class="o">=</span><span class="n">WPL</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">IZBR</span><span class="o">=</span><span class="n">IZBR</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">IPLAST</span><span class="o">=</span><span class="n">IPLAST</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">PENFRA</span><span class="o">=</span><span class="n">PENFRA</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">CFN</span><span class="o">=</span><span class="n">CFN</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">TCFN</span><span class="o">=</span><span class="n">TCFN</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">SCLENUL</span><span class="o">=</span><span class="n">SCLENUL</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NPLAST</span><span class="o">=</span><span class="n">NPLAST</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">ICOLL</span><span class="o">=</span><span class="n">ICOLL</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NETOT</span><span class="o">=</span><span class="n">NETOT</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NPRIME</span><span class="o">=</span><span class="n">NPRIME</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">TMAX1</span><span class="o">=</span><span class="n">TMAX1</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">TIME</span><span class="o">=</span><span class="n">TIME</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NNULL</span><span class="o">=</span><span class="n">NNULL</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NITOT</span><span class="o">=</span><span class="n">NITOT</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">ICOLN</span><span class="o">=</span><span class="n">ICOLN</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">ICOLNN</span><span class="o">=</span><span class="n">ICOLNN</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NREAL</span><span class="o">=</span><span class="n">NREAL</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NEXCTOT</span> <span class="o">=</span><span class="n">NEXCTOT</span> 
                  <span class="n">conf</span><span class="o">.</span><span class="n">BET</span><span class="o">=</span><span class="n">BET</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">GAM</span><span class="o">=</span><span class="n">GAM</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">VC</span><span class="o">=</span><span class="n">VC</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">EMS</span><span class="o">=</span><span class="n">EMS</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">XST</span><span class="o">=</span><span class="n">XST</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">YST</span><span class="o">=</span><span class="n">YST</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">ZST</span><span class="o">=</span><span class="n">ZST</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">TST</span><span class="o">=</span><span class="n">TST</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">TTIME</span><span class="o">=</span><span class="n">TTIME</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NFGF</span><span class="o">=</span><span class="n">NFGF</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NFGPP</span><span class="o">=</span><span class="n">NFGPP</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NFGBR</span><span class="o">=</span><span class="n">NFGBR</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NELEC</span><span class="o">=</span><span class="n">NELEC</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NEGION</span><span class="o">=</span><span class="n">NEGION</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">EST1</span><span class="o">=</span><span class="n">EST1</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">EST2</span><span class="o">=</span><span class="n">EST2</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">XSTEXC</span><span class="o">=</span><span class="n">XSTEXC</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">YSTEXC</span><span class="o">=</span><span class="n">YSTEXC</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">ZSTEXC</span><span class="o">=</span><span class="n">ZSTEXC</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">TSTEXC</span><span class="o">=</span><span class="n">TSTEXC</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NSTEXC</span><span class="o">=</span><span class="n">NSTEXC</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">XSTN</span><span class="o">=</span><span class="n">XSTN</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">YSTN</span><span class="o">=</span><span class="n">YSTN</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">ZSTN</span><span class="o">=</span><span class="n">ZSTN</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">TSTN</span><span class="o">=</span><span class="n">TSTN</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">IDNUL</span><span class="o">=</span><span class="n">IDNUL</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NEXCNUL</span><span class="o">=</span><span class="n">NEXCNUL</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">DOUBLE</span><span class="o">=</span><span class="n">DOUBLE</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">CMINIXSC</span><span class="o">=</span><span class="n">CMINIXSC</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">CMINEXSC</span><span class="o">=</span><span class="n">CMINEXSC</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">ECLOSS</span><span class="o">=</span><span class="n">ECLOSS</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">WPLN</span><span class="o">=</span><span class="n">WPLN</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">ICOUNT</span><span class="o">=</span><span class="n">ICOUNT</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">AVPFRAC</span><span class="o">=</span><span class="n">AVPFRAC</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NC0</span><span class="o">=</span><span class="n">NC0</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">EC0</span><span class="o">=</span><span class="n">EC0</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NG1</span><span class="o">=</span><span class="n">NG1</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">EG1</span><span class="o">=</span><span class="n">EG1</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NG2</span><span class="o">=</span><span class="n">NG2</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">EG2</span><span class="o">=</span><span class="n">EG2</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">WKLM</span><span class="o">=</span><span class="n">WKLM</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">DSTFL</span><span class="o">=</span><span class="n">DSTFL</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">ESPLIT</span><span class="o">=</span><span class="n">ESPLIT</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">IONMODEL</span><span class="o">=</span><span class="n">IONMODEL</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">PSCT</span><span class="o">=</span><span class="n">PSCT</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">ANGCT</span><span class="o">=</span><span class="n">ANGCT</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">INDEX</span><span class="o">=</span><span class="n">INDEX</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NISO</span><span class="o">=</span><span class="n">NISO</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">ECAS</span><span class="o">=</span><span class="n">ECAS</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">XCAS</span><span class="o">=</span><span class="n">XCAS</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">YCAS</span><span class="o">=</span><span class="n">YCAS</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">ZCAS</span><span class="o">=</span><span class="n">ZCAS</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">DRXS</span><span class="o">=</span><span class="n">DRXS</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">DRYS</span><span class="o">=</span><span class="n">DRYS</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">DRZS</span><span class="o">=</span><span class="n">DRZS</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">TT1</span><span class="o">=</span><span class="n">TT1</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NFLGF</span><span class="o">=</span><span class="n">NFLGF</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NFLGPP</span><span class="o">=</span><span class="n">NFLGPP</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">IEVNTL</span><span class="o">=</span><span class="n">IEVNTL</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">LCMPLCFLG</span><span class="o">=</span><span class="n">LCMPLCFLG</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">LRAY</span><span class="o">=</span><span class="n">LRAY</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">LRFLG</span><span class="o">=</span><span class="n">LRFLG</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">LPAP</span><span class="o">=</span><span class="n">LPAP</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">LPFLG</span><span class="o">=</span><span class="n">LPFLG</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">LBRM</span><span class="o">=</span><span class="n">LBRM</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">LBFLG</span><span class="o">=</span><span class="n">LBFLG</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">LPEFLG</span><span class="o">=</span><span class="n">LPEFLG</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">EBRGAM</span><span class="o">=</span><span class="n">EBRGAM</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">BRDCOSX</span><span class="o">=</span><span class="n">BRDCOSX</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">BRDCOSY</span><span class="o">=</span><span class="n">BRDCOSY</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">BRDCOSZ</span><span class="o">=</span><span class="n">BRDCOSZ</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">BRX</span><span class="o">=</span><span class="n">BRX</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">BRY</span><span class="o">=</span><span class="n">BRY</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">BRZ</span><span class="o">=</span><span class="n">BRZ</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">BRT</span><span class="o">=</span><span class="n">BRT</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">EBRTOT</span><span class="o">=</span><span class="n">EBRTOT</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NBREM</span><span class="o">=</span><span class="n">NBREM</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">ECASB</span><span class="o">=</span><span class="n">ECASB</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">XCASB</span><span class="o">=</span><span class="n">XCASB</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">YCASB</span><span class="o">=</span><span class="n">YCASB</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">ZCASB</span><span class="o">=</span><span class="n">ZCASB</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">DRXB</span><span class="o">=</span><span class="n">DRXB</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">DRYB</span><span class="o">=</span><span class="n">DRYB</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">DRZB</span><span class="o">=</span><span class="n">DRZB</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">TTB1</span><span class="o">=</span><span class="n">TTB1</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NFLGFB</span><span class="o">=</span><span class="n">NFLGFB</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NFLGPPB</span><span class="o">=</span><span class="n">NFLGPPB</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">IEVNTLB</span><span class="o">=</span><span class="n">IEVNTLB</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">ECASE</span><span class="o">=</span><span class="n">ECASE</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">XCASE</span><span class="o">=</span><span class="n">XCASE</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">YCASE</span><span class="o">=</span><span class="n">YCASE</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">ZCASE</span><span class="o">=</span><span class="n">ZCASE</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">DRXCE</span><span class="o">=</span><span class="n">DRXCE</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">DRYCE</span><span class="o">=</span><span class="n">DRYCE</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">DRZCE</span><span class="o">=</span><span class="n">DRZCE</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">TCASE</span><span class="o">=</span><span class="n">TCASE</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NFLGFE</span><span class="o">=</span><span class="n">NFLGFE</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NFLGPPE</span><span class="o">=</span><span class="n">NFLGPPE</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">IEVENTE</span><span class="o">=</span><span class="n">IEVENTE</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NEGAS</span><span class="o">=</span><span class="n">NEGAS</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">LEGAS</span><span class="o">=</span><span class="n">LEGAS</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">IESHELL</span><span class="o">=</span><span class="n">IESHELL</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">IECASC</span><span class="o">=</span><span class="n">IECASC</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NGEXC1</span><span class="o">=</span><span class="n">NGEXC1</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NGEXC2</span><span class="o">=</span><span class="n">NGEXC2</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NGEXC3</span><span class="o">=</span><span class="n">NGEXC3</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NGEXC4</span><span class="o">=</span><span class="n">NGEXC4</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NGEXC5</span><span class="o">=</span><span class="n">NGEXC5</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">NGEXC6</span><span class="o">=</span><span class="n">NGEXC6</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">IDG1</span><span class="o">=</span><span class="n">IDG1</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">IDG2</span><span class="o">=</span><span class="n">IDG2</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">IDG3</span><span class="o">=</span><span class="n">IDG3</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">IDG4</span><span class="o">=</span><span class="n">IDG4</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">IDG5</span><span class="o">=</span><span class="n">IDG5</span>
                  <span class="n">conf</span><span class="o">.</span><span class="n">IDG6</span><span class="o">=</span><span class="n">IDG6</span>
      <span class="c"># endif                                         </span>
      <span class="k">return</span> 
      <span class="c"># 889 </span>
      <span class="n">NLEFT</span><span class="o">=</span><span class="n">NCLUS</span><span class="o">-</span><span class="n">NELEC</span>
      <span class="c"># WRITE(6,992) NPRIME,NLEFT,NCLUS</span>
      <span class="c"># 992 </span>
      <span class="k">print</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span><span class="s">' WARNING STOPPED AFTER NPRIME= </span><span class="si">%</span><span class="s">d LAST PRIMARY HAS AT LEAST </span><span class="si">%</span><span class="s">d SECONDARIES LEFT TO TRACK OUT OF </span><span class="si">%</span><span class="s">d ELECTRONS ALREADY IN CLUSTER'</span><span class="o">%</span><span class="p">(</span><span class="n">NPRIME</span><span class="p">,</span><span class="n">NLEFT</span><span class="p">,</span><span class="n">NCLUS</span><span class="p">))</span> 
      <span class="c"># sys.exit()  </span>
      <span class="c"># doing this if so that updating conf variables can be collapsed by indentation in sublime</span>
      <span class="k">if</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>   
            <span class="n">conf</span><span class="o">.</span><span class="n">NGAS</span><span class="o">=</span><span class="n">NGAS</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NSTEP</span><span class="o">=</span><span class="n">NSTEP</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NANISO</span><span class="o">=</span><span class="n">NANISO</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">EFINAL</span><span class="o">=</span><span class="n">EFINAL</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">ESTEP</span><span class="o">=</span><span class="n">ESTEP</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">AKT</span><span class="o">=</span><span class="n">AKT</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">ARY</span><span class="o">=</span><span class="n">ARY</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">TEMPC</span><span class="o">=</span><span class="n">TEMPC</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">TORR</span><span class="o">=</span><span class="n">TORR</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">IPEN</span><span class="o">=</span><span class="n">IPEN</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NDVEC</span><span class="o">=</span><span class="n">NDVEC</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">CONST1</span><span class="o">=</span><span class="n">CONST1</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">CONST2</span><span class="o">=</span><span class="n">CONST2</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">CONST3</span><span class="o">=</span><span class="n">CONST3</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">CONST4</span><span class="o">=</span><span class="n">CONST4</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">CONST5</span><span class="o">=</span><span class="n">CONST5</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">TMAX</span><span class="o">=</span><span class="n">TMAX</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">SMALL</span><span class="o">=</span><span class="n">SMALL</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">API</span><span class="o">=</span><span class="n">API</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">ESTART</span><span class="o">=</span><span class="n">ESTART</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">THETA</span><span class="o">=</span><span class="n">THETA</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">PHI</span><span class="o">=</span><span class="n">PHI</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">TCFMAX</span><span class="o">=</span><span class="n">TCFMAX</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">TCFMAX1</span><span class="o">=</span><span class="n">TCFMAX1</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">RSTART</span><span class="o">=</span><span class="n">RSTART</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">EFIELD</span><span class="o">=</span><span class="n">EFIELD</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">ETHRM</span><span class="o">=</span><span class="n">ETHRM</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">ECUT</span><span class="o">=</span><span class="n">ECUT</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NDELTA</span><span class="o">=</span><span class="n">NDELTA</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">IMIP</span><span class="o">=</span><span class="n">IMIP</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">IWRITE</span><span class="o">=</span><span class="n">IWRITE</span>                    
            <span class="n">conf</span><span class="o">.</span><span class="n">CF</span><span class="o">=</span><span class="n">CF</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">EIN</span><span class="o">=</span><span class="n">EIN</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">TCF</span><span class="o">=</span><span class="n">TCF</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">IARRY</span><span class="o">=</span><span class="n">IARRY</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">RGAS</span><span class="o">=</span><span class="n">RGAS</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">IPN</span><span class="o">=</span><span class="n">IPN</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">WPL</span><span class="o">=</span><span class="n">WPL</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">IZBR</span><span class="o">=</span><span class="n">IZBR</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">IPLAST</span><span class="o">=</span><span class="n">IPLAST</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">PENFRA</span><span class="o">=</span><span class="n">PENFRA</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">CFN</span><span class="o">=</span><span class="n">CFN</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">TCFN</span><span class="o">=</span><span class="n">TCFN</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">SCLENUL</span><span class="o">=</span><span class="n">SCLENUL</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NPLAST</span><span class="o">=</span><span class="n">NPLAST</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">ICOLL</span><span class="o">=</span><span class="n">ICOLL</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NETOT</span><span class="o">=</span><span class="n">NETOT</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NPRIME</span><span class="o">=</span><span class="n">NPRIME</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">TMAX1</span><span class="o">=</span><span class="n">TMAX1</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">TIME</span><span class="o">=</span><span class="n">TIME</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NNULL</span><span class="o">=</span><span class="n">NNULL</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NITOT</span><span class="o">=</span><span class="n">NITOT</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">ICOLN</span><span class="o">=</span><span class="n">ICOLN</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">ICOLNN</span><span class="o">=</span><span class="n">ICOLNN</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NREAL</span><span class="o">=</span><span class="n">NREAL</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NEXCTOT</span> <span class="o">=</span><span class="n">NEXCTOT</span> 
            <span class="n">conf</span><span class="o">.</span><span class="n">BET</span><span class="o">=</span><span class="n">BET</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">GAM</span><span class="o">=</span><span class="n">GAM</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">VC</span><span class="o">=</span><span class="n">VC</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">EMS</span><span class="o">=</span><span class="n">EMS</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">XST</span><span class="o">=</span><span class="n">XST</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">YST</span><span class="o">=</span><span class="n">YST</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">ZST</span><span class="o">=</span><span class="n">ZST</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">TST</span><span class="o">=</span><span class="n">TST</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">TTIME</span><span class="o">=</span><span class="n">TTIME</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NFGF</span><span class="o">=</span><span class="n">NFGF</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NFGPP</span><span class="o">=</span><span class="n">NFGPP</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NFGBR</span><span class="o">=</span><span class="n">NFGBR</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NELEC</span><span class="o">=</span><span class="n">NELEC</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NEGION</span><span class="o">=</span><span class="n">NEGION</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">EST1</span><span class="o">=</span><span class="n">EST1</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">EST2</span><span class="o">=</span><span class="n">EST2</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">XSTEXC</span><span class="o">=</span><span class="n">XSTEXC</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">YSTEXC</span><span class="o">=</span><span class="n">YSTEXC</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">ZSTEXC</span><span class="o">=</span><span class="n">ZSTEXC</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">TSTEXC</span><span class="o">=</span><span class="n">TSTEXC</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NSTEXC</span><span class="o">=</span><span class="n">NSTEXC</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">XSTN</span><span class="o">=</span><span class="n">XSTN</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">YSTN</span><span class="o">=</span><span class="n">YSTN</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">ZSTN</span><span class="o">=</span><span class="n">ZSTN</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">TSTN</span><span class="o">=</span><span class="n">TSTN</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">IDNUL</span><span class="o">=</span><span class="n">IDNUL</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NEXCNUL</span><span class="o">=</span><span class="n">NEXCNUL</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">DOUBLE</span><span class="o">=</span><span class="n">DOUBLE</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">CMINIXSC</span><span class="o">=</span><span class="n">CMINIXSC</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">CMINEXSC</span><span class="o">=</span><span class="n">CMINEXSC</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">ECLOSS</span><span class="o">=</span><span class="n">ECLOSS</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">WPLN</span><span class="o">=</span><span class="n">WPLN</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">ICOUNT</span><span class="o">=</span><span class="n">ICOUNT</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">AVPFRAC</span><span class="o">=</span><span class="n">AVPFRAC</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NC0</span><span class="o">=</span><span class="n">NC0</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">EC0</span><span class="o">=</span><span class="n">EC0</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NG1</span><span class="o">=</span><span class="n">NG1</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">EG1</span><span class="o">=</span><span class="n">EG1</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NG2</span><span class="o">=</span><span class="n">NG2</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">EG2</span><span class="o">=</span><span class="n">EG2</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">WKLM</span><span class="o">=</span><span class="n">WKLM</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">DSTFL</span><span class="o">=</span><span class="n">DSTFL</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">ESPLIT</span><span class="o">=</span><span class="n">ESPLIT</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">IONMODEL</span><span class="o">=</span><span class="n">IONMODEL</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">PSCT</span><span class="o">=</span><span class="n">PSCT</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">ANGCT</span><span class="o">=</span><span class="n">ANGCT</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">INDEX</span><span class="o">=</span><span class="n">INDEX</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NISO</span><span class="o">=</span><span class="n">NISO</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">ECAS</span><span class="o">=</span><span class="n">ECAS</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">XCAS</span><span class="o">=</span><span class="n">XCAS</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">YCAS</span><span class="o">=</span><span class="n">YCAS</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">ZCAS</span><span class="o">=</span><span class="n">ZCAS</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">DRXS</span><span class="o">=</span><span class="n">DRXS</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">DRYS</span><span class="o">=</span><span class="n">DRYS</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">DRZS</span><span class="o">=</span><span class="n">DRZS</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">TT1</span><span class="o">=</span><span class="n">TT1</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NFLGF</span><span class="o">=</span><span class="n">NFLGF</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NFLGPP</span><span class="o">=</span><span class="n">NFLGPP</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">IEVNTL</span><span class="o">=</span><span class="n">IEVNTL</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">LCMPLCFLG</span><span class="o">=</span><span class="n">LCMPLCFLG</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">LRAY</span><span class="o">=</span><span class="n">LRAY</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">LRFLG</span><span class="o">=</span><span class="n">LRFLG</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">LPAP</span><span class="o">=</span><span class="n">LPAP</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">LPFLG</span><span class="o">=</span><span class="n">LPFLG</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">LBRM</span><span class="o">=</span><span class="n">LBRM</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">LBFLG</span><span class="o">=</span><span class="n">LBFLG</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">LPEFLG</span><span class="o">=</span><span class="n">LPEFLG</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">EBRGAM</span><span class="o">=</span><span class="n">EBRGAM</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">BRDCOSX</span><span class="o">=</span><span class="n">BRDCOSX</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">BRDCOSY</span><span class="o">=</span><span class="n">BRDCOSY</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">BRDCOSZ</span><span class="o">=</span><span class="n">BRDCOSZ</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">BRX</span><span class="o">=</span><span class="n">BRX</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">BRY</span><span class="o">=</span><span class="n">BRY</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">BRZ</span><span class="o">=</span><span class="n">BRZ</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">BRT</span><span class="o">=</span><span class="n">BRT</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">EBRTOT</span><span class="o">=</span><span class="n">EBRTOT</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NBREM</span><span class="o">=</span><span class="n">NBREM</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">ECASB</span><span class="o">=</span><span class="n">ECASB</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">XCASB</span><span class="o">=</span><span class="n">XCASB</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">YCASB</span><span class="o">=</span><span class="n">YCASB</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">ZCASB</span><span class="o">=</span><span class="n">ZCASB</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">DRXB</span><span class="o">=</span><span class="n">DRXB</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">DRYB</span><span class="o">=</span><span class="n">DRYB</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">DRZB</span><span class="o">=</span><span class="n">DRZB</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">TTB1</span><span class="o">=</span><span class="n">TTB1</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NFLGFB</span><span class="o">=</span><span class="n">NFLGFB</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NFLGPPB</span><span class="o">=</span><span class="n">NFLGPPB</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">IEVNTLB</span><span class="o">=</span><span class="n">IEVNTLB</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">ECASE</span><span class="o">=</span><span class="n">ECASE</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">XCASE</span><span class="o">=</span><span class="n">XCASE</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">YCASE</span><span class="o">=</span><span class="n">YCASE</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">ZCASE</span><span class="o">=</span><span class="n">ZCASE</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">DRXCE</span><span class="o">=</span><span class="n">DRXCE</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">DRYCE</span><span class="o">=</span><span class="n">DRYCE</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">DRZCE</span><span class="o">=</span><span class="n">DRZCE</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">TCASE</span><span class="o">=</span><span class="n">TCASE</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NFLGFE</span><span class="o">=</span><span class="n">NFLGFE</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NFLGPPE</span><span class="o">=</span><span class="n">NFLGPPE</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">IEVENTE</span><span class="o">=</span><span class="n">IEVENTE</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NEGAS</span><span class="o">=</span><span class="n">NEGAS</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">LEGAS</span><span class="o">=</span><span class="n">LEGAS</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">IESHELL</span><span class="o">=</span><span class="n">IESHELL</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">IECASC</span><span class="o">=</span><span class="n">IECASC</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NGEXC1</span><span class="o">=</span><span class="n">NGEXC1</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NGEXC2</span><span class="o">=</span><span class="n">NGEXC2</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NGEXC3</span><span class="o">=</span><span class="n">NGEXC3</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NGEXC4</span><span class="o">=</span><span class="n">NGEXC4</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NGEXC5</span><span class="o">=</span><span class="n">NGEXC5</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">NGEXC6</span><span class="o">=</span><span class="n">NGEXC6</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">IDG1</span><span class="o">=</span><span class="n">IDG1</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">IDG2</span><span class="o">=</span><span class="n">IDG2</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">IDG3</span><span class="o">=</span><span class="n">IDG3</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">IDG4</span><span class="o">=</span><span class="n">IDG4</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">IDG5</span><span class="o">=</span><span class="n">IDG5</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">IDG6</span><span class="o">=</span><span class="n">IDG6</span>                 
      <span class="k">return</span>                                                            
      <span class="c"># end</span>

</code></pre>