<h2 id='csstfbn'>CSSTFBN</h2>
<p>Stores event data for Nth generation fluorescence.</p>
<h3 id='functions-in-this-module'>Functions in this module :</h3>
<ul>
<li>CSSTFB1()</li>
<li>CSSTFB2()</li>
<li>CSSTFB3()</li>
<li>CSSTFB4()</li>
<li>CSSTFB5()</li>
</ul>
<h3 id='arguments'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>NVAC</td>
<td></td>
</tr>
<tr>
<td>L1</td>
<td></td>
</tr>
<tr>
<td>DIST1</td>
<td></td>
</tr>
</tbody></table>
<pre class="highlight python tab-python"><code><span class="k">def</span> <span class="nf">CSSTFB1</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">,</span><span class="n">DIST1</span><span class="p">):</span>           
    <span class="c"># IMPLICIT #real*8 (A-H,O-Z)</span>
    <span class="c"># IMPLICIT #integer*8 (I-N)</span>
    <span class="c">#COMMON/CALCASB/</span>
    <span class="k">global</span> <span class="n">IONSUM0</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">IFLSUM0</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">ESTORE0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">EPHOTON0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRXE0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRYE0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZE0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRX0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRY0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZ0</span><span class="c">#(10,28)</span>
    <span class="c">#COMMON/CALCAS1B/</span>
    <span class="k">global</span> <span class="n">IONSUM</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">IFLSUM</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">ESTORE</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">EPHOTON</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRXE</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRYE</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZE</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRX</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRY</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZ</span><span class="c">#[10,28]</span>
    <span class="c">#COMMON/GENB1/</span>
    <span class="k">global</span> <span class="n">IONF1</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">ESTF1</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">X1</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">Y1</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">Z1</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRXS</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRYS</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZS</span><span class="c">#(10,28)</span>
    <span class="c">#COMMON/GEN11/</span>
    <span class="k">global</span> <span class="n">X11</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">Y11</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">Z11</span><span class="c">#(10,28)</span>
    <span class="c">#COMMON/GEN01/</span>
    <span class="k">global</span> <span class="n">X01</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">Y01</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">Z01</span><span class="c">#(10)</span>
    <span class="c">#</span>
    <span class="k">if</span><span class="p">(</span><span class="n">L1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="c"># ZERO COUNTER</span>
        <span class="n">IONF1</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">K</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="p">):</span>
            <span class="n">ESTF1</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="k">return</span>
    <span class="c"># endif</span>
    <span class="c"># STORE EVENT DATA FOR FIRST GENERATION FLUORESCENCE</span>
    <span class="k">if</span><span class="p">(</span><span class="n">IONSUM</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span><span class="o">&gt;</span> <span class="mi">28</span><span class="p">)</span> <span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">' WARNING FIRST GENERATION CONVERTED FLUORESCENCE HAS AN EVENT WITH'</span><span class="p">,</span><span class="n">IONSUM</span><span class="p">[</span><span class="n">NVAC</span><span class="p">],</span><span class="s">' IONS.'</span><span class="p">,</span><span class="s">'</span><span class="se">\n</span><span class="s"> COMPTON BRANCH NO='</span><span class="p">,</span><span class="n">NVAC</span><span class="p">,</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">()</span>
    <span class="c"># endif</span>
    <span class="n">IONF1</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span><span class="o">=</span><span class="n">IONSUM</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">J</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IONSUM</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]):</span>
        <span class="n">ESTF1</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">ESTORE</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
        <span class="n">X1</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">X01</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span><span class="o">+</span><span class="n">DIST1</span><span class="o">*</span><span class="n">DRX0</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span>
        <span class="n">Y1</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">Y01</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span><span class="o">+</span><span class="n">DIST1</span><span class="o">*</span><span class="n">DRY0</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span>
        <span class="n">Z1</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">Z01</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span><span class="o">+</span><span class="n">DIST1</span><span class="o">*</span><span class="n">DRZ0</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span>
        <span class="n">X11</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span><span class="o">=</span><span class="n">X1</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
        <span class="n">Y11</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span><span class="o">=</span><span class="n">Y1</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
        <span class="n">Z11</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span><span class="o">=</span><span class="n">Z1</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
        <span class="n">DRXS</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">DRXE</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
        <span class="n">DRYS</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">DRYE</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
        <span class="n">DRZS</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">DRZE</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
    <span class="k">return</span>
    <span class="c"># end</span>
<span class="k">def</span> <span class="nf">CSSTFB2</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">,</span><span class="n">DIST1</span><span class="p">):</span>               
    <span class="c"># IMPLICIT #real*8 (A-H,O-Z)</span>
    <span class="c"># IMPLICIT #integer*8 (I-N)</span>
    <span class="c">#COMMON/CALCAS1B/</span>
    <span class="c">#CALCAS1B#</span>
    <span class="k">global</span> <span class="n">IONSUM0</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">IFLSUM0</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">ESTORE0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">EPHOTON0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRXE0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRYE0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZE0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRX0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRY0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZ0</span><span class="c">#(10,28)</span>

    <span class="c">#COMMON/CALCAS2B/</span>
    <span class="k">global</span> <span class="n">IONSUM</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">IFLSUM</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">ESTORE</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">EPHOTON</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRXE</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRYE</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZE</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRX</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRY</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZ</span><span class="c">#[10,28]</span>

    <span class="c">#COMMON/GEN21/</span>
    <span class="k">global</span> <span class="n">X21</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">Y21</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">Z21</span><span class="c">#(10,28)</span>
    <span class="c">#COMMON/GEN11/</span>
    <span class="k">global</span> <span class="n">X11</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">Y11</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">Z11</span><span class="c">#(10,28)</span>
    <span class="c">#</span>
    <span class="k">if</span><span class="p">(</span><span class="n">L1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="c"># ZERO COUNTER</span>
        <span class="n">IONF2</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">K</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="p">):</span>
            <span class="n">ESTF2</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="k">return</span>
    <span class="c"># endif</span>
    <span class="c"># STORE EVENT DATA FOR FIRST GENERATION FLUORESCENCE</span>
    <span class="c"># STORE EVENT DATA FOR SECOND GENERATION FLUORESCENCE</span>
    <span class="k">if</span><span class="p">(</span><span class="n">IONSUM</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span><span class="o">&gt;</span> <span class="mi">28</span><span class="p">)</span> <span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">' WARNING SECOND GENERATION CONVERTED FLUORESCENCE HAS AN  EVENT WITH'</span><span class="p">,</span><span class="n">IONSUM</span><span class="p">[</span><span class="n">NVAC</span><span class="p">],</span><span class="s">' IONS.'</span><span class="p">,</span><span class="s">'</span><span class="se">\n</span><span class="s"> COMPTON BRANCH NO='</span><span class="p">,</span><span class="n">NVAC</span><span class="p">,</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">()</span>
    <span class="c"># endif</span>
    <span class="n">IONF2</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span><span class="o">=</span><span class="n">IONSUM</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">J</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IONSUM</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]):</span>
        <span class="n">ESTF2</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">ESTORE</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
        <span class="n">X2</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">X11</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span><span class="o">+</span><span class="n">DIST1</span><span class="o">*</span><span class="n">DRX0</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span>
        <span class="n">Y2</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">Y11</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span><span class="o">+</span><span class="n">DIST1</span><span class="o">*</span><span class="n">DRY0</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span>
        <span class="n">Z2</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">Z11</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span><span class="o">+</span><span class="n">DIST1</span><span class="o">*</span><span class="n">DRZ0</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span>
        <span class="n">X21</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span><span class="o">=</span><span class="n">X2</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
        <span class="n">Y21</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span><span class="o">=</span><span class="n">Y2</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
        <span class="n">Z21</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span><span class="o">=</span><span class="n">Z2</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
        <span class="n">DRXS</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">DRXE</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
        <span class="n">DRYS</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">DRYE</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
        <span class="n">DRZS</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">DRZE</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
    <span class="k">return</span>
    <span class="c"># end</span>
<span class="k">def</span> <span class="nf">CSSTFB3</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">,</span><span class="n">DIST1</span><span class="p">):</span>
    <span class="c"># IMPLICIT #real*8 (A-H,O-Z)</span>
    <span class="c"># IMPLICIT #integer*8 (I-N)</span>
    <span class="c">#COMMON/CALCAS2B/</span>
    <span class="k">global</span> <span class="n">IONSUM0</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">IFLSUM0</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">ESTORE0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">EPHOTON0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRXE0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRYE0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZE0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRX0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRY0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZ0</span><span class="c">#(10,28)</span>
    <span class="c">#COMMON/CALCAS3B/</span>
    <span class="k">global</span> <span class="n">IONSUM</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">IFLSUM</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">ESTORE</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">EPHOTON</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRXE</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRYE</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZE</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRX</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRY</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZ</span><span class="c">#[10,28]</span>
    <span class="c">#COMMON/GENB3/</span>
    <span class="k">global</span> <span class="n">IONF3</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">ESTF3</span><span class="c">#(10,15)</span>
    <span class="k">global</span> <span class="n">X3</span><span class="c">#(10,15)</span>
    <span class="k">global</span> <span class="n">Y3</span><span class="c">#(10,15)</span>
    <span class="k">global</span> <span class="n">Z3</span><span class="c">#(10,15)</span>
    <span class="k">global</span> <span class="n">DRXS</span><span class="c">#(10,15)</span>
    <span class="k">global</span> <span class="n">DRYS</span><span class="c">#(10,15)</span>
    <span class="k">global</span> <span class="n">DRZS</span><span class="c">#(10,15)</span>
    <span class="c">#COMMON/GEN31/</span>
    <span class="k">global</span> <span class="n">X31</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">Y31</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">Z31</span><span class="c">#(10,28)</span>
    <span class="c">#COMMON/GEN21/</span>
    <span class="k">global</span> <span class="n">X21</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">Y21</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">Z21</span><span class="c">#(10,28)</span>
    <span class="c">#</span>
    <span class="k">if</span><span class="p">(</span><span class="n">L1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="c"># ZERO COUNTER</span>
        <span class="n">IONF3</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">K</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="p">):</span>
            <span class="n">ESTF3</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
            <span class="k">return</span>
    <span class="c"># endif</span>
    <span class="c"># STORE EVENT DATA FOR THIRD GENERATION FLUORESCENCE</span>
    <span class="k">if</span><span class="p">(</span><span class="n">IONSUM</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span><span class="o">&gt;</span> <span class="mi">15</span><span class="p">)</span> <span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">' WARNING THIRD GENERATION CONVERTED FLUORESCENCE HAS AN  EVENT WITH'</span><span class="p">,</span><span class="n">IONSUM</span><span class="p">[</span><span class="n">NVAC</span><span class="p">],</span><span class="s">' IONS.'</span><span class="p">,</span><span class="s">'</span><span class="se">\n</span><span class="s"> COMPTON BRANCH NO='</span><span class="p">,</span><span class="n">NVAC</span><span class="p">,</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">()</span>
    <span class="c"># endif</span>
    <span class="n">IONF3</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span><span class="o">=</span><span class="n">IONSUM</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">J</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IONSUM</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]):</span>
        <span class="n">ESTF3</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">ESTORE</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
        <span class="n">X3</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">X21</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span><span class="o">+</span><span class="n">DIST1</span><span class="o">*</span><span class="n">DRX0</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span>
        <span class="n">Z3</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">Y21</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span><span class="o">+</span><span class="n">DIST1</span><span class="o">*</span><span class="n">DRY0</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span>
        <span class="n">Z3</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">Z21</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span><span class="o">+</span><span class="n">DIST1</span><span class="o">*</span><span class="n">DRZ0</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span>
        <span class="n">X31</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span><span class="o">=</span><span class="n">X3</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
        <span class="n">Y31</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span><span class="o">=</span><span class="n">Z3</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
        <span class="n">Z31</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span><span class="o">=</span><span class="n">Z3</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
        <span class="n">DRXS</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">DRXE</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
        <span class="n">DRYS</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">DRYE</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
        <span class="n">DRZS</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">DRZE</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
    <span class="k">return</span>
    <span class="c"># end</span>
<span class="k">def</span> <span class="nf">CSSTFB4</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">,</span><span class="n">DIST1</span><span class="p">):</span>
    <span class="c"># IMPLICIT #real*8 (A-H,O-Z)</span>
    <span class="c"># IMPLICIT #integer*8 (I-N)</span>
    <span class="c">#COMMON/CALCAS3B/</span>
    <span class="k">global</span> <span class="n">IONSUM0</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">IFLSUM0</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">ESTORE0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">EPHOTON0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRXE0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRYE0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZE0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRX0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRY0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZ0</span><span class="c">#(10,28)</span>
    <span class="c">#COMMON/CALCAS4B/</span>
    <span class="k">global</span> <span class="n">IONSUM</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">IFLSUM</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">ESTORE</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">EPHOTON</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRXE</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRYE</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZE</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRX</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRY</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZ</span><span class="c">#[10,28]</span>
    <span class="c">#COMMON/GENB4/</span>
    <span class="k">global</span> <span class="n">IONF4</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">ESTF4</span><span class="c">#(10,12)</span>
    <span class="k">global</span> <span class="n">X4</span><span class="c">#(10,12)</span>
    <span class="k">global</span> <span class="n">Y4</span><span class="c">#(10,12)</span>
    <span class="k">global</span> <span class="n">Z4</span><span class="c">#(10,12)</span>
    <span class="k">global</span> <span class="n">DRXS</span><span class="c">#(10,12)</span>
    <span class="k">global</span> <span class="n">DRYS</span><span class="c">#(10,12)</span>
    <span class="k">global</span> <span class="n">DRZS</span><span class="c">#(10,12)</span>
    <span class="c">#COMMON/GEN31/</span>
    <span class="k">global</span> <span class="n">X31</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">Y31</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">Z31</span><span class="c">#(10,28)</span>
    <span class="c">#COMMON/GEN41/</span>
    <span class="k">global</span> <span class="n">X41</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">Y41</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">Z41</span><span class="c">#(10,28)</span>
    <span class="c">#</span>
    <span class="k">if</span><span class="p">(</span><span class="n">L1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="c"># ZERO COUNTER</span>
        <span class="n">IONF4</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">K</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">):</span>
            <span class="n">ESTF4</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
            <span class="k">return</span>
    <span class="c"># endif</span>
    <span class="c"># STORE EVENT DATA FOR FOURTH GENERATION FLUORESCENCE</span>
    <span class="k">if</span><span class="p">(</span><span class="n">IONSUM</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span><span class="o">&gt;</span> <span class="mi">12</span><span class="p">)</span> <span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">' WARNING FOURTH GENERATION CONVERTED FLUORESCENCE HAS AN  EVENT WITH'</span><span class="p">,</span><span class="n">IONSUM</span><span class="p">[</span><span class="n">NVAC</span><span class="p">],</span><span class="s">' IONS.'</span><span class="p">,</span><span class="s">'</span><span class="se">\n</span><span class="s"> COMPTON BRANCH NO='</span><span class="p">,</span><span class="n">NVAC</span><span class="p">,</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">()</span>
    <span class="c"># endif</span>
    <span class="n">IONF4</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span><span class="o">=</span><span class="n">IONSUM</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">J</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IONSUM</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]):</span>
        <span class="n">ESTF4</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">ESTORE</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
        <span class="n">X4</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">X31</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span><span class="o">+</span><span class="n">DIST1</span><span class="o">*</span><span class="n">DRX0</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span>
        <span class="n">Y4</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">Y31</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span><span class="o">+</span><span class="n">DIST1</span><span class="o">*</span><span class="n">DRY0</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span>
        <span class="n">Z4</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">Z31</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span><span class="o">+</span><span class="n">DIST1</span><span class="o">*</span><span class="n">DRZ0</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span>
        <span class="n">X41</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span><span class="o">=</span><span class="n">X4</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
        <span class="n">Y41</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span><span class="o">=</span><span class="n">Y4</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
        <span class="n">Z41</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span><span class="o">=</span><span class="n">Z4</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
        <span class="n">DRXS</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">DRXE</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
        <span class="n">DRYS</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">DRYE</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
        <span class="n">DRZS</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">DRZE</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
    <span class="k">return</span>
    <span class="c"># end</span>
<span class="k">def</span> <span class="nf">CSSTFB5</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">,</span><span class="n">DIST1</span><span class="p">):</span>
    <span class="c"># IMPLICIT #real*8 (A-H,O-Z)</span>
    <span class="c"># IMPLICIT #integer*8 (I-N)</span>
    <span class="c">#COMMON/CALCAS4B/</span>
    <span class="k">global</span> <span class="n">IONSUM0</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">IFLSUM0</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">ESTORE0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">EPHOTON0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRXE0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRYE0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZE0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRX0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRY0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZ0</span><span class="c">#(10,28)</span>
    <span class="c">#COMMON/CALCAS5B/</span>
    <span class="k">global</span> <span class="n">IONSUM</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">IFLSUM</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">ESTORE</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">EPHOTON</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRXE</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRYE</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZE</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRX</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRY</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZ</span><span class="c">#[10,28]</span>
    <span class="c">#COMMON/GENB5/</span>
    <span class="k">global</span> <span class="n">IONF5</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">ESTF5</span><span class="c">#(10,5)</span>
    <span class="k">global</span> <span class="n">X5</span><span class="c">#(10,5)</span>
    <span class="k">global</span> <span class="n">Y5</span><span class="c">#(10,5)</span>
    <span class="k">global</span> <span class="n">Z5</span><span class="c">#(10,5)</span>
    <span class="k">global</span> <span class="n">DRXS</span><span class="c">#(10,5)</span>
    <span class="k">global</span> <span class="n">DRYS</span><span class="c">#(10,5)</span>
    <span class="k">global</span> <span class="n">DRZS</span><span class="c">#(10,5)</span>
    <span class="c">#COMMON/GEN41/</span>
    <span class="k">global</span> <span class="n">X41</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">Y41</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">Z41</span><span class="c">#(10,28)</span>
    <span class="c">#COMMON/GEN51/</span>
    <span class="k">global</span> <span class="n">X51</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">Y51</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">Z51</span><span class="c">#(10,28)</span>
    <span class="c">#</span>
    <span class="k">if</span><span class="p">(</span><span class="n">L1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="c"># ZERO COUNTER</span>
        <span class="n">IONF5</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">K</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span>
            <span class="n">ESTF5</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
            <span class="k">return</span>
    <span class="c"># endif</span>
    <span class="c"># STORE EVENT DATA FOR FIFTH GENERATION FLUORESCENCE</span>
    <span class="k">if</span><span class="p">(</span><span class="n">IONSUM</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span><span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">' WARNING FIFTH GENERATION CONVERTED FLUORESCENCE HAS AN  EVENT WITH'</span><span class="p">,</span><span class="n">IONSUM</span><span class="p">[</span><span class="n">NVAC</span><span class="p">],</span><span class="s">' IONS.'</span><span class="p">,</span><span class="s">'</span><span class="se">\n</span><span class="s"> COMPTON BRANCH NO='</span><span class="p">,</span><span class="n">NVAC</span><span class="p">,</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">()</span>
    <span class="c"># endif</span>
    <span class="n">IONF5</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span><span class="o">=</span><span class="n">IONSUM</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">J</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IONSUM</span><span class="p">[</span><span class="n">NVAC</span><span class="p">]):</span>
        <span class="n">ESTF5</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">ESTORE</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
        <span class="n">X5</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">X41</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span><span class="o">+</span><span class="n">DIST1</span><span class="o">*</span><span class="n">DRX0</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span>
        <span class="n">Y5</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">Y41</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span><span class="o">+</span><span class="n">DIST1</span><span class="o">*</span><span class="n">DRY0</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span>
        <span class="n">Z5</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">Z41</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span><span class="o">+</span><span class="n">DIST1</span><span class="o">*</span><span class="n">DRZ0</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span>
        <span class="n">X51</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span><span class="o">=</span><span class="n">X5</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
        <span class="n">Y51</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span><span class="o">=</span><span class="n">Y5</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
        <span class="n">Z51</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">L1</span><span class="p">]</span><span class="o">=</span><span class="n">Z5</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
        <span class="n">DRXS</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">DRXE</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
        <span class="n">DRYS</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">DRYE</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
        <span class="n">DRZS</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span><span class="o">=</span><span class="n">DRZE</span><span class="p">[</span><span class="n">NVAC</span><span class="p">][</span><span class="n">J</span><span class="p">]</span>
    <span class="k">return</span>
    <span class="c"># end</span>

</code></pre><pre class="highlight fortran tab-fortran"><code><span class="w">      </span><span class="k">SUBROUTINE</span><span class="w"> </span><span class="n">CSSTFB1</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">,</span><span class="n">DIST1</span><span class="p">)</span><span class="w">           
      </span><span class="k">IMPLICIT</span><span class="w"> </span><span class="kt">REAL</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="n">H</span><span class="p">,</span><span class="n">O</span><span class="o">-</span><span class="n">Z</span><span class="p">)</span><span class="w">
      </span><span class="k">IMPLICIT</span><span class="w"> </span><span class="kt">INTEGER</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="n">N</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">CALCASB</span><span class="p">/</span><span class="n">IONSUM0</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">IFLSUM0</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ESTORE0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">EPHOTON0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRXE0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRYE0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZE0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRX0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRY0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZ0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">CALCAS1B</span><span class="p">/</span><span class="n">IONSUM</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">IFLSUM</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ESTORE</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">EPHOTON</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRXE</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRYE</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZE</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRX</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRY</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZ</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">GENB1</span><span class="p">/</span><span class="n">IONF1</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ESTF1</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">X1</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">Y1</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">Z1</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRXS</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRYS</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZS</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">GEN11</span><span class="p">/</span><span class="n">X11</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">Y11</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">Z11</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">GEN01</span><span class="p">/</span><span class="n">X01</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">Y01</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">Z01</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">L1</span><span class="ow">.EQ.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">ZERO</span><span class="w"> </span><span class="n">COUNTER</span><span class="w">
       </span><span class="n">IONF1</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
       </span><span class="k">DO</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="n">K</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="w">
   </span><span class="mi">11</span><span class="w">  </span><span class="n">ESTF1</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
       </span><span class="k">RETURN</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">STORE</span><span class="w"> </span><span class="n">EVENT</span><span class="w"> </span><span class="k">DATA</span><span class="w"> </span><span class="n">FOR</span><span class="w"> </span><span class="n">FIRST</span><span class="w"> </span><span class="n">GENERATION</span><span class="w"> </span><span class="n">FLUORESCENCE</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">IONSUM</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="ow">.GT.</span><span class="mi">28</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
       </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">99</span><span class="p">)</span><span class="w"> </span><span class="n">IONSUM</span><span class="p">(</span><span class="n">NVAC</span><span class="p">),</span><span class="n">NVAC</span><span class="w">
  </span><span class="mi">99</span><span class="w">   </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">' WARNING FIRST GENERATION CONVERTED FLUORESCENCE HAS AN
     / EVENT WITH'</span><span class="p">,</span><span class="l">I3</span><span class="p">,</span><span class="s1">' IONS.'</span><span class="p">,</span><span class="l">/</span><span class="p">,</span><span class="s1">' COMPTON BRANCH NO='</span><span class="p">,</span><span class="l">I3</span><span class="p">,</span><span class="l">/</span><span class="p">)</span><span class="w">
       </span><span class="k">STOP</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w">
      </span><span class="n">IONF1</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="o">=</span><span class="n">IONSUM</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="w">
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">IONSUM</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="w">
      </span><span class="n">ESTF1</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">ESTORE</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
      </span><span class="n">X1</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">X01</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="o">+</span><span class="n">DIST1</span><span class="o">*</span><span class="n">DRX0</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="w">
      </span><span class="n">Y1</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">Y01</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="o">+</span><span class="n">DIST1</span><span class="o">*</span><span class="n">DRY0</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="w">
      </span><span class="n">Z1</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">Z01</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="o">+</span><span class="n">DIST1</span><span class="o">*</span><span class="n">DRZ0</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="w">
      </span><span class="n">X11</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="o">=</span><span class="n">X1</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
      </span><span class="n">Y11</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="o">=</span><span class="n">Y1</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
      </span><span class="n">Z11</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="o">=</span><span class="n">Z1</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
      </span><span class="n">DRXS</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">DRXE</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
      </span><span class="n">DRYS</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">DRYE</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
      </span><span class="n">DRZS</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">DRZE</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
    </span><span class="mi">1</span><span class="w"> </span><span class="k">CONTINUE</span><span class="w">
      </span><span class="k">RETURN</span><span class="w">
      </span><span class="k">END</span><span class="w">
      </span><span class="k">SUBROUTINE</span><span class="w"> </span><span class="n">CSSTFB2</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">,</span><span class="n">DIST1</span><span class="p">)</span><span class="w">               
      </span><span class="k">IMPLICIT</span><span class="w"> </span><span class="kt">REAL</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="n">H</span><span class="p">,</span><span class="n">O</span><span class="o">-</span><span class="n">Z</span><span class="p">)</span><span class="w">
      </span><span class="k">IMPLICIT</span><span class="w"> </span><span class="kt">INTEGER</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="n">N</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">CALCAS1B</span><span class="p">/</span><span class="n">IONSUM0</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">IFLSUM0</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ESTORE0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">EPHOTON0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRXE0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRYE0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZE0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRX0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRY0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZ0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">CALCAS2B</span><span class="p">/</span><span class="n">IONSUM</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">IFLSUM</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ESTORE</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">EPHOTON</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRXE</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRYE</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZE</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRX</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRY</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZ</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">GENB2</span><span class="p">/</span><span class="n">IONF2</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ESTF2</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">X2</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">Y2</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">Z2</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRXS</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRYS</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZS</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">GEN21</span><span class="p">/</span><span class="n">X21</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">Y21</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">Z21</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">GEN11</span><span class="p">/</span><span class="n">X11</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">Y11</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">Z11</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">L1</span><span class="ow">.EQ.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">ZERO</span><span class="w"> </span><span class="n">COUNTER</span><span class="w">
       </span><span class="n">IONF2</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
       </span><span class="k">DO</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="n">K</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="w">
   </span><span class="mi">11</span><span class="w">  </span><span class="n">ESTF2</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
       </span><span class="k">RETURN</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">STORE</span><span class="w"> </span><span class="n">EVENT</span><span class="w"> </span><span class="k">DATA</span><span class="w"> </span><span class="n">FOR</span><span class="w"> </span><span class="n">FIRST</span><span class="w"> </span><span class="n">GENERATION</span><span class="w"> </span><span class="n">FLUORESCENCE</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">STORE</span><span class="w"> </span><span class="n">EVENT</span><span class="w"> </span><span class="k">DATA</span><span class="w"> </span><span class="n">FOR</span><span class="w"> </span><span class="n">SECOND</span><span class="w"> </span><span class="n">GENERATION</span><span class="w"> </span><span class="n">FLUORESCENCE</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">IONSUM</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="ow">.GT.</span><span class="mi">28</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
       </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">99</span><span class="p">)</span><span class="w"> </span><span class="n">IONSUM</span><span class="p">(</span><span class="n">NVAC</span><span class="p">),</span><span class="n">NVAC</span><span class="w">
  </span><span class="mi">99</span><span class="w">   </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">' WARNING SECOND GENERATION CONVERTED FLUORESCENCE HAS AN 
     / EVENT WITH'</span><span class="p">,</span><span class="l">I3</span><span class="p">,</span><span class="s1">' IONS.'</span><span class="p">,</span><span class="l">/</span><span class="p">,</span><span class="s1">' COMPTON BRANCH NO='</span><span class="p">,</span><span class="l">I3</span><span class="p">,</span><span class="l">/</span><span class="p">)</span><span class="w">
       </span><span class="k">STOP</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w">
      </span><span class="n">IONF2</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="o">=</span><span class="n">IONSUM</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="w">
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">IONSUM</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="w">
      </span><span class="n">ESTF2</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">ESTORE</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
      </span><span class="n">X2</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">X11</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="o">+</span><span class="n">DIST1</span><span class="o">*</span><span class="n">DRX0</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="w">
      </span><span class="n">Y2</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">Y11</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="o">+</span><span class="n">DIST1</span><span class="o">*</span><span class="n">DRY0</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="w">
      </span><span class="n">Z2</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">Z11</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="o">+</span><span class="n">DIST1</span><span class="o">*</span><span class="n">DRZ0</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="w">
      </span><span class="n">X21</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="o">=</span><span class="n">X2</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
      </span><span class="n">Y21</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="o">=</span><span class="n">Y2</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
      </span><span class="n">Z21</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="o">=</span><span class="n">Z2</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
      </span><span class="n">DRXS</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">DRXE</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
      </span><span class="n">DRYS</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">DRYE</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
      </span><span class="n">DRZS</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">DRZE</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
    </span><span class="mi">1</span><span class="w"> </span><span class="k">CONTINUE</span><span class="w">
      </span><span class="k">RETURN</span><span class="w">
      </span><span class="k">END</span><span class="w">
      </span><span class="k">SUBROUTINE</span><span class="w"> </span><span class="n">CSSTFB3</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">,</span><span class="n">DIST1</span><span class="p">)</span><span class="w">
      </span><span class="k">IMPLICIT</span><span class="w"> </span><span class="kt">REAL</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="n">H</span><span class="p">,</span><span class="n">O</span><span class="o">-</span><span class="n">Z</span><span class="p">)</span><span class="w">
      </span><span class="k">IMPLICIT</span><span class="w"> </span><span class="kt">INTEGER</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="n">N</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">CALCAS2B</span><span class="p">/</span><span class="n">IONSUM0</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">IFLSUM0</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ESTORE0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">EPHOTON0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRXE0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRYE0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZE0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRX0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRY0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZ0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">CALCAS3B</span><span class="p">/</span><span class="n">IONSUM</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">IFLSUM</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ESTORE</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">EPHOTON</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRXE</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRYE</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZE</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRX</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRY</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZ</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">GENB3</span><span class="p">/</span><span class="n">IONF3</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ESTF3</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span><span class="n">X3</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span><span class="n">Y3</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span><span class="n">Z3</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRXS</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span><span class="n">DRYS</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span><span class="n">DRZS</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">GEN31</span><span class="p">/</span><span class="n">X31</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">Y31</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">Z31</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">GEN21</span><span class="p">/</span><span class="n">X21</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">Y21</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">Z21</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">L1</span><span class="ow">.EQ.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">ZERO</span><span class="w"> </span><span class="n">COUNTER</span><span class="w">
       </span><span class="n">IONF3</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
       </span><span class="k">DO</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="n">K</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="w">
   </span><span class="mi">11</span><span class="w">  </span><span class="n">ESTF3</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
       </span><span class="k">RETURN</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">STORE</span><span class="w"> </span><span class="n">EVENT</span><span class="w"> </span><span class="k">DATA</span><span class="w"> </span><span class="n">FOR</span><span class="w"> </span><span class="n">THIRD</span><span class="w"> </span><span class="n">GENERATION</span><span class="w"> </span><span class="n">FLUORESCENCE</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">IONSUM</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="ow">.GT.</span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
       </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">99</span><span class="p">)</span><span class="w"> </span><span class="n">IONSUM</span><span class="p">(</span><span class="n">NVAC</span><span class="p">),</span><span class="n">NVAC</span><span class="w">
  </span><span class="mi">99</span><span class="w">   </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">' WARNING THIRD GENERATION CONVERTED FLUORESCENCE HAS AN 
     / EVENT WITH'</span><span class="p">,</span><span class="l">I3</span><span class="p">,</span><span class="s1">' IONS.'</span><span class="p">,</span><span class="l">/</span><span class="p">,</span><span class="s1">' COMPTON BRANCH NO='</span><span class="p">,</span><span class="l">I3</span><span class="p">,</span><span class="l">/</span><span class="p">)</span><span class="w">
       </span><span class="k">STOP</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w">
      </span><span class="n">IONF3</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="o">=</span><span class="n">IONSUM</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="w">
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">IONSUM</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="w">
      </span><span class="n">ESTF3</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">ESTORE</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
      </span><span class="n">X3</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">X21</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="o">+</span><span class="n">DIST1</span><span class="o">*</span><span class="n">DRX0</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="w">
      </span><span class="n">Y3</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">Y21</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="o">+</span><span class="n">DIST1</span><span class="o">*</span><span class="n">DRY0</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="w">
      </span><span class="n">Z3</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">Z21</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="o">+</span><span class="n">DIST1</span><span class="o">*</span><span class="n">DRZ0</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="w">
      </span><span class="n">X31</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="o">=</span><span class="n">X3</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
      </span><span class="n">Y31</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="o">=</span><span class="n">Y3</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
      </span><span class="n">Z31</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="o">=</span><span class="n">Z3</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
      </span><span class="n">DRXS</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">DRXE</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
      </span><span class="n">DRYS</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">DRYE</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
      </span><span class="n">DRZS</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">DRZE</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
    </span><span class="mi">1</span><span class="w"> </span><span class="k">CONTINUE</span><span class="w">
      </span><span class="k">RETURN</span><span class="w">
      </span><span class="k">END</span><span class="w">
      </span><span class="k">SUBROUTINE</span><span class="w"> </span><span class="n">CSSTFB4</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">,</span><span class="n">DIST1</span><span class="p">)</span><span class="w">
      </span><span class="k">IMPLICIT</span><span class="w"> </span><span class="kt">REAL</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="n">H</span><span class="p">,</span><span class="n">O</span><span class="o">-</span><span class="n">Z</span><span class="p">)</span><span class="w">
      </span><span class="k">IMPLICIT</span><span class="w"> </span><span class="kt">INTEGER</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="n">N</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">CALCAS3B</span><span class="p">/</span><span class="n">IONSUM0</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">IFLSUM0</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ESTORE0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">EPHOTON0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRXE0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRYE0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZE0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRX0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRY0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZ0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">CALCAS4B</span><span class="p">/</span><span class="n">IONSUM</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">IFLSUM</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ESTORE</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">EPHOTON</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRXE</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRYE</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZE</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRX</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRY</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZ</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">GENB4</span><span class="p">/</span><span class="n">IONF4</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ESTF4</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span><span class="n">X4</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span><span class="n">Y4</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span><span class="n">Z4</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRXS</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span><span class="n">DRYS</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span><span class="n">DRZS</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">GEN31</span><span class="p">/</span><span class="n">X31</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">Y31</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">Z31</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">GEN41</span><span class="p">/</span><span class="n">X41</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">Y41</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">Z41</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">L1</span><span class="ow">.EQ.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">ZERO</span><span class="w"> </span><span class="n">COUNTER</span><span class="w">
       </span><span class="n">IONF4</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
       </span><span class="k">DO</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="n">K</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="w">
   </span><span class="mi">11</span><span class="w">  </span><span class="n">ESTF4</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
       </span><span class="k">RETURN</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">STORE</span><span class="w"> </span><span class="n">EVENT</span><span class="w"> </span><span class="k">DATA</span><span class="w"> </span><span class="n">FOR</span><span class="w"> </span><span class="n">FOURTH</span><span class="w"> </span><span class="n">GENERATION</span><span class="w"> </span><span class="n">FLUORESCENCE</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">IONSUM</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="ow">.GT.</span><span class="mi">12</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
       </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">99</span><span class="p">)</span><span class="w"> </span><span class="n">IONSUM</span><span class="p">(</span><span class="n">NVAC</span><span class="p">),</span><span class="n">NVAC</span><span class="w">
  </span><span class="mi">99</span><span class="w">   </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">' WARNING FOURTH GENERATION CONVERTED FLUORESCENCE HAS AN 
     / EVENT WITH'</span><span class="p">,</span><span class="l">I3</span><span class="p">,</span><span class="s1">' IONS.'</span><span class="p">,</span><span class="l">/</span><span class="p">,</span><span class="s1">' COMPTON BRANCH NO='</span><span class="p">,</span><span class="l">I3</span><span class="p">,</span><span class="l">/</span><span class="p">)</span><span class="w">
       </span><span class="k">STOP</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w">
      </span><span class="n">IONF4</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="o">=</span><span class="n">IONSUM</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="w">
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">IONSUM</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="w">
      </span><span class="n">ESTF4</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">ESTORE</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
      </span><span class="n">X4</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">X31</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="o">+</span><span class="n">DIST1</span><span class="o">*</span><span class="n">DRX0</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="w">
      </span><span class="n">Y4</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">Y31</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="o">+</span><span class="n">DIST1</span><span class="o">*</span><span class="n">DRY0</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="w">
      </span><span class="n">Z4</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">Z31</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="o">+</span><span class="n">DIST1</span><span class="o">*</span><span class="n">DRZ0</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="w">
      </span><span class="n">X41</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="o">=</span><span class="n">X4</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
      </span><span class="n">Y41</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="o">=</span><span class="n">Y4</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
      </span><span class="n">Z41</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="o">=</span><span class="n">Z4</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
      </span><span class="n">DRXS</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">DRXE</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
      </span><span class="n">DRYS</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">DRYE</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
      </span><span class="n">DRZS</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">DRZE</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
    </span><span class="mi">1</span><span class="w"> </span><span class="k">CONTINUE</span><span class="w">
      </span><span class="k">RETURN</span><span class="w">
      </span><span class="k">END</span><span class="w">
      </span><span class="k">SUBROUTINE</span><span class="w"> </span><span class="n">CSSTFB5</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">,</span><span class="n">DIST1</span><span class="p">)</span><span class="w">
      </span><span class="k">IMPLICIT</span><span class="w"> </span><span class="kt">REAL</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="n">H</span><span class="p">,</span><span class="n">O</span><span class="o">-</span><span class="n">Z</span><span class="p">)</span><span class="w">
      </span><span class="k">IMPLICIT</span><span class="w"> </span><span class="kt">INTEGER</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="n">N</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">CALCAS4B</span><span class="p">/</span><span class="n">IONSUM0</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">IFLSUM0</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ESTORE0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">EPHOTON0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRXE0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRYE0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZE0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRX0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRY0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZ0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">CALCAS5B</span><span class="p">/</span><span class="n">IONSUM</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">IFLSUM</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ESTORE</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">EPHOTON</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRXE</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRYE</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZE</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRX</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRY</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZ</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">GENB5</span><span class="p">/</span><span class="n">IONF5</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ESTF5</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">X5</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">Y5</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">Z5</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRXS</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">DRYS</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">DRZS</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">GEN41</span><span class="p">/</span><span class="n">X41</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">Y41</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">Z41</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">GEN51</span><span class="p">/</span><span class="n">X51</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">Y51</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">Z51</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">L1</span><span class="ow">.EQ.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">ZERO</span><span class="w"> </span><span class="n">COUNTER</span><span class="w">
       </span><span class="n">IONF5</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
       </span><span class="k">DO</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="n">K</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="w">
   </span><span class="mi">11</span><span class="w">  </span><span class="n">ESTF5</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
       </span><span class="k">RETURN</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">STORE</span><span class="w"> </span><span class="n">EVENT</span><span class="w"> </span><span class="k">DATA</span><span class="w"> </span><span class="n">FOR</span><span class="w"> </span><span class="n">FIFTH</span><span class="w"> </span><span class="n">GENERATION</span><span class="w"> </span><span class="n">FLUORESCENCE</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">IONSUM</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="ow">.GT.</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
       </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">99</span><span class="p">)</span><span class="w"> </span><span class="n">IONSUM</span><span class="p">(</span><span class="n">NVAC</span><span class="p">),</span><span class="n">NVAC</span><span class="w">
  </span><span class="mi">99</span><span class="w">   </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">' WARNING FIFTH GENERATION CONVERTED FLUORESCENCE HAS AN 
     / EVENT WITH'</span><span class="p">,</span><span class="l">I3</span><span class="p">,</span><span class="s1">' IONS.'</span><span class="p">,</span><span class="l">/</span><span class="p">,</span><span class="s1">' COMPTON BRANCH NO='</span><span class="p">,</span><span class="l">I3</span><span class="p">,</span><span class="l">/</span><span class="p">)</span><span class="w">
       </span><span class="k">STOP</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w">
      </span><span class="n">IONF5</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="o">=</span><span class="n">IONSUM</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="w">
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">IONSUM</span><span class="p">(</span><span class="n">NVAC</span><span class="p">)</span><span class="w">
      </span><span class="n">ESTF5</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">ESTORE</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
      </span><span class="n">X5</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">X41</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="o">+</span><span class="n">DIST1</span><span class="o">*</span><span class="n">DRX0</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="w">
      </span><span class="n">Y5</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">Y41</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="o">+</span><span class="n">DIST1</span><span class="o">*</span><span class="n">DRY0</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="w">
      </span><span class="n">Z5</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">Z41</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="o">+</span><span class="n">DIST1</span><span class="o">*</span><span class="n">DRZ0</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="w">
      </span><span class="n">X51</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="o">=</span><span class="n">X5</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
      </span><span class="n">Y51</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="o">=</span><span class="n">Y5</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
      </span><span class="n">Z51</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">L1</span><span class="p">)</span><span class="o">=</span><span class="n">Z5</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
      </span><span class="n">DRXS</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">DRXE</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
      </span><span class="n">DRYS</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">DRYE</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
      </span><span class="n">DRZS</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="o">=</span><span class="n">DRZE</span><span class="p">(</span><span class="n">NVAC</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
    </span><span class="mi">1</span><span class="w"> </span><span class="k">CONTINUE</span><span class="w">
      </span><span class="k">RETURN</span><span class="w">
      </span><span class="k">END</span><span class="w">
</span></code></pre>