<h2 id='compress'>COMPRESS</h2>
<ul>
<li>Stores Cascade Data into global array <code>INTHRMB1</code></li>
<li>Stores Events for input to thermalisation.</li>
</ul>
<h3 id='arguments'>Arguments</h3>
<table><thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>IDBG</td>
<td></td>
</tr>
<tr>
<td>ENSUM</td>
<td></td>
</tr>
</tbody></table>
<pre class="highlight fortran tab-fortran"><code><span class="w">      </span><span class="k">SUBROUTINE</span><span class="w"> </span><span class="n">COMPRESS</span><span class="p">(</span><span class="n">IDBG</span><span class="p">,</span><span class="n">ENSUM</span><span class="p">)</span><span class="w">
      </span><span class="k">IMPLICIT</span><span class="w"> </span><span class="kt">REAL</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="n">H</span><span class="p">,</span><span class="n">O</span><span class="o">-</span><span class="n">Z</span><span class="p">)</span><span class="w">
      </span><span class="k">IMPLICIT</span><span class="w"> </span><span class="kt">INTEGER</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="p">(</span><span class="n">I</span><span class="o">-</span><span class="n">N</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">INPT</span><span class="p">/</span><span class="n">NGAS</span><span class="p">,</span><span class="n">NSTEP</span><span class="p">,</span><span class="n">NANISO</span><span class="p">,</span><span class="n">EFINAL</span><span class="p">,</span><span class="n">ESTEP</span><span class="p">,</span><span class="n">AKT</span><span class="p">,</span><span class="n">ARY</span><span class="p">,</span><span class="n">TEMPC</span><span class="p">,</span><span class="n">TORR</span><span class="p">,</span><span class="n">IPEN</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">PRIM4</span><span class="p">/</span><span class="n">MSUM1</span><span class="p">,</span><span class="n">MCOMP1</span><span class="p">,</span><span class="n">MRAYL1</span><span class="p">,</span><span class="n">MPAIR1</span><span class="p">,</span><span class="n">MPHOT1</span><span class="p">,</span><span class="n">MVAC1</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">RESB</span><span class="p">/</span><span class="n">IONSM</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">IFLSM</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ESTOR</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">EPHOT</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">X</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">Y</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">Z</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRX0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRY0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZ0</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">GENB1</span><span class="p">/</span><span class="n">IONF1</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ESTF1</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">X1</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">Y1</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">Z1</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRX1</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRY1</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZ1</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">GENB2</span><span class="p">/</span><span class="n">IONF2</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ESTF2</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">X2</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">Y2</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">Z2</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRX2</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRY2</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">),</span><span class="n">DRZ2</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">GENB3</span><span class="p">/</span><span class="n">IONF3</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ESTF3</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span><span class="n">X3</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span><span class="n">Y3</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span><span class="n">Z3</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRX3</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span><span class="n">DRY3</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span><span class="n">DRZ3</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">GENB4</span><span class="p">/</span><span class="n">IONF4</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ESTF4</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span><span class="n">X4</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span><span class="n">Y4</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span><span class="n">Z4</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRX4</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span><span class="n">DRY4</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span><span class="n">DRZ4</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">GENB5</span><span class="p">/</span><span class="n">IONF5</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">ESTF5</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">X5</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">Y5</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">Z5</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRX5</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">DRY5</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">DRZ5</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="w">
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">INTHRMB1</span><span class="p">/</span><span class="n">NPTPE</span><span class="p">,</span><span class="n">ET</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span><span class="n">XT</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span><span class="n">YT</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span><span class="n">ZT</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRX</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span><span class="n">DRY</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span><span class="n">DRZ</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">NJFLR</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span><span class="n">IEVENTL</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> 
      </span><span class="k">COMMON</span><span class="p">/</span><span class="n">PPSTRB</span><span class="p">/</span><span class="n">NPTP</span><span class="p">,</span><span class="n">EPPST</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">XPP</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">YPP</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">ZPP</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="w">
     </span><span class="p">/</span><span class="n">DRXPP</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">DRYPP</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">DRZPP</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w">
      </span><span class="k">DIMENSION</span><span class="w"> </span><span class="n">ESTOT</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> 
      </span><span class="n">NPTPE</span><span class="o">=</span><span class="n">MVAC1</span><span class="w">
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="w">
    </span><span class="mi">1</span><span class="w"> </span><span class="n">ESTOT</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="k">IF</span><span class="p">(</span><span class="n">IDBG</span><span class="ow">.EQ.</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">66</span><span class="p">)</span><span class="w"> </span><span class="n">MVAC1</span><span class="w">
</span><span class="n">C</span><span class="w">  </span><span class="mi">66</span><span class="w"> </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">' IN COMPRESS MVAC1='</span><span class="p">,</span><span class="l">I4</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="k">DO</span><span class="w"> </span><span class="mi">67</span><span class="w"> </span><span class="n">KK</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">MVAC1</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">68</span><span class="p">)</span><span class="w"> </span><span class="n">IONSM</span><span class="p">(</span><span class="n">KK</span><span class="p">),</span><span class="n">IONF1</span><span class="p">(</span><span class="n">KK</span><span class="p">),</span><span class="n">IONF2</span><span class="p">(</span><span class="n">KK</span><span class="p">),</span><span class="n">IONF3</span><span class="p">(</span><span class="n">KK</span><span class="p">),</span><span class="n">IONF4</span><span class="p">(</span><span class="n">KK</span><span class="p">),</span><span class="w">
</span><span class="n">C</span><span class="w">    </span><span class="p">/</span><span class="n">IONF5</span><span class="p">(</span><span class="n">KK</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">  </span><span class="mi">68</span><span class="w"> </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">' IONSUM 0-5='</span><span class="p">,</span><span class="l">6I4</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">69</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">ESTOR</span><span class="p">(</span><span class="n">KK</span><span class="p">,</span><span class="n">KKK</span><span class="p">),</span><span class="n">KKK</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">  </span><span class="mi">69</span><span class="w"> </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">' ESTOR='</span><span class="p">,</span><span class="l">4</span><span class="p">(</span><span class="l">7D12.4</span><span class="p">,</span><span class="l">/</span><span class="p">))</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">70</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">ESTF1</span><span class="p">(</span><span class="n">KK</span><span class="p">,</span><span class="n">KKK</span><span class="p">),</span><span class="n">KKK</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">  </span><span class="mi">70</span><span class="w"> </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">' ESTF1='</span><span class="p">,</span><span class="l">4</span><span class="p">(</span><span class="l">7D12.4</span><span class="p">,</span><span class="l">/</span><span class="p">))</span><span class="w">
</span><span class="n">C</span><span class="w">  </span><span class="mi">67</span><span class="w"> </span><span class="k">CONTINUE</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="k">ENDIF</span><span class="w">
</span><span class="n">C</span><span class="w">      
</span><span class="n">C</span><span class="w">  </span><span class="n">STORE</span><span class="w"> </span><span class="n">CASCADE</span><span class="w"> </span><span class="k">DATA</span><span class="w"> </span><span class="n">INTO</span><span class="w"> </span><span class="k">COMMON</span><span class="p">/</span><span class="n">INTHRMB1</span><span class="p">/</span><span class="w">
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="n">K</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">MVAC1</span><span class="w">
      </span><span class="n">ITOT</span><span class="o">=</span><span class="n">IONSM</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">+</span><span class="n">IONF1</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">+</span><span class="n">IONF2</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">+</span><span class="n">IONF3</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">+</span><span class="n">IONF4</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">+</span><span class="n">IONF5</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="w">
      </span><span class="n">IEVENTL</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="n">ITOT</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">ITOT</span><span class="ow">.GT.</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> 
       </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">811</span><span class="p">)</span><span class="w"> </span><span class="n">J</span><span class="w">
  </span><span class="mi">811</span><span class="w"> </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">' NEVENT='</span><span class="p">,</span><span class="l">I5</span><span class="p">,</span><span class="s1">' ITOT OVERFLOW IN OUTPUTBC'</span><span class="p">)</span><span class="w">
       </span><span class="k">STOP</span><span class="w">       
      </span><span class="k">ENDIF</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="n">STORE</span><span class="w"> </span><span class="n">EVENT</span><span class="w"> </span><span class="n">FOR</span><span class="w"> </span><span class="n">INPUT</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">THERMALISATION</span><span class="w">
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="n">M</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">IONSM</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="w">
      </span><span class="n">ET</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="o">=</span><span class="n">ESTOR</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">XT</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="o">=</span><span class="n">X</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">YT</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="o">=</span><span class="n">Y</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">ZT</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="o">=</span><span class="n">Z</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">DRX</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="o">=</span><span class="n">DRX0</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">DRY</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="o">=</span><span class="n">DRY0</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">DRZ</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="o">=</span><span class="n">DRZ0</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">NJFLR</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w">
      </span><span class="n">ESTOT</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="n">ESTOT</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">+</span><span class="n">ESTOR</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
    </span><span class="mi">6</span><span class="w"> </span><span class="k">CONTINUE</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">IONF1</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="ow">.EQ.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">17</span><span class="w">
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="n">M</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">IONF1</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="w">
      </span><span class="n">M1</span><span class="o">=</span><span class="n">M</span><span class="o">+</span><span class="n">IONSM</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="w">
      </span><span class="n">ET</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M1</span><span class="p">)</span><span class="o">=</span><span class="n">ESTF1</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">   
      </span><span class="n">XT</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M1</span><span class="p">)</span><span class="o">=</span><span class="n">X1</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">YT</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M1</span><span class="p">)</span><span class="o">=</span><span class="n">Y1</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">ZT</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M1</span><span class="p">)</span><span class="o">=</span><span class="n">Z1</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">DRX</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M1</span><span class="p">)</span><span class="o">=</span><span class="n">DRX1</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">DRY</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M1</span><span class="p">)</span><span class="o">=</span><span class="n">DRY1</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">DRZ</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M1</span><span class="p">)</span><span class="o">=</span><span class="n">DRZ1</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">ESTOT</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="n">ESTOT</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">+</span><span class="n">ESTF1</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">NJFLR</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M1</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span><span class="w">
    </span><span class="mi">7</span><span class="w"> </span><span class="k">CONTINUE</span><span class="w">
   </span><span class="mi">17</span><span class="w"> </span><span class="k">IF</span><span class="p">(</span><span class="n">IONF2</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="ow">.EQ.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">18</span><span class="w">
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="n">M</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">IONF2</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="w">
      </span><span class="n">M2</span><span class="o">=</span><span class="n">M</span><span class="o">+</span><span class="n">IONSM</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">+</span><span class="n">IONF1</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="w">
      </span><span class="n">ET</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M2</span><span class="p">)</span><span class="o">=</span><span class="n">ESTF2</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">XT</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M2</span><span class="p">)</span><span class="o">=</span><span class="n">X2</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">YT</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M2</span><span class="p">)</span><span class="o">=</span><span class="n">Y2</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">ZT</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M2</span><span class="p">)</span><span class="o">=</span><span class="n">Z2</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">DRX</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M2</span><span class="p">)</span><span class="o">=</span><span class="n">DRX2</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">DRY</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M2</span><span class="p">)</span><span class="o">=</span><span class="n">DRY2</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">DRZ</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M2</span><span class="p">)</span><span class="o">=</span><span class="n">DRZ2</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">ESTOT</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="n">ESTOT</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">+</span><span class="n">ESTF2</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">NJFLR</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M2</span><span class="p">)</span><span class="o">=</span><span class="mi">2</span><span class="w">
    </span><span class="mi">8</span><span class="w"> </span><span class="k">CONTINUE</span><span class="w">
   </span><span class="mi">18</span><span class="w"> </span><span class="k">IF</span><span class="p">(</span><span class="n">IONF3</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="ow">.EQ.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">19</span><span class="w">
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="n">M</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">IONF3</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="w">
      </span><span class="n">M3</span><span class="o">=</span><span class="n">M</span><span class="o">+</span><span class="n">IONSM</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">+</span><span class="n">IONF1</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">+</span><span class="n">IONF2</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="w">
      </span><span class="n">ET</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M3</span><span class="p">)</span><span class="o">=</span><span class="n">ESTF3</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">XT</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M3</span><span class="p">)</span><span class="o">=</span><span class="n">X3</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">YT</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M3</span><span class="p">)</span><span class="o">=</span><span class="n">Y3</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">ZT</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M3</span><span class="p">)</span><span class="o">=</span><span class="n">Z3</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">DRX</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M3</span><span class="p">)</span><span class="o">=</span><span class="n">DRX3</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">DRY</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M3</span><span class="p">)</span><span class="o">=</span><span class="n">DRY3</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">DRZ</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M3</span><span class="p">)</span><span class="o">=</span><span class="n">DRZ3</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">ESTOT</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="n">ESTOT</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">+</span><span class="n">ESTF3</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">NJFLR</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M3</span><span class="p">)</span><span class="o">=</span><span class="mi">3</span><span class="w">
    </span><span class="mi">9</span><span class="w"> </span><span class="k">CONTINUE</span><span class="w">
   </span><span class="mi">19</span><span class="w"> </span><span class="k">IF</span><span class="p">(</span><span class="n">IONF4</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="ow">.EQ.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">20</span><span class="w">
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="n">M</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">IONF4</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="w">
      </span><span class="n">M4</span><span class="o">=</span><span class="n">M</span><span class="o">+</span><span class="n">IONSM</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">+</span><span class="n">IONF1</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">+</span><span class="n">IONF2</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">+</span><span class="n">IONF3</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="w">
      </span><span class="n">ET</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M4</span><span class="p">)</span><span class="o">=</span><span class="n">ESTF4</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">XT</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M4</span><span class="p">)</span><span class="o">=</span><span class="n">X4</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">YT</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M4</span><span class="p">)</span><span class="o">=</span><span class="n">Y4</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">ZT</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M4</span><span class="p">)</span><span class="o">=</span><span class="n">Z4</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">DRX</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M4</span><span class="p">)</span><span class="o">=</span><span class="n">DRX4</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">DRY</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M4</span><span class="p">)</span><span class="o">=</span><span class="n">DRY4</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">DRZ</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M4</span><span class="p">)</span><span class="o">=</span><span class="n">DRZ4</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">ESTOT</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="n">ESTOT</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">+</span><span class="n">ESTF4</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">NJFLR</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M4</span><span class="p">)</span><span class="o">=</span><span class="mi">4</span><span class="w">
   </span><span class="mi">10</span><span class="w"> </span><span class="k">CONTINUE</span><span class="w">
   </span><span class="mi">20</span><span class="w"> </span><span class="k">IF</span><span class="p">(</span><span class="n">IONF5</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="ow">.EQ.</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">GO</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="mi">21</span><span class="w">
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="n">M</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">IONF5</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="w">
      </span><span class="n">M5</span><span class="o">=</span><span class="n">M</span><span class="o">+</span><span class="n">IONSM</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">+</span><span class="n">IONF1</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">+</span><span class="n">IONF2</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">+</span><span class="n">IONF3</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">+</span><span class="n">IONF4</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="w">
      </span><span class="n">ET</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M5</span><span class="p">)</span><span class="o">=</span><span class="n">ESTF5</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">XT</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M5</span><span class="p">)</span><span class="o">=</span><span class="n">X5</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">YT</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M5</span><span class="p">)</span><span class="o">=</span><span class="n">Y5</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">ZT</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M5</span><span class="p">)</span><span class="o">=</span><span class="n">Z5</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">DRX</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M5</span><span class="p">)</span><span class="o">=</span><span class="n">DRX5</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">DRY</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M5</span><span class="p">)</span><span class="o">=</span><span class="n">DRY5</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">DRZ</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M5</span><span class="p">)</span><span class="o">=</span><span class="n">DRZ5</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">ESTOT</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">=</span><span class="n">ESTOT</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">+</span><span class="n">ESTF5</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">)</span><span class="w">
      </span><span class="n">NJFLR</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">M5</span><span class="p">)</span><span class="o">=</span><span class="mi">5</span><span class="w">
   </span><span class="mi">11</span><span class="w"> </span><span class="k">CONTINUE</span><span class="w">
   </span><span class="mi">21</span><span class="w"> </span><span class="k">CONTINUE</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="k">PRINT</span><span class="w"> </span><span class="n">SOME</span><span class="w"> </span><span class="n">RAW</span><span class="w"> </span><span class="k">DATA</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="k">IF</span><span class="p">(</span><span class="n">J</span><span class="ow">.LE.</span><span class="mi">525</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="n">EDUM</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="k">DO</span><span class="w"> </span><span class="mi">666</span><span class="w"> </span><span class="n">JJ</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">IEVENTL</span><span class="p">(</span><span class="n">J</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="mi">666</span><span class="w"> </span><span class="n">EDUM</span><span class="o">=</span><span class="n">EDUM</span><span class="o">+</span><span class="n">ET</span><span class="p">(</span><span class="n">JJ</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">232</span><span class="p">)</span><span class="w"> </span><span class="n">J</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">2321</span><span class="p">)</span><span class="w"> </span><span class="n">EDUM</span><span class="w">
</span><span class="n">C2321</span><span class="w"> </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">' TOT ENERGY='</span><span class="p">,</span><span class="l">D12.3</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="mi">232</span><span class="w"> </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">' DATA FOR EVENT='</span><span class="p">,</span><span class="l">I3</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="k">DO</span><span class="w"> </span><span class="mi">234</span><span class="w"> </span><span class="n">M</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">IEVENTL</span><span class="p">(</span><span class="n">J</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">233</span><span class="p">)</span><span class="w"> </span><span class="n">ET</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">J</span><span class="p">),</span><span class="n">XT</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">J</span><span class="p">),</span><span class="n">YT</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">J</span><span class="p">),</span><span class="n">ZT</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">J</span><span class="p">),</span><span class="n">TH</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">J</span><span class="p">),</span><span class="n">PH</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">J</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="mi">233</span><span class="w"> </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">' E='</span><span class="p">,</span><span class="l">D12.3</span><span class="p">,</span><span class="s1">' X='</span><span class="p">,</span><span class="l">D12.3</span><span class="p">,</span><span class="s1">' Y='</span><span class="p">,</span><span class="l">D12.3</span><span class="p">,</span><span class="s1">' Z='</span><span class="p">,</span><span class="l">D12.3</span><span class="p">,</span><span class="s1">' THETA='</span><span class="p">,</span><span class="w">
</span><span class="l">C</span><span class="w">    </span><span class="l">/D12.3</span><span class="p">,</span><span class="s1">' PHI='</span><span class="p">,</span><span class="l">D12.3</span><span class="p">)</span><span class="w">
</span><span class="n">C</span><span class="w"> </span><span class="mi">234</span><span class="w"> </span><span class="k">CONTINUE</span><span class="w">
</span><span class="n">C</span><span class="w">     </span><span class="k">ENDIF</span><span class="w">
      </span><span class="n">EDUM</span><span class="o">=</span><span class="mf">0.0</span><span class="w">
   </span><span class="mi">12</span><span class="w"> </span><span class="k">CONTINUE</span><span class="w">
      </span><span class="k">DO</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="n">K</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">MVAC1</span><span class="w">
      </span><span class="n">EDUM</span><span class="o">=</span><span class="n">EDUM</span><span class="o">+</span><span class="n">ESTOT</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="w">
   </span><span class="mi">30</span><span class="w"> </span><span class="k">CONTINUE</span><span class="w">
      </span><span class="n">EDUM</span><span class="o">=</span><span class="n">EDUM</span><span class="o">+</span><span class="n">EPPST</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">EPPST</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w">
      </span><span class="n">ENSUM</span><span class="o">=</span><span class="n">EDUM</span><span class="w">
      </span><span class="k">IF</span><span class="p">(</span><span class="n">EDUM</span><span class="ow">.GT.</span><span class="p">(</span><span class="n">EFINAL</span><span class="mf">+0.1</span><span class="p">))</span><span class="w"> </span><span class="k">THEN</span><span class="w">
       </span><span class="k">WRITE</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">999</span><span class="p">)</span><span class="w"> </span><span class="n">EDUM</span><span class="w">
  </span><span class="mi">999</span><span class="w"> </span><span class="k">FORMAT</span><span class="p">(</span><span class="s1">' ETOT ='</span><span class="p">,</span><span class="l">D12.5</span><span class="p">,</span><span class="s1">'EV.    BAD EVENT IN COMPRESS'</span><span class="p">,</span><span class="l">/</span><span class="p">)</span><span class="w">
       </span><span class="n">IBAD</span><span class="o">=</span><span class="mi">1</span><span class="w">
       </span><span class="k">STOP</span><span class="w">
      </span><span class="k">ENDIF</span><span class="w">
      </span><span class="k">RETURN</span><span class="w">     
      </span><span class="k">END</span><span class="w">  
</span></code></pre><pre class="highlight python tab-python"><code><span class="k">def</span> <span class="nf">COMPRESS</span><span class="p">(</span><span class="n">IDBG</span><span class="p">,</span><span class="n">ENSUM</span><span class="p">):</span>
    <span class="c"># IMPLICIT #real*8 (A-H,O-Z)</span>
    <span class="c"># IMPLICIT #integer*8 (I-N)</span>
    <span class="c"># COMMON/INPT/NGAS,NSTEP,NANISO,EFINAL,ESTEP,AKT,ARY,TEMPC,TORR,IPEN</span>
    <span class="c"># COMMON/PRIM4/MSUM1,MCOMP1,MRAYL1,MPAIR1,MPHOT1,MVAC1</span>
    <span class="c"># COMMON/RESB/IONSM(10),IFLSM(10),ESTOR(10,28),EPHOT(10,28),X(10,28),Y(10,28),Z[10,28],DRX0(10,28),DRY0(10,28),DRZ0(10,28)</span>
    <span class="c"># COMMON/GENB1/IONF1(10),ESTF1(10,28),X1(10,28),Y1(10,28),Z1(10,28),DRX1(10,28),DRY1(10,28),DRZ1(10,28)</span>
    <span class="c"># COMMON/GENB2/IONF2(10),ESTF2(10,28),X2(10,28),Y2(10,28),Z2(10,28),DRX2(10,28),DRY2(10,28),DRZ2(10,28)</span>
    <span class="c"># COMMON/GENB3/IONF3(10),ESTF3(10,15),X3(10,15),Y3(10,15),Z3(10,15),DRX3(10,15),DRY3(10,15),DRZ3(10,15)</span>
    <span class="c"># COMMON/GENB4/IONF4(10),ESTF4(10,12),X4(10,12),Y4(10,12),Z4(10,12),DRX4(10,12),DRY4(10,12),DRZ4(10,12)</span>
    <span class="c"># COMMON/GENB5/IONF5(10),ESTF5(10,5),X5(10,5),Y5(10,5),Z5(10,5),DRX5(10,5),DRY5(10,5),DRZ5(10,5)</span>
    <span class="c"># COMMON/INTHRMB1/NPTPE,ET(10,50),XT(10,50),YT(10,50),ZT(10,50),DRX(10,50),DRY(10,50),DRZ[10,50],NJFLR(10,50),IEVENTL(10) </span>
    <span class="c"># COMMON/PPSTRB/NPTP,EPPST[2],XPP[2],YPP[2],ZPP[2],DRXPP[2],DRYPP[2],DRZPP[2]</span>
    <span class="c">#COMMON/INPT/</span>
    <span class="k">global</span> <span class="n">NGAS</span><span class="p">,</span><span class="n">NSTEP</span><span class="p">,</span><span class="n">NANISO</span><span class="p">,</span><span class="n">EFINAL</span><span class="p">,</span><span class="n">ESTEP</span><span class="p">,</span><span class="n">AKT</span><span class="p">,</span><span class="n">ARY</span><span class="p">,</span><span class="n">TEMPC</span><span class="p">,</span><span class="n">TORR</span><span class="p">,</span><span class="n">IPEN</span>
    <span class="c">#COMMON/PRIM4/</span>
    <span class="k">global</span> <span class="n">MSUM1</span><span class="p">,</span><span class="n">MCOMP1</span><span class="p">,</span><span class="n">MRAYL1</span><span class="p">,</span><span class="n">MPAIR1</span><span class="p">,</span><span class="n">MPHOT1</span><span class="p">,</span><span class="n">MVAC1</span>
    <span class="c">#COMMON/RESB/</span>
    <span class="k">global</span> <span class="n">IONSM</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">IFLSM</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">ESTOR</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">EPHOT</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">X</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">Y</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">Z</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRX0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRY0</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZ0</span><span class="c">#(10,28)</span>
    <span class="c">#COMMON/GENB1/</span>
    <span class="k">global</span> <span class="n">IONF1</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">ESTF1</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">X1</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">Y1</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">Z1</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRX1</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRY1</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZ1</span><span class="c">#(10,28)</span>
    <span class="c">#COMMON/GENB2/</span>
    <span class="k">global</span> <span class="n">IONF2</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">ESTF2</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">X2</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">Y2</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">Z2</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRX2</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRY2</span><span class="c">#(10,28)</span>
    <span class="k">global</span> <span class="n">DRZ2</span><span class="c">#(10,28)</span>
    <span class="c">#COMMON/GENB3/</span>
    <span class="k">global</span> <span class="n">IONF3</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">ESTF3</span><span class="c">#(10,15)</span>
    <span class="k">global</span> <span class="n">X3</span><span class="c">#(10,15)</span>
    <span class="k">global</span> <span class="n">Y3</span><span class="c">#(10,15)</span>
    <span class="k">global</span> <span class="n">Z3</span><span class="c">#(10,15)</span>
    <span class="k">global</span> <span class="n">DRX3</span><span class="c">#(10,15)</span>
    <span class="k">global</span> <span class="n">DRY3</span><span class="c">#(10,15)</span>
    <span class="k">global</span> <span class="n">DRZ3</span><span class="c">#(10,15)</span>
    <span class="c">#COMMON/GENB4/</span>
    <span class="k">global</span> <span class="n">IONF4</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">ESTF4</span><span class="c">#(10,12)</span>
    <span class="k">global</span> <span class="n">X4</span><span class="c">#(10,12)</span>
    <span class="k">global</span> <span class="n">Y4</span><span class="c">#(10,12)</span>
    <span class="k">global</span> <span class="n">Z4</span><span class="c">#(10,12)</span>
    <span class="k">global</span> <span class="n">DRX4</span><span class="c">#(10,12)</span>
    <span class="k">global</span> <span class="n">DRY4</span><span class="c">#(10,12)</span>
    <span class="k">global</span> <span class="n">DRZ4</span><span class="c">#(10,12)</span>
    <span class="c">#COMMON/GENB5/</span>
    <span class="k">global</span> <span class="n">IONF5</span><span class="c">#(10)</span>
    <span class="k">global</span> <span class="n">ESTF5</span><span class="c">#(10,5)</span>
    <span class="k">global</span> <span class="n">X5</span><span class="c">#(10,5)</span>
    <span class="k">global</span> <span class="n">Y5</span><span class="c">#(10,5)</span>
    <span class="k">global</span> <span class="n">Z5</span><span class="c">#(10,5)</span>
    <span class="k">global</span> <span class="n">DRX5</span><span class="c">#(10,5)</span>
    <span class="k">global</span> <span class="n">DRY5</span><span class="c">#(10,5)</span>
    <span class="k">global</span> <span class="n">DRZ5</span><span class="c">#(10,5)</span>
    <span class="c">#COMMON/INTHRMB1/</span>
    <span class="k">global</span> <span class="n">NPTPE</span>
    <span class="k">global</span> <span class="n">ET</span><span class="c">#(10,50)</span>
    <span class="k">global</span> <span class="n">XT</span><span class="c">#(10,50)</span>
    <span class="k">global</span> <span class="n">YT</span><span class="c">#(10,50)</span>
    <span class="k">global</span> <span class="n">ZT</span><span class="c">#(10,50)</span>
    <span class="k">global</span> <span class="n">DRX</span><span class="c">#(10,50)</span>
    <span class="k">global</span> <span class="n">DRY</span><span class="c">#(10,50)</span>
    <span class="k">global</span> <span class="n">DRZ</span><span class="c">#(10,50)</span>
    <span class="k">global</span> <span class="n">NJFLR</span><span class="c">#(10,50)</span>
    <span class="k">global</span> <span class="n">IEVENTL</span><span class="c">#(10) </span>
    <span class="c">#COMMON/PPSTRB/</span>
    <span class="k">global</span> <span class="n">NPTP</span>
    <span class="k">global</span> <span class="n">EPPST</span><span class="c">#(2)</span>
    <span class="k">global</span> <span class="n">XPP</span><span class="c">#(2)</span>
    <span class="k">global</span> <span class="n">YPP</span><span class="c">#(2)</span>
    <span class="k">global</span> <span class="n">ZPP</span><span class="c">#(2)</span>
    <span class="k">global</span> <span class="n">DRXPP</span><span class="c">#(2)</span>
    <span class="k">global</span> <span class="n">DRYPP</span><span class="c">#(2)</span>
    <span class="k">global</span> <span class="n">DRZPP</span><span class="c">#(2)</span>
    <span class="c">#DIMENSION </span>
    <span class="n">ESTOT</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
    <span class="n">NPTPE</span><span class="o">=</span><span class="n">MVAC1</span>
    <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">ESTOT</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span>
    <span class="c">#     IF(IDBG == 1) :</span>
    <span class="c">#     WRITE(6,66) MVAC1</span>
    <span class="c">#  66 print(' IN COMPRESS MVAC1=',I4)</span>
    <span class="c">#     DO 67 KK=1,MVAC1</span>
    <span class="c">#     WRITE(6,68) IONSM(KK),IONF1(KK),IONF2(KK),IONF3(KK),IONF4(KK),</span>
    <span class="c">#    /IONF5(KK)</span>
    <span class="c">#  68 print(' IONSUM 0-5=',6I4)</span>
    <span class="c">#     WRITE(6,69) (ESTOR(KK,KKK),KKK=1,28)</span>
    <span class="c">#  69 print(' ESTOR=',4(7'%.4f' % ,/))</span>
    <span class="c">#     WRITE(6,70) (ESTF1(KK,KKK),KKK=1,28)</span>
    <span class="c">#  70 print(' ESTF1=',4(7'%.4f' % ,/))</span>
    <span class="c">#  67 CONTINUE</span>
    <span class="c">#     # endIF</span>
    <span class="c">#      </span>
    <span class="c">#  STORE CASCADE DATA INTO COMMON/INTHRMB1/</span>
    <span class="k">for</span> <span class="n">K</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">MVAC1</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">ITOT</span><span class="o">=</span><span class="n">IONSM</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">+</span><span class="n">IONF1</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">+</span><span class="n">IONF2</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">+</span><span class="n">IONF3</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">+</span><span class="n">IONF4</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">+</span><span class="n">IONF5</span><span class="p">[</span><span class="n">K</span><span class="p">]</span>
        <span class="n">IEVENTL</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="n">ITOT</span>
        <span class="k">if</span><span class="p">(</span><span class="n">ITOT</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">):</span>
            <span class="k">print</span><span class="p">(</span><span class="s">' NEVENT='</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="s">' ITOT OVERFLOW IN OUTPUTBC'</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">()</span>       
        <span class="c"># endif</span>
        <span class="c"># STORE EVENT FOR INPUT TO THERMALISATION</span>
        <span class="k">for</span> <span class="n">M</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IONSM</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">ET</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span><span class="o">=</span><span class="n">ESTOR</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
            <span class="n">XT</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span><span class="o">=</span><span class="n">X</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
            <span class="n">YT</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span><span class="o">=</span><span class="n">Y</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
            <span class="n">ZT</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span><span class="o">=</span><span class="n">Z</span><span class="p">[</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">]</span>
            <span class="n">DRX</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span><span class="o">=</span><span class="n">DRX0</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
            <span class="n">DRY</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span><span class="o">=</span><span class="n">DRY0</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
            <span class="n">DRZ</span><span class="p">[</span><span class="n">K</span><span class="p">,</span><span class="n">M</span><span class="p">]</span><span class="o">=</span><span class="n">DRZ0</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
            <span class="n">NJFLR</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">ESTOT</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="n">ESTOT</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">+</span><span class="n">ESTOR</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
        <span class="k">if</span><span class="p">(</span><span class="n">IONF1</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">M</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IONF1</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">M1</span><span class="o">=</span><span class="n">M</span><span class="o">+</span><span class="n">IONSM</span><span class="p">[</span><span class="n">K</span><span class="p">]</span>
                <span class="n">ET</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M1</span><span class="p">]</span><span class="o">=</span><span class="n">ESTF1</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>   
                <span class="n">XT</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M1</span><span class="p">]</span><span class="o">=</span><span class="n">X1</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">YT</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M1</span><span class="p">]</span><span class="o">=</span><span class="n">Y1</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">ZT</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M1</span><span class="p">]</span><span class="o">=</span><span class="n">Z1</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">DRX</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M1</span><span class="p">]</span><span class="o">=</span><span class="n">DRX1</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">DRY</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M1</span><span class="p">]</span><span class="o">=</span><span class="n">DRY1</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">DRZ</span><span class="p">[</span><span class="n">K</span><span class="p">,</span><span class="n">M1</span><span class="p">]</span><span class="o">=</span><span class="n">DRZ1</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">ESTOT</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="n">ESTOT</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">+</span><span class="n">ESTF1</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">NJFLR</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
        <span class="k">if</span><span class="p">(</span><span class="n">IONF2</span><span class="p">[</span><span class="n">K</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">M</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IONF2</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">M2</span><span class="o">=</span><span class="n">M</span><span class="o">+</span><span class="n">IONSM</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">+</span><span class="n">IONF1</span><span class="p">[</span><span class="n">K</span><span class="p">]</span>
                <span class="n">ET</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M2</span><span class="p">]</span><span class="o">=</span><span class="n">ESTF2</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">XT</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M2</span><span class="p">]</span><span class="o">=</span><span class="n">X2</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">YT</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M2</span><span class="p">]</span><span class="o">=</span><span class="n">Y2</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">ZT</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M2</span><span class="p">]</span><span class="o">=</span><span class="n">Z2</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">DRX</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M2</span><span class="p">]</span><span class="o">=</span><span class="n">DRX2</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">DRY</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M2</span><span class="p">]</span><span class="o">=</span><span class="n">DRY2</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">DRZ</span><span class="p">[</span><span class="n">K</span><span class="p">,</span><span class="n">M2</span><span class="p">]</span><span class="o">=</span><span class="n">DRZ2</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">ESTOT</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="n">ESTOT</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">+</span><span class="n">ESTF2</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">NJFLR</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M2</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span>
        <span class="k">if</span><span class="p">(</span><span class="n">IONF3</span><span class="p">[</span><span class="n">K</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">M</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IONF3</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">M3</span><span class="o">=</span><span class="n">M</span><span class="o">+</span><span class="n">IONSM</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">+</span><span class="n">IONF1</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">+</span><span class="n">IONF2</span><span class="p">[</span><span class="n">K</span><span class="p">]</span>
                <span class="n">ET</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M3</span><span class="p">]</span><span class="o">=</span><span class="n">ESTF3</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">XT</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M3</span><span class="p">]</span><span class="o">=</span><span class="n">X3</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">YT</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M3</span><span class="p">]</span><span class="o">=</span><span class="n">Y3</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">ZT</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M3</span><span class="p">]</span><span class="o">=</span><span class="n">Z3</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">DRX</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M3</span><span class="p">]</span><span class="o">=</span><span class="n">DRX3</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">DRY</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M3</span><span class="p">]</span><span class="o">=</span><span class="n">DRY3</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">DRZ</span><span class="p">[</span><span class="n">K</span><span class="p">,</span><span class="n">M3</span><span class="p">]</span><span class="o">=</span><span class="n">DRZ3</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">ESTOT</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="n">ESTOT</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">+</span><span class="n">ESTF3</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">NJFLR</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M3</span><span class="p">]</span><span class="o">=</span><span class="mi">3</span>
        <span class="k">if</span><span class="p">(</span><span class="n">IONF4</span><span class="p">[</span><span class="n">K</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">M</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IONF4</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">M4</span><span class="o">=</span><span class="n">M</span><span class="o">+</span><span class="n">IONSM</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">+</span><span class="n">IONF1</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">+</span><span class="n">IONF2</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">+</span><span class="n">IONF3</span><span class="p">[</span><span class="n">K</span><span class="p">]</span>
                <span class="n">ET</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M4</span><span class="p">]</span><span class="o">=</span><span class="n">ESTF4</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">XT</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M4</span><span class="p">]</span><span class="o">=</span><span class="n">X4</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">YT</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M4</span><span class="p">]</span><span class="o">=</span><span class="n">Y4</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">ZT</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M4</span><span class="p">]</span><span class="o">=</span><span class="n">Z4</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">DRX</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M4</span><span class="p">]</span><span class="o">=</span><span class="n">DRX4</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">DRY</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M4</span><span class="p">]</span><span class="o">=</span><span class="n">DRY4</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">DRZ</span><span class="p">[</span><span class="n">K</span><span class="p">,</span><span class="n">M4</span><span class="p">]</span><span class="o">=</span><span class="n">DRZ4</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">ESTOT</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="n">ESTOT</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">+</span><span class="n">ESTF4</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">NJFLR</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M4</span><span class="p">]</span><span class="o">=</span><span class="mi">4</span>
        <span class="k">if</span><span class="p">(</span><span class="n">IONF5</span><span class="p">[</span><span class="n">K</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">M</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">IONF5</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">M5</span><span class="o">=</span><span class="n">M</span><span class="o">+</span><span class="n">IONSM</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">+</span><span class="n">IONF1</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">+</span><span class="n">IONF2</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">+</span><span class="n">IONF3</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">+</span><span class="n">IONF4</span><span class="p">[</span><span class="n">K</span><span class="p">]</span>
                <span class="n">ET</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M5</span><span class="p">]</span><span class="o">=</span><span class="n">ESTF5</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">XT</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M5</span><span class="p">]</span><span class="o">=</span><span class="n">X5</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">YT</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M5</span><span class="p">]</span><span class="o">=</span><span class="n">Y5</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">ZT</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M5</span><span class="p">]</span><span class="o">=</span><span class="n">Z5</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">DRX</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M5</span><span class="p">]</span><span class="o">=</span><span class="n">DRX5</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">DRY</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M5</span><span class="p">]</span><span class="o">=</span><span class="n">DRY5</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">DRZ</span><span class="p">[</span><span class="n">K</span><span class="p">,</span><span class="n">M5</span><span class="p">]</span><span class="o">=</span><span class="n">DRZ5</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">ESTOT</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">=</span><span class="n">ESTOT</span><span class="p">[</span><span class="n">K</span><span class="p">]</span><span class="o">+</span><span class="n">ESTF5</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M</span><span class="p">]</span>
                <span class="n">NJFLR</span><span class="p">[</span><span class="n">K</span><span class="p">][</span><span class="n">M5</span><span class="p">]</span><span class="o">=</span><span class="mi">5</span>
        <span class="c"># PRINT SOME RAW DATA</span>
        <span class="c">#     IF(J &lt;= 525) :</span>
        <span class="c">#     EDUM=0.0</span>
        <span class="c">#     DO 666 JJ=1,IEVENTL[J]</span>
        <span class="c"># 666 EDUM=EDUM+ET(JJ,J)</span>
        <span class="c">#     WRITE(6,232) J</span>
        <span class="c">#     WRITE(6,2321) EDUM</span>
        <span class="c">#2321 print(' TOT ENERGY=','%.3f' %)</span>
        <span class="c"># 232 print(' DATA FOR EVENT=',I3)</span>
        <span class="c">#     DO 234 M=1,IEVENTL[J]</span>
        <span class="c">#     WRITE(6,233) ET(M,J),XT(M,J),YT(M,J),ZT(M,J),TH(M,J),PH(M,J)</span>
        <span class="c"># 233 print(' E=','%.3f' %,' X=','%.3f' %,' Y=','%.3f' %,' Z=','%.3f' %,' THETA=',</span>
        <span class="c">#    /'%.3f' %,' PHI=','%.3f' %)</span>
        <span class="c"># 234 CONTINUE</span>
        <span class="c">#     # endIF</span>
        <span class="n">EDUM</span><span class="o">=</span><span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">K</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">MVAC1</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">EDUM</span><span class="o">=</span><span class="n">EDUM</span><span class="o">+</span><span class="n">ESTOT</span><span class="p">[</span><span class="n">K</span><span class="p">]</span>
    <span class="n">EDUM</span><span class="o">=</span><span class="n">EDUM</span><span class="o">+</span><span class="n">EPPST</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">EPPST</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">ENSUM</span><span class="o">=</span><span class="n">EDUM</span>
    <span class="k">if</span><span class="p">(</span><span class="n">EDUM</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">EFINAL</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">' ETOT ='</span><span class="p">,</span><span class="s">'</span><span class="si">%.5</span><span class="s">f'</span> <span class="o">%</span> <span class="n">EDUM</span><span class="p">,</span><span class="s">'EV.    BAD EVENT IN COMPRESS</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
        <span class="n">IBAD</span><span class="o">=</span><span class="mi">1</span>
        <span class="n">sys</span><span class="o">.</span><span class="nb">exit</span><span class="p">()</span>
    <span class="c"># endif</span>
    <span class="k">return</span>     
    <span class="c"># end         </span>
</code></pre>